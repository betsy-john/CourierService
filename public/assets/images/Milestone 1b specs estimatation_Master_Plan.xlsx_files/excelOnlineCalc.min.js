var excelOnlineCalc=function(e){var r={};function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)n.d(t,a,function(r){return e[r]}.bind(null,a));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=8)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=n(1);r.utils=t;var a=n(2);r.idbPromised=a;var o=n(3);r.ULS=o.ULS,r.TraceLevel=o.TraceLevel,r.LogCategory=o.LogCategory,r.NulLogger=o.NulLogger,r.ConsoleLogger=o.ConsoleLogger;var i=n(4);r.browserSupport=i;var u=n(5);r.perfWatch=u;var c=n(6);r.initEwaUtils=c.initEwaUtils,r.ewaUtils=c.ewaUtils;var l=n(7);r.initStopwatchFactory=l.initStopwatchFactory},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,n){return e.reduce(function(e,t){return e.then(function(){return n&&n.stop?Promise.resolve(void 0):r(t,n)})},Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,n){if(void 0===n&&(n=0),n<0||n>t)return r;if(null==r||"object"!=typeof r)return r;var a={};Object.getOwnPropertyNames(r).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])});var o=Object.getPrototypeOf(r);o&&"object"==typeof o&&Object.keys(o).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])});var i={};return Object.keys(a).forEach(function(r){i[r]=e(a[r],n+1)}),i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var t=5;var a="_",o=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(o,a).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===a&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===a&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var n=Promise.reject(void 0),t=function(r){n=n.catch(function(n){return e(r,n)})},a=1;a<=r;a+=1)t(a);return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t,a=n(1);function o(e,r,n){return e?!(r&&!e.objectStoreNames.contains(r))||(n({name:"ValidationError",message:"The database doesn't contain store name: "+r}),!1):(n({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function u(e){void 0!==i&&i(e)}function c(e,r,n,t){return new Promise(function(a,i){if(o(e,r,i)){var u,c=e.transaction([r],n);c.oncomplete=function(){return a()},c.onerror=function(){return i(u||c.error)},c.onabort=function(){return i(u||c.error)};var l=c.objectStore(r),s=t(l);s.onerror=function(){u=s.error}}})}r.registerTraceSubscriber=function(e){i=e},r.clearTraceSubscriber=function(){i=void 0},r.setTestDbFactory=function(e){t=e},r.getDbFactory=function(){if(t)return t;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(n){var e=a.getStringifiedError(n);e&&e!==a.defaultToJSONResultWhenStringifyFails||!n||!n.message||(e=n.message);var r=a.getPerfWatchMarkName(e);u("indexedDB_access_error"+(r&&r.length>0?"_":"")+r)}},r.getStoreReadinessPromise=function(e){return new Promise(function(r,n){e.transaction.oncomplete=function(){return r()},e.transaction.onerror=function(){return n(e.transaction.error)}})},r.initDb=function(e,r,n,t){return new Promise(function(a,o){u("idb_open");var i,c,l,s,f=n||0===n?e.open(r,n):e.open(r),d=(i=!1,c=!1,l=function(e){u("idb_open_"+e)},s=function(){return c?(l("already_resolved"),!1):!i||(l("already_rejected"),!1)},{rejectOnce:function(e){l("should_reject"),s()&&(l("rejecting"),i=!0,o(e))},resolveOnce:function(e){l("should_resolve"),s()&&(l("resolving"),c=!0,a(e))}});f.onupgradeneeded=function(e){u("idb_open_onupgradeneeded_start");var n=e.target.result;if(e.oldVersion>0&&function(e){u("idb_open_onupgradeneeded_deleteAllObjectStores");for(var r=[],n=e.objectStoreNames.length-1;n>=0;n-=1){var t=e.objectStoreNames.item(n);(t||""===t)&&r.push(t)}r.forEach(function(r){u("idb_open_onupgradeneeded_delete_store_"+r),e.deleteObjectStore(r)})}(n),t){u("idb_open_onupgradeneeded_create_stores");var a=t(n);a&&a.length>0&&Promise.all(a).then(function(){u("idb_open_onupgradeneeded_stores_ready"),d.resolveOnce({db:n,dbName:r})},function(e){u("idb_open_onupgradeneeded_stores_ready_error"),d.rejectOnce(e)})}u("idb_open_onupgradeneeded_end")},f.onsuccess=function(e){u("idb_open_onsuccess"),d.resolveOnce({db:e.target.result,dbName:r})},f.onerror=function(){u("idb_open_onerror"),d.rejectOnce(f.error)},f.onblocked=function(e){u("idb_open_onblocked"),d.rejectOnce(e)}})},r.deleteDb=function(e,r){return new Promise(function(n,t){var a=e.deleteDatabase(r);a.onsuccess=function(){return n()},a.onblocked=function(){return n()},a.onerror=function(){return t(a.error)}})},r.doTransactionAction=c,r.put=function(e,r,n,t){return c(e,r,"readwrite",function(e){return n?e.put(t,n):e.put(t)})},r.get=function(e,r,n){return new Promise(function(t,a){if(o(e,void 0,a)){var i;e.objectStoreNames.contains(r)||t(void 0);var u=void 0,c=e.transaction([r],"readonly");c.oncomplete=function(){return t(u)},c.onerror=function(){return a(i||c.error)},c.onabort=function(){return a(i||c.error)};var l=c.objectStore(r).get(n);l.onsuccess=function(e){u=e.target.result},l.onerror=function(){i=l.error}}})},r.getAllItems=function(e,r){return new Promise(function(n,t){if(o(e,r,t)){var a,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(a||u.error)},u.onabort=function(){return t(a||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.value),r.continue())},c.onerror=function(){a=c.error}}})},r.getAllKeys=function(e,r){return new Promise(function(n,t){if(o(e,r,t)){var a,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(a||u.error)},u.onabort=function(){return t(a||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.key),r.continue())},c.onerror=function(){a=c.error}}})},r.remove=function(e,r,n){return c(e,r,"readwrite",function(e){return e.delete(n)})},r.removeAll=function(e,r){return c(e,r,"readwrite",function(e){return e.clear()})}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,n,t){return r.traceTag(0,e,n,t)},traceTag:function(e,n,t,a){return r.traceTag(e,n,t,a)},debugTrace:function(e,n,t){return r.debugTraceTag(0,e,n,t)},debugTraceTag:function(e,n,t,a){return r.debugTraceTag(e,n,t,a)},assert:function(e,n,t){return r.assertTag(0,e,n,t)},assertTag:function(e,n,t,a){return r.assertTag(e,n,t,a)},shipAssert:function(e,n,t){return r.shipAssertTag(0,e,n,t)},shipAssertTag:function(e,n,t,a){return r.shipAssertTag(e,n,t,a)}}}}};var t=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,n,t){console.assert(n,"shipAssertTag:",e,r,t)},e.prototype.assertTag=function(e,r,n,t){console.assert(n,"assertTag",e,r,t)},e.prototype.traceTag=function(e,r,n,t){console.log("traceTag",e,t,r,n)},e.prototype.debugTraceTag=function(e,r,n,t){console.log("debugTraceTag",e,t,r,n)},e}();r.ConsoleLogger=t;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=a},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={},a="promises";r.promises=function(){return void 0===t[a]&&(t[a]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),t[a]}},function(e,r,n){"use strict";function t(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,r,n){e[r]=t()-n}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=t(),n=e,o=r,i={},u=function(e,r,t){return function(e,r,n,t,o,i){a(e,"end",n);var u={sessionName:r,result:t?"success":"failure",message:i,marks:e},c=JSON.stringify(u);o(c)}(i,n,o,e,r,t)};return i.start=0,{mark:function(e){return function(e){return a(i,e,o)}(e)},end:function(e){return u(!0,e)},success:function(e,r){return u(!0,e,r)},failure:function(e,r){return u(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,n){void 0!==e&&e.success(r,n)},r.failure=function(e,r,n){void 0!==e&&e.failure(r,n)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return t},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");t=e}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),window.performance&&window.performance.now&&(t=function(){return window.performance.now()}),function(n){var a=t(),o=n;return{reset:function(e){null!=e&&(o=e),a=t()},stop:function(){var n=t()-a,i=JSON.stringify({Target:o,Duration:n.toFixed(r)});e(i)}}}}},function(e,r,n){"use strict";n.r(r);var t={};n.r(t),n.d(t,"ReasonKind",function(){return xn}),n.d(t,"notImplemented",function(){return Vn}),n.d(t,"notFormulaString",function(){return Wn}),n.d(t,"createParser",function(){return xi}),n.d(t,"parseResultHelper",function(){return qi});var a={};n.r(a),n.d(a,"createAnalyzer",function(){return ju});var o={};n.r(o),n.d(o,"fastMathpack",function(){return ic}),n.d(o,"createCompiler",function(){return Fl}),n.d(o,"createEvaluator",function(){return Id}),n.d(o,"ReasonKind",function(){return wc}),n.d(o,"CellKind",function(){return bc}),n.d(o,"Interrupt",function(){return Bc}),n.d(o,"notImplemented",function(){return Uc}),n.d(o,"finalValue",function(){return Vc}),n.d(o,"pendingValue",function(){return xc}),n.d(o,"cellFormula",function(){return Wc}),n.d(o,"unavailable",function(){return Pc}),n.d(o,"unevaluated",function(){return Kc}),n.d(o,"stopped",function(){return Hc}),n.d(o,"nameCycle",function(){return Xc}),n.d(o,"cellCycle",function(){return Yc}),n.d(o,"paused",function(){return qc}),n.d(o,"previousFailure",function(){return jc}),n.d(o,"javaScriptError",function(){return Jc}),n.d(o,"evalGlobals",function(){return Qc}),n.d(o,"getEvalFailureReason",function(){return zc}),n.d(o,"illFormedFormula",function(){return Gc}),n.d(o,"extractResultValue",function(){return sl}),n.d(o,"evalToCellValue",function(){return fl}),n.d(o,"getBasicFirstOrderFunc",function(){return NE}),n.d(o,"extension",function(){return gE});var i={};n.r(i),n.d(i,"recalcMapper",function(){return XE}),n.d(i,"mapperContext",function(){return YE}),n.d(i,"formulaCacheGlobals",function(){return tp}),n.d(i,"formulaCache",function(){return ap}),n.d(i,"createFormatInfo",function(){return np});var u={};n.r(u),n.d(u,"getBasicFirstOrderFunc",function(){return NE});var c=n(0);function l(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function s(e){return e}function f(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=d(e[n],n));return r}function d(e,r){if("string"==typeof r&&null!=v[r])return e;var n=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var n=e.kind;if("string"==typeof n)return n}return r}(e),t=h[n];return null!=t?t(e,r):"object"==typeof e?f(e):"<unexpected>"}function E(e){try{var r=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(r=e.kind)||"Array"===r||"App"===r||"Paren"===r||"Name"===r||"CellRef"===r||"Bad"===r||"Operator"===r))return"FormulaNode"}var r}(e);if(void 0!==r){var n=T[r](e);return void 0!==n?n:JSON.stringify(d(e,void 0))}return JSON.stringify(d(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var p,v={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},h={boolean:s,symbol:s,undefined:s,null:s,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:f,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(d):"<unexpected>"}},T={},R={ULS:new c.NulLogger};function S(e){R.ULS=e}function I(e,r){var n=e+": code should be unreachable because a value has type 'never'; given "+E(r);return R.ULS.assertTag(595980872,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}function g(e){return R.ULS.assertTag(595980873,c.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!l(r)||r<0)&&g(e+": expected natural number; given "+E(r))}function m(e,r){(!l(r)||r<=0)&&g(e+": expected positive integer; given "+E(r))}function N(e,r,n){(!l(r)||r<0||r>=n)&&g(e+": expected natural number less than "+E(n)+"; given "+E(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(p||(p={}));var C=O(void 0,"");function O(e,r){return{path:e,name:r}}function L(e,r,n){return{document:e,index:r,length:n}}function D(e,r,n){return A("calc.lang.sheetRange",r),m("calc.lang.sheetRange",n),L(e,r,n)}function M(e,r){return A("calc.lang.sheetIndex",r),L(e,r,1)}function _(e,r,n,t){return{row:e,col:r,rows:n,cols:t}}function y(e,r,n,t){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),m("calc.lang.gridRange",n),m("calc.lang.gridRange",t),_(e,r,n,t)}function F(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),_(e,r,1,1)}function k(e,r){return{sheet:e,range:r}}var U,P,b,B,w,G,V=k,x=k,W=k;function H(e){return{document:e,index:void 0}}function K(e,r){return{scope:e,name:r}}function Q(e,r,n,t,a,o){(A("calc.lang.functionType",e),0===n.length&&r.length<e)&&g("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:n,returnType:t,staticPrecs:a,flags:o}}function X(e,r,n,t){return{cells:e,names:r,special:n,isExact:t}}function Y(e){return{kind:U.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(U||(U={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(B||(B={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA"}(w||(w={})),function(e){e[e.First=1]="First",e[e.Last=8]="Last"}(G||(G={}));var j=Y(w.NULL),J=Y(w.DIV0),q=Y(w.VALUE),z=Y(w.REF),Z=Y(w.NAME),$=Y(w.NUM),ee=Y(w.NA),re=Y(w.GETTING_DATA);function ne(e,r,n){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),n.length!==e?g("calc.lang.arrayOper: Inconsistent row number"):{kind:U.Array,rows:e,cols:r,opers:n}}function te(e,r){return m("calc.lang.rangeSeqOper",r.length),{kind:U.Range,sheets:e,ranges:r}}function ae(e,r){return{kind:U.Range,sheets:e,ranges:[r]}}var oe,ie,ue,ce,le,se,fe={kind:U.Missing},de={kind:U.Blank};function Ee(e){return void 0===e&&(e=0),{kind:ie.Error,isQuoted:!1,label:e}}function pe(e){return void 0===e&&(e=0),{kind:ie.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(oe||(oe={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(ie||(ie={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(ue||(ue={})),function(e){e.Abs="Abs",e.Rel="Rel"}(ce||(ce={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(le||(le={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(se||(se={}));var ve=Ee(),he=pe();function Te(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:ie.Document,isQuoted:n,label:t,document:e,path:r}}function Re(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:ie.Sheet,isQuoted:n,label:t,sheet:e,document:r}}function Se(e,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ie.Ident,isQuoted:r,label:n,name:e}}function Ie(e,r,n,t){return void 0===n&&(n=!1),void 0===t&&(t=0),{kind:ie.SheetRange,isQuoted:n,label:t,sheet1:e,sheet2:r}}function ge(e,r){return{kind:e,index:r}}function Ae(e){return void 0===e&&(e=0),{kind:ue.Error,label:e}}var me,Ne=Ae();function Ce(e,r,n){return void 0===n&&(n=0),{kind:ue.Single,label:n,row:e,col:r}}function Oe(e,r,n){return void 0===n&&(n=0),{kind:ue.Range,label:n,ref1:e,ref2:r}}function Le(e,r,n){return void 0===n&&(n=0),{kind:ue.Row,label:n,row1:e,row2:r}}function De(e,r,n){return void 0===n&&(n=0),{kind:ue.Col,label:n,col1:e,col2:r}}function Me(e,r){return{node:e,spans:r}}function _e(e,r,n,t){var a,o;return A("calc.lang.formulaSpan",e),a="calc.lang.formulaSpan",l(o=r)||g(a+": expected integer; given "+E(o)),r<e&&g("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:n,post:t}}function ye(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Literal,label:n,oper:e,isClosed:r}}function Fe(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Array,label:n,nodes:e,isClosed:r}}function ke(e,r,n,t){return void 0===n&&(n=!0),void 0===t&&(t=0),{kind:le.App,label:t,head:e,args:r,isClosed:n}}function Ue(e,r){return void 0===r&&(r=0),{kind:le.Operator,label:r,id:e}}function Pe(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Paren,label:n,node:e,isClosed:r}}function be(e,r,n){return void 0===n&&(n=0),{kind:le.Name,label:n,whole:e,qualifier:r}}function Be(e,r,n){return void 0===n&&(n=0),{kind:le.CellRef,label:n,ref:e,qualifier:r}}function we(e,r,n){return void 0===n&&(n=0),{kind:le.Bad,label:n,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.GRF=614]="GRF",e[e.UNIT=615]="UNIT",e[e.RICHERROR=616]="RICHERROR",e[e.FILTER=617]="FILTER",e[e.FUN=618]="FUN",e[e.LET=619]="LET",e[e.ARRAYMAKE=620]="ARRAYMAKE",e[e.APPLY=621]="APPLY",e[e.ISFUN=622]="ISFUN",e[e.ARITY=623]="ARITY",e[e.RECURSE=624]="RECURSE"}(me||(me={}));var Ge=[];Ge[me.COUNT]=Q(1,[],[57],1,0,0),Ge[me.IF]=Q(1,[36,575,575],[],567,0,0),Ge[me.ISNA]=Q(1,[15],[],4,0,0),Ge[me.ISERROR]=Q(1,[15],[],4,0,0),Ge[me.SUM]=Q(1,[],[49],1,0,0),Ge[me.AVERAGE]=Q(1,[],[49],1,0,0),Ge[me.MIN]=Q(1,[],[49],1,0,0),Ge[me.MAX]=Q(1,[],[49],1,0,0),Ge[me.ROW]=Q(0,[16],[],33,0,0),Ge[me.COLUMN]=Q(0,[16],[],33,0,0),Ge[me.NA]=Q(0,[],[],3,0,0),Ge[me.NPV]=Q(2,[1],[49],1,0,0),Ge[me.STDEV]=Q(1,[],[49],1,0,0),Ge[me.DOLLAR]=Q(1,[1,1],[],2,0,0),Ge[me.FIXED]=Q(1,[1,65,4],[],2,0,0),Ge[me.SIN]=Q(1,[1],[],1,0,0),Ge[me.COS]=Q(1,[1],[],1,0,0),Ge[me.TAN]=Q(1,[1],[],1,0,0),Ge[me.ATAN]=Q(1,[1],[],1,0,0),Ge[me.PI]=Q(0,[],[],1,0,0),Ge[me.SQRT]=Q(1,[1],[],1,0,0),Ge[me.EXP]=Q(1,[1],[],1,0,0),Ge[me.LN]=Q(1,[1],[],1,0,0),Ge[me.LOG10]=Q(1,[1],[],1,0,0),Ge[me.ABS]=Q(1,[1],[],1,0,0),Ge[me.INT]=Q(1,[1],[],1,0,0),Ge[me.SIGN]=Q(1,[1],[],1,0,0),Ge[me.ROUND]=Q(2,[1,1],[],1,0,0),Ge[me.LOOKUP]=Q(2,[7,48,48],[],7,0,0),Ge[me.INDEX]=Q(2,[48,1,1,1],[],55,0,0),Ge[me.REPT]=Q(2,[2,1],[],2,0,0),Ge[me.MID]=Q(3,[2,1,1],[],2,0,0),Ge[me.LEN]=Q(1,[2],[],1,0,0),Ge[me.VALUE]=Q(1,[7],[],1,0,0),Ge[me.TRUE]=Q(0,[],[],4,0,0),Ge[me.FALSE]=Q(0,[],[],4,0,0),Ge[me.AND]=Q(1,[],[52],4,0,0),Ge[me.OR]=Q(1,[],[52],4,0,0),Ge[me.NOT]=Q(1,[4],[],4,0,0),Ge[me.MOD]=Q(2,[1,1],[],1,0,0),Ge[me.DCOUNT]=Q(3,[16,83,18],[],1,0,0),Ge[me.DSUM]=Q(3,[16,19,18],[],1,0,0),Ge[me.DAVERAGE]=Q(3,[16,19,18],[],1,0,0),Ge[me.DMIN]=Q(3,[16,19,18],[],1,0,0),Ge[me.DMAX]=Q(3,[16,19,18],[],1,0,0),Ge[me.DSTDEV]=Q(3,[16,19,18],[],1,0,0),Ge[me.VAR]=Q(1,[],[49],1,0,0),Ge[me.DVAR]=Q(3,[16,19,18],[],1,0,0),Ge[me.TEXT]=Q(2,[7,2],[],2,0,0),Ge[me.LINEST]=Q(1,[48,112,84,84],[],32,0,0),Ge[me.TREND]=Q(1,[48,112,112,84],[],32,0,0),Ge[me.LOGEST]=Q(1,[48,112,84,84],[],32,0,0),Ge[me.GROWTH]=Q(1,[48,112,112,84],[],32,0,0),Ge[me.GOTO]=Q(1,[16],[],512,0,2),Ge[me.HALT]=Q(0,[4],[],512,0,2),Ge[me.RETURN]=Q(0,[575],[],512,0,2),Ge[me.PV]=Q(3,[1,1,1,1,1],[],1,0,0),Ge[me.FV]=Q(3,[1,1,1,1,1],[],1,0,0),Ge[me.NPER]=Q(3,[1,1,1,1,1],[],1,0,0),Ge[me.PMT]=Q(3,[1,1,1,1,1],[],1,0,0),Ge[me.RATE]=Q(3,[1,1,1,1,1,1],[],1,0,0),Ge[me.MIRR]=Q(3,[48,1,1],[],1,0,0),Ge[me.IRR]=Q(1,[48,1],[],1,0,0),Ge[me.RAND]=Q(0,[],[],1,4095,0),Ge[me.MATCH]=Q(2,[7,49,17],[],1,0,0),Ge[me.DATE]=Q(3,[1,1,1],[],1,0,0),Ge[me.TIME]=Q(3,[1,1,1],[],1,0,0),Ge[me.DAY]=Q(1,[1],[],1,0,0),Ge[me.MONTH]=Q(1,[1],[],1,0,0),Ge[me.YEAR]=Q(1,[1],[],1,0,0),Ge[me.WEEKDAY]=Q(1,[1,1],[],1,0,0),Ge[me.HOUR]=Q(1,[1],[],1,0,0),Ge[me.MINUTE]=Q(1,[1],[],1,0,0),Ge[me.SECOND]=Q(1,[1],[],1,0,0),Ge[me.NOW]=Q(0,[],[],1,4095,0),Ge[me.AREAS]=Q(1,[16],[],1,0,0),Ge[me.ROWS]=Q(1,[48],[],1,0,0),Ge[me.COLUMNS]=Q(1,[48],[],1,0,0),Ge[me.OFFSET]=Q(3,[16,65,65,65,65],[],16,4095,0),Ge[me.ABSREF]=Q(2,[2,16],[],16,0,2),Ge[me.RELREF]=Q(2,[16,16],[],2,0,2),Ge[me.ARGUMENT]=Q(0,[66,81,16],[],4,0,2),Ge[me.SEARCH]=Q(2,[2,2,1],[],1,0,0),Ge[me.TRANSPOSE]=Q(1,[39],[],32,0,0),Ge[me.ERROR]=Q(0,[1,24],[],4,0,2),Ge[me.STEP]=Q(0,[],[],4,0,2),Ge[me.TYPE]=Q(1,[47],[],1,0,0),Ge[me.ECHO]=Q(0,[4],[],4,0,2),Ge[me.SET_NAME]=Q(1,[2,63],[],4,0,2),Ge[me.CALLER]=Q(0,[],[],50,0,2),Ge[me.DEREF]=Q(1,[16],[],47,0,2),Ge[me.WINDOWS]=Q(0,[65,66],[],32,0,2),Ge[me.SERIES]=Q(4,[87,117,117,1,117],[],4,0,0),Ge[me.DOCUMENTS]=Q(0,[1,66],[],32,0,2),Ge[me.ACTIVE_CELL]=Q(0,[],[],16,0,2),Ge[me.SELECTION]=Q(0,[],[],16,0,2),Ge[me.RESULT]=Q(0,[1],[],4,0,2),Ge[me.ATAN2]=Q(2,[1,1],[],1,0,0),Ge[me.ASIN]=Q(1,[1],[],1,0,0),Ge[me.ACOS]=Q(1,[1],[],1,0,0),Ge[me.CHOOSE]=Q(2,[33],[575],567,0,0),Ge[me.HLOOKUP]=Q(3,[7,49,49,4],[],39,0,0),Ge[me.VLOOKUP]=Q(3,[7,49,49,4],[],39,0,0),Ge[me.LINKS]=Q(0,[66,65],[],32,0,2),Ge[me.INPUT]=Q(1,[2,65,66,67,65,65,2],[],575,0,2),Ge[me.ISREF]=Q(1,[63],[],4,0,0),Ge[me.GET_FORMULA]=Q(1,[18],[],2,0,2),Ge[me.GET_NAME]=Q(1,[2,4],[],6,0,2),Ge[me.SET_VALUE]=Q(2,[16,47],[],4,0,2),Ge[me.LOG]=Q(1,[1,1],[],1,0,0),Ge[me.EXEC]=Q(1,[2,1,4,4],[],7,0,2),Ge[me.CHAR]=Q(1,[1],[],2,0,0),Ge[me.LOWER]=Q(1,[2],[],2,0,0),Ge[me.UPPER]=Q(1,[2],[],2,0,0),Ge[me.PROPER]=Q(1,[2],[],2,0,0),Ge[me.LEFT]=Q(1,[2,9],[],2,0,0),Ge[me.RIGHT]=Q(1,[2,9],[],2,0,0),Ge[me.EXACT]=Q(2,[2,2],[],4,0,0),Ge[me.TRIM]=Q(1,[2],[],2,0,0),Ge[me.REPLACE]=Q(4,[2,1,1,2],[],2,0,0),Ge[me.SUBSTITUTE]=Q(3,[2,2,2,2],[],2,0,0),Ge[me.CODE]=Q(1,[2],[],1,0,0),Ge[me.NAMES]=Q(0,[66,65,66],[],32,0,2),Ge[me.DIRECTORY]=Q(0,[2],[],2,0,2),Ge[me.FIND]=Q(2,[2,2,1],[],1,0,0),Ge[me.CELL]=Q(1,[2,16],[],47,4095,0),Ge[me.ISERR]=Q(1,[15],[],4,0,0),Ge[me.ISTEXT]=Q(1,[143],[],4,0,0),Ge[me.ISNUMBER]=Q(1,[143],[],4,0,0),Ge[me.ISBLANK]=Q(1,[143],[],4,0,0),Ge[me.T]=Q(1,[23],[],2,0,0),Ge[me.N]=Q(1,[23],[],1,0,0),Ge[me.FOPEN]=Q(1,[2,1],[],1,0,2),Ge[me.FCLOSE]=Q(1,[1],[],1,0,2),Ge[me.FSIZE]=Q(1,[1],[],1,0,2),Ge[me.FREADLN]=Q(1,[1],[],2,0,2),Ge[me.FREAD]=Q(2,[1,1],[],2,0,2),Ge[me.FWRITELN]=Q(2,[1,2],[],1,0,2),Ge[me.FWRITE]=Q(2,[1,2],[],1,0,2),Ge[me.FPOS]=Q(1,[1,1],[],1,0,2),Ge[me.DATEVALUE]=Q(1,[3],[],1,0,0),Ge[me.TIMEVALUE]=Q(1,[3],[],1,0,0),Ge[me.SLN]=Q(3,[1,1,1],[],1,0,0),Ge[me.SYD]=Q(4,[1,1,1,1],[],1,0,0),Ge[me.DDB]=Q(4,[1,1,1,1,1],[],1,0,0),Ge[me.GET_DEF]=Q(1,[2,66,65],[],2,0,2),Ge[me.REFTEXT]=Q(1,[16,4],[],2,0,2),Ge[me.TEXTREF]=Q(1,[2,4],[],16,0,2),Ge[me.INDIRECT]=Q(1,[2,4],[],16,4095,0),Ge[me.REGISTER]=Q(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),Ge[me.CALL]=Q(1,[3],[127],575,0,2),Ge[me.ADD_BAR]=Q(0,[3],[],1,0,2),Ge[me.ADD_MENU]=Q(2,[3,115,83,3],[],1,0,2),Ge[me.ADD_COMMAND]=Q(3,[3,83,115,83,3],[],1,0,2),Ge[me.ENABLE_COMMAND]=Q(4,[3,3,3,4,3],[],4,0,2),Ge[me.CHECK_COMMAND]=Q(4,[3,3,3,4,3],[],4,0,2),Ge[me.RENAME_COMMAND]=Q(4,[3,3,3,3,3],[],4,0,2),Ge[me.SHOW_BAR]=Q(0,[3],[],4,0,2),Ge[me.DELETE_MENU]=Q(2,[3,3,3],[],4,0,2),Ge[me.DELETE_COMMAND]=Q(3,[3,3,3,3],[],4,0,2),Ge[me.GET_CHART_ITEM]=Q(1,[1,67,66],[],1,0,2),Ge[me.DIALOG_BOX]=Q(1,[52],[],36,0,2),Ge[me.CLEAN]=Q(1,[2],[],2,0,0),Ge[me.MDETERM]=Q(1,[32],[],1,0,0),Ge[me.MINVERSE]=Q(1,[32],[],32,0,0),Ge[me.MMULT]=Q(2,[32,32],[],32,0,0),Ge[me.FILES]=Q(0,[2,2],[],32,0,2),Ge[me.IPMT]=Q(4,[1,1,1,1,1,1],[],1,0,0),Ge[me.PPMT]=Q(4,[1,1,1,1,1,1],[],1,0,0),Ge[me.COUNTA]=Q(1,[],[121],1,0,0),Ge[me.CANCEL_KEY]=Q(0,[1,16],[],4,0,2),Ge[me.FOR]=Q(3,[2,1,1,1],[],512,0,2),Ge[me.WHILE]=Q(1,[4],[],512,0,2),Ge[me.BREAK]=Q(0,[],[],512,0,2),Ge[me.NEXT]=Q(0,[],[],512,0,2),Ge[me.INITIATE]=Q(2,[2,2],[],1,0,2),Ge[me.REQUEST]=Q(2,[1,2],[],32,0,2),Ge[me.POKE]=Q(3,[1,18,18],[],4,0,2),Ge[me.EXECUTE]=Q(2,[1,2],[],4,0,2),Ge[me.TERMINATE]=Q(1,[1],[],4,0,2),Ge[me.RESTART]=Q(0,[1],[],512,0,2),Ge[me.HELP]=Q(0,[2],[],4,0,2),Ge[me.GET_BAR]=Q(0,[3,3,3,3],[],3,0,2),Ge[me.PRODUCT]=Q(1,[],[113],1,0,0),Ge[me.FACT]=Q(1,[1],[],1,0,0),Ge[me.GET_CELL]=Q(1,[1,16],[],47,0,2),Ge[me.GET_WORKSPACE]=Q(1,[1],[],47,0,2),Ge[me.GET_WINDOW]=Q(1,[1,2],[],47,0,2),Ge[me.GET_DOCUMENT]=Q(1,[1,2],[],63,0,2),Ge[me.DPRODUCT]=Q(3,[16,19,18],[],1,0,0),Ge[me.ISNONTEXT]=Q(1,[143],[],4,0,0),Ge[me.GET_NOTE]=Q(0,[82,65,65],[],2,0,2),Ge[me.NOTE]=Q(0,[66,82,17,17],[],1,0,2),Ge[me.STDEVP]=Q(1,[],[49],1,0,0),Ge[me.VARP]=Q(1,[],[49],1,0,0),Ge[me.DSTDEVP]=Q(3,[16,19,18],[],1,0,0),Ge[me.DVARP]=Q(3,[16,19,18],[],1,0,0),Ge[me.TRUNC]=Q(1,[1,1],[],1,0,0),Ge[me.ISLOGICAL]=Q(1,[143],[],4,0,0),Ge[me.DCOUNTA]=Q(3,[16,83,18],[],1,0,0),Ge[me.DELETE_BAR]=Q(1,[3],[],4,0,2),Ge[me.UNREGISTER]=Q(1,[3],[],4,0,2),Ge[me.USDOLLAR]=Q(1,[1,1],[],2,0,0),Ge[me.FINDB]=Q(2,[2,2,1],[],1,0,0),Ge[me.SEARCHB]=Q(2,[2,2,1],[],1,0,0),Ge[me.REPLACEB]=Q(4,[2,1,1,2],[],2,0,0),Ge[me.LEFTB]=Q(1,[2,9],[],2,0,0),Ge[me.RIGHTB]=Q(1,[2,9],[],2,0,0),Ge[me.MIDB]=Q(3,[2,1,1],[],2,0,0),Ge[me.LENB]=Q(1,[2],[],1,0,0),Ge[me.ROUNDUP]=Q(2,[1,1],[],1,0,0),Ge[me.ROUNDDOWN]=Q(2,[1,1],[],1,0,0),Ge[me.ASC]=Q(1,[2],[],2,0,0),Ge[me.DBCS]=Q(1,[2],[],2,0,0),Ge[me.RANK]=Q(2,[1,16,4],[],1,0,0),Ge[me.ADDRESS]=Q(2,[1,65,65,68,66],[],2,0,0),Ge[me.DAYS360]=Q(2,[1,1,4],[],1,0,0),Ge[me.TODAY]=Q(0,[],[],1,4095,0),Ge[me.VDB]=Q(5,[1,1,1,1,1,1,4],[],1,0,0),Ge[me.ELSE]=Q(0,[],[],512,0,2),Ge[me.ELSE_IF]=Q(1,[12],[],512,0,2),Ge[me.END_IF]=Q(0,[],[],512,0,2),Ge[me.FOR_CELL]=Q(1,[2,82,84],[],512,0,2),Ge[me.MEDIAN]=Q(1,[],[49],1,0,0),Ge[me.SUMPRODUCT]=Q(1,[],[32],1,0,0),Ge[me.SINH]=Q(1,[1],[],1,0,0),Ge[me.COSH]=Q(1,[1],[],1,0,0),Ge[me.TANH]=Q(1,[1],[],1,0,0),Ge[me.ASINH]=Q(1,[1],[],1,0,0),Ge[me.ACOSH]=Q(1,[1],[],1,0,0),Ge[me.ATANH]=Q(1,[1],[],1,0,0),Ge[me.DGET]=Q(3,[16,19,18],[],7,0,0),Ge[me.CREATE_OBJECT]=Q(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),Ge[me.VOLATILE]=Q(0,[4],[],4,0,2),Ge[me.LAST_ERROR]=Q(0,[],[],16,0,2),Ge[me.CUSTOM_UNDO]=Q(0,[2,2],[],4,0,2),Ge[me.CUSTOM_REPEAT]=Q(0,[2,2,2],[],4,0,2),Ge[me.FORMULA_CONVERT]=Q(2,[2,23,23,23,23],[],2,0,2),Ge[me.GET_LINK_INFO]=Q(2,[2,1,1,2],[],1,0,2),Ge[me.TEXT_BOX]=Q(1,[2,66,65,65],[],1,0,2),Ge[me.INFO]=Q(1,[2],[],3,4095,0),Ge[me.GROUP]=Q(0,[],[],2,0,2),Ge[me.GET_OBJECT]=Q(1,[1,2,1,1,1],[],47,0,2),Ge[me.DB]=Q(4,[1,1,1,1,1],[],1,0,0),Ge[me.PAUSE]=Q(0,[4],[],512,0,2),Ge[me.ERROR_CODE]=Q(0,[],[],2,0,2),Ge[me.ALLOC_COUNT]=Q(0,[],[],1,0,2),Ge[me.RESUME]=Q(0,[1],[],512,0,2),Ge[me.FREQUENCY]=Q(2,[48,48],[],32,0,0),Ge[me.ADD_TOOLBAR]=Q(0,[66,96],[],2,0,2),Ge[me.DELETE_TOOLBAR]=Q(1,[2],[],4,0,2),Ge[me._UDF]=Q(1,[17],[127],575,0,0),Ge[me.RESET_TOOLBAR]=Q(1,[3],[],4,0,2),Ge[me.EVALUATE]=Q(1,[2],[],63,0,2),Ge[me.GET_TOOLBAR]=Q(1,[1,3],[],47,0,2),Ge[me.GET_TOOL]=Q(1,[1,3,1],[],47,0,2),Ge[me.SPELLING_CHECK]=Q(1,[2,66,4],[],4,0,2),Ge[me.ERROR_TYPE]=Q(1,[15],[],1,0,0),Ge[me.APP_TITLE]=Q(0,[2],[],4,0,2),Ge[me.WINDOW_TITLE]=Q(0,[2],[],4,0,2),Ge[me.SAVE_TOOLBAR]=Q(0,[99,66],[],4,0,2),Ge[me.ENABLE_TOOL]=Q(3,[3,1,4],[],4,0,2),Ge[me.PRESS_TOOL]=Q(3,[3,1,4],[],4,0,2),Ge[me.REGISTER_ID]=Q(2,[2,3,66],[],1,0,2),Ge[me.GET_PROJECT]=Q(1,[1,2],[],35,0,2),Ge[me.AVEDEV]=Q(1,[],[49],1,0,0),Ge[me.BETADIST]=Q(3,[1,1,1,65,65],[],1,0,0),Ge[me.GAMMALN]=Q(1,[1],[],1,0,0),Ge[me.BETAINV]=Q(3,[1,1,1,65,65],[],1,0,0),Ge[me.BINOMDIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.CHIDIST]=Q(2,[1,1],[],1,0,0),Ge[me.CHIINV]=Q(2,[1,1],[],1,0,0),Ge[me.COMBIN]=Q(2,[1,1],[],1,0,0),Ge[me.CONFIDENCE]=Q(3,[1,1,1],[],1,0,0),Ge[me.CRITBINOM]=Q(3,[1,1,1],[],1,0,0),Ge[me.EVEN]=Q(1,[1],[],1,0,0),Ge[me.EXPONDIST]=Q(3,[1,1,4],[],1,0,0),Ge[me.FDIST]=Q(3,[1,1,1],[],1,0,0),Ge[me.FINV]=Q(3,[1,1,1],[],1,0,0),Ge[me.FISHER]=Q(1,[1],[],1,0,0),Ge[me.FISHERINV]=Q(1,[1],[],1,0,0),Ge[me.FLOOR]=Q(2,[1,1],[],1,0,0),Ge[me.GAMMADIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.GAMMAINV]=Q(3,[1,1,1],[],1,0,0),Ge[me.CEILING]=Q(2,[1,1],[],1,0,0),Ge[me.HYPGEOMDIST]=Q(4,[1,1,1,1],[],1,0,0),Ge[me.LOGNORMDIST]=Q(3,[1,1,1],[],1,0,0),Ge[me.LOGINV]=Q(3,[1,1,1],[],1,0,0),Ge[me.NEGBINOMDIST]=Q(3,[1,1,1],[],1,0,0),Ge[me.NORMDIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.NORMSDIST]=Q(1,[1],[],1,0,0),Ge[me.NORMINV]=Q(3,[1,1,1],[],1,0,0),Ge[me.NORMSINV]=Q(1,[1],[],1,0,0),Ge[me.STANDARDIZE]=Q(3,[1,1,1],[],1,0,0),Ge[me.ODD]=Q(1,[1],[],1,0,0),Ge[me.PERMUT]=Q(2,[1,1],[],1,0,0),Ge[me.POISSON]=Q(3,[1,1,4],[],1,0,0),Ge[me.TDIST]=Q(3,[1,1,1],[],1,0,0),Ge[me.WEIBULL]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.SUMXMY2]=Q(2,[32,32],[],1,0,0),Ge[me.SUMX2MY2]=Q(2,[32,32],[],1,0,0),Ge[me.SUMX2PY2]=Q(2,[32,32],[],1,0,0),Ge[me.CHITEST]=Q(2,[32,32],[],1,0,0),Ge[me.CORREL]=Q(2,[32,32],[],1,0,0),Ge[me.COVAR]=Q(2,[32,32],[],1,0,0),Ge[me.FORECAST]=Q(3,[1,32,32],[],1,0,0),Ge[me.FTEST]=Q(2,[32,32],[],1,0,0),Ge[me.INTERCEPT]=Q(2,[32,32],[],1,0,0),Ge[me.PEARSON]=Q(2,[32,32],[],1,0,0),Ge[me.RSQ]=Q(2,[32,32],[],1,0,0),Ge[me.STEYX]=Q(2,[32,32],[],1,0,0),Ge[me.SLOPE]=Q(2,[32,32],[],1,0,0),Ge[me.TTEST]=Q(4,[32,32,1,1],[],1,0,0),Ge[me.PROB]=Q(3,[32,32,1,65],[],1,0,0),Ge[me.DEVSQ]=Q(1,[],[49],1,0,0),Ge[me.GEOMEAN]=Q(1,[],[49],1,0,0),Ge[me.HARMEAN]=Q(1,[],[49],1,0,0),Ge[me.SUMSQ]=Q(1,[],[49],1,0,0),Ge[me.KURT]=Q(1,[],[49],1,0,0),Ge[me.SKEW]=Q(1,[],[49],1,0,0),Ge[me.ZTEST]=Q(2,[49,1,1],[],1,0,0),Ge[me.LARGE]=Q(2,[49,1],[],1,0,0),Ge[me.SMALL]=Q(2,[49,1],[],1,0,0),Ge[me.QUARTILE]=Q(2,[49,1],[],1,0,0),Ge[me.PERCENTILE]=Q(2,[49,1],[],1,0,0),Ge[me.PERCENTRANK]=Q(2,[49,1,65],[],1,0,0),Ge[me.MODE]=Q(1,[],[32],1,0,0),Ge[me.TRIMMEAN]=Q(2,[49,1],[],1,0,0),Ge[me.TINV]=Q(2,[1,1],[],1,0,0),Ge[me.MOVIE_COMMAND]=Q(3,[2,1,1,1],[],1,0,2),Ge[me.GET_MOVIE]=Q(2,[2,1,1],[],1,0,2),Ge[me.CONCATENATE]=Q(1,[],[2],2,0,0),Ge[me.POWER]=Q(2,[1,1],[],1,0,0),Ge[me.SPREADBASE_DATA_FIELD]=Q(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),Ge[me.GET_VIEW]=Q(1,[1,2],[],35,0,2),Ge[me.GET_FIELD]=Q(1,[1,66,2],[],35,0,2),Ge[me.GET_ITEM]=Q(1,[1,66,66,2],[],7,0,2),Ge[me.RADIANS]=Q(1,[1],[],1,0,0),Ge[me.DEGREES]=Q(1,[1],[],1,0,0),Ge[me.SUBTOTAL]=Q(2,[1],[16],1,0,0),Ge[me.SUMIF]=Q(2,[16,15,16],[],1,0,0),Ge[me.COUNTIF]=Q(2,[16,15],[],1,0,0),Ge[me.COUNTBLANK]=Q(1,[16],[],1,0,0),Ge[me.SCENARIO_GET]=Q(1,[1,2],[],19,0,2),Ge[me.OPTIONS_LISTS]=Q(1,[33],[],33,0,2),Ge[me.ISPMT]=Q(4,[1,1,1,1],[],1,0,0),Ge[me.DATEDIF]=Q(3,[1,1,2],[],1,0,0),Ge[me.DATESTRING]=Q(1,[1],[],2,0,0),Ge[me.NUMBERSTRING]=Q(2,[1,1],[],2,0,0),Ge[me.ROMAN]=Q(1,[1,5],[],2,0,0),Ge[me.OPENDIALOG]=Q(0,[66,66,66,65],[],6,0,2),Ge[me.SAVEDIALOG]=Q(0,[66,66,66,66,65],[],6,0,2),Ge[me.VIEW_GET]=Q(1,[1,2],[],19,0,2),Ge[me.GETPIVOTDATA]=Q(2,[18,18],[2,79],15,0,0),Ge[me.HYPERLINK]=Q(1,[2,39],[],39,0,0),Ge[me.FURIGANA]=Q(1,[16],[],2,0,0),Ge[me.AVERAGEA]=Q(1,[],[49],1,0,0),Ge[me.MAXA]=Q(1,[],[49],1,0,0),Ge[me.MINA]=Q(1,[],[49],1,0,0),Ge[me.STDEVPA]=Q(1,[],[49],1,0,0),Ge[me.VARPA]=Q(1,[],[49],1,0,0),Ge[me.STDEVA]=Q(1,[],[49],1,0,0),Ge[me.VARA]=Q(1,[],[49],1,0,0),Ge[me.BAHTTEXT]=Q(1,[1],[],2,0,0),Ge[me.THAIDOW]=Q(1,[1],[],2,0,0),Ge[me.THAIDIGIT]=Q(1,[3],[],2,0,0),Ge[me.THAIMOY]=Q(1,[1],[],2,0,0),Ge[me.THAINUMSOUND]=Q(1,[1],[],2,0,0),Ge[me.THAINUMSTRING]=Q(1,[1],[],2,0,0),Ge[me.THAISTRINGLENGTH]=Q(1,[2],[],1,0,0),Ge[me.ISTHAIDIGIT]=Q(1,[2],[],4,0,0),Ge[me.ROUNDBAHTDOWN]=Q(1,[1],[],1,0,0),Ge[me.ROUNDBAHTUP]=Q(1,[1],[],1,0,0),Ge[me.THAIYEAR]=Q(1,[1],[],1,0,0),Ge[me.RTD]=Q(3,[],[2],2,0,0),Ge[me.CUBEVALUE]=Q(1,[2],[50],15,0,0),Ge[me.CUBEMEMBER]=Q(2,[2,50,2],[],10,0,0),Ge[me.CUBEMEMBERPROPERTY]=Q(3,[2,2,2],[],15,0,0),Ge[me.CUBERANKEDMEMBER]=Q(3,[2,2,1,2],[],10,0,0),Ge[me.HEX2BIN]=Q(1,[95,95],[],9,0,0),Ge[me.HEX2DEC]=Q(1,[95],[],9,0,0),Ge[me.HEX2OCT]=Q(1,[95,95],[],9,0,0),Ge[me.DEC2BIN]=Q(1,[95,95],[],9,0,0),Ge[me.DEC2HEX]=Q(1,[95,95],[],9,0,0),Ge[me.DEC2OCT]=Q(1,[95,95],[],9,0,0),Ge[me.OCT2BIN]=Q(1,[95,95],[],9,0,0),Ge[me.OCT2HEX]=Q(1,[95,95],[],9,0,0),Ge[me.OCT2DEC]=Q(1,[95],[],9,0,0),Ge[me.BIN2DEC]=Q(1,[95],[],9,0,0),Ge[me.BIN2OCT]=Q(1,[95,95],[],9,0,0),Ge[me.BIN2HEX]=Q(1,[95,95],[],9,0,0),Ge[me.IMSUB]=Q(2,[95,95],[],9,0,0),Ge[me.IMDIV]=Q(2,[95,95],[],9,0,0),Ge[me.IMPOWER]=Q(2,[95,95],[],9,0,0),Ge[me.IMABS]=Q(1,[95],[],9,0,0),Ge[me.IMSQRT]=Q(1,[95],[],9,0,0),Ge[me.IMLN]=Q(1,[95],[],9,0,0),Ge[me.IMLOG2]=Q(1,[95],[],9,0,0),Ge[me.IMLOG10]=Q(1,[95],[],9,0,0),Ge[me.IMSIN]=Q(1,[95],[],9,0,0),Ge[me.IMCOS]=Q(1,[95],[],9,0,0),Ge[me.IMEXP]=Q(1,[95],[],9,0,0),Ge[me.IMARGUMENT]=Q(1,[95],[],9,0,0),Ge[me.IMCONJUGATE]=Q(1,[95],[],9,0,0),Ge[me.IMAGINARY]=Q(1,[95],[],9,0,0),Ge[me.IMREAL]=Q(1,[95],[],9,0,0),Ge[me.COMPLEX]=Q(2,[95,95,95],[],9,0,0),Ge[me.IMSUM]=Q(1,[],[127],9,0,0),Ge[me.IMPRODUCT]=Q(1,[],[127],9,0,0),Ge[me.SERIESSUM]=Q(4,[95,95,95,127],[],9,0,0),Ge[me.FACTDOUBLE]=Q(1,[95],[],9,0,0),Ge[me.SQRTPI]=Q(1,[95],[],9,0,0),Ge[me.QUOTIENT]=Q(2,[95,95],[],9,0,0),Ge[me.DELTA]=Q(1,[95,95],[],9,0,0),Ge[me.GESTEP]=Q(1,[95,95],[],9,0,0),Ge[me.ISEVEN]=Q(1,[95],[],9,0,0),Ge[me.ISODD]=Q(1,[95],[],9,0,0),Ge[me.MROUND]=Q(2,[95,95],[],9,0,0),Ge[me.ERF]=Q(1,[95,95],[],9,0,0),Ge[me.ERFC]=Q(1,[95],[],9,0,0),Ge[me.BESSELJ]=Q(2,[95,95],[],9,0,0),Ge[me.BESSELK]=Q(2,[95,95],[],9,0,0),Ge[me.BESSELY]=Q(2,[95,95],[],9,0,0),Ge[me.BESSELI]=Q(2,[95,95],[],9,0,0),Ge[me.XIRR]=Q(2,[127,127,95],[],9,0,0),Ge[me.XNPV]=Q(3,[95,127,127],[],9,0,0),Ge[me.PRICEMAT]=Q(5,[95,95,95,95,95,95],[],9,0,0),Ge[me.YIELDMAT]=Q(5,[95,95,95,95,95,95],[],9,0,0),Ge[me.INTRATE]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.RECEIVED]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.DISC]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.PRICEDISC]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.YIELDDISC]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.TBILLEQ]=Q(3,[95,95,95],[],9,0,0),Ge[me.TBILLPRICE]=Q(3,[95,95,95],[],9,0,0),Ge[me.TBILLYIELD]=Q(3,[95,95,95],[],9,0,0),Ge[me.PRICE]=Q(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[me.YIELD]=Q(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[me.DOLLARDE]=Q(2,[95,95],[],9,0,0),Ge[me.DOLLARFR]=Q(2,[95,95],[],9,0,0),Ge[me.NOMINAL]=Q(2,[95,95],[],9,0,0),Ge[me.EFFECT]=Q(2,[95,95],[],9,0,0),Ge[me.CUMPRINC]=Q(6,[95,95,95,95,95,95],[],9,0,0),Ge[me.CUMIPMT]=Q(6,[95,95,95,95,95,95],[],9,0,0),Ge[me.EDATE]=Q(2,[95,95],[],9,0,0),Ge[me.EOMONTH]=Q(2,[95,95],[],9,0,0),Ge[me.YEARFRAC]=Q(2,[95,95,95],[],9,0,0),Ge[me.COUPDAYBS]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.COUPDAYS]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.COUPDAYSNC]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.COUPNCD]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.COUPNUM]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.COUPPCD]=Q(3,[95,95,95,95],[],9,0,0),Ge[me.DURATION]=Q(5,[95,95,95,95,95,95],[],9,0,0),Ge[me.MDURATION]=Q(5,[95,95,95,95,95,95],[],9,0,0),Ge[me.ODDLPRICE]=Q(7,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[me.ODDLYIELD]=Q(7,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[me.ODDFPRICE]=Q(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),Ge[me.ODDFYIELD]=Q(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),Ge[me.RANDBETWEEN]=Q(2,[95,95],[],9,4095,0),Ge[me.WEEKNUM]=Q(1,[95,95],[],9,0,0),Ge[me.AMORDEGRC]=Q(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[me.AMORLINC]=Q(6,[95,95,95,95,95,95,95],[],9,0,0),Ge[me.CONVERT]=Q(3,[95,95,95],[],9,0,0),Ge[me.ACCRINT]=Q(6,[95,95,95,95,95,95,95,95],[],9,0,0),Ge[me.ACCRINTM]=Q(4,[95,95,95,95,95],[],9,0,0),Ge[me.WORKDAY]=Q(2,[95,95,127],[],9,0,0),Ge[me.NETWORKDAYS]=Q(2,[95,95,127],[],9,0,0),Ge[me.GCD]=Q(1,[],[127],9,0,0),Ge[me.MULTINOMIAL]=Q(1,[],[127],9,0,0),Ge[me.LCM]=Q(1,[],[127],9,0,0),Ge[me.FVSCHEDULE]=Q(2,[95,127],[],9,0,0),Ge[me.CUBEKPIMEMBER]=Q(3,[2,2,1,2],[],10,0,0),Ge[me.CUBESET]=Q(2,[2,50,2,1,2],[],10,0,0),Ge[me.CUBESETCOUNT]=Q(1,[2],[],9,0,0),Ge[me.IFERROR]=Q(2,[47,575],[],47,0,0),Ge[me.COUNTIFS]=Q(2,[],[16,15],1,0,0),Ge[me.SUMIFS]=Q(3,[16],[16,15],1,0,0),Ge[me.AVERAGEIF]=Q(2,[16,15,16],[],1,0,0),Ge[me.AVERAGEIFS]=Q(3,[16],[16,15],1,0,0),Ge[me.AGGREGATE]=Q(3,[1,1,48,17],[16],1,0,0),Ge[me.BINOM_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.BINOM_INV]=Q(3,[1,1,1],[],1,0,0),Ge[me.CONFIDENCE_NORM]=Q(3,[1,1,1],[],1,0,0),Ge[me.CONFIDENCE_T]=Q(3,[1,1,1],[],1,0,0),Ge[me.CHISQ_TEST]=Q(2,[32,32],[],1,0,0),Ge[me.F_TEST]=Q(2,[32,32],[],1,0,0),Ge[me.COVARIANCE_P]=Q(2,[32,32],[],1,0,0),Ge[me.COVARIANCE_S]=Q(2,[32,32],[],1,0,0),Ge[me.EXPON_DIST]=Q(3,[1,1,4],[],1,0,0),Ge[me.GAMMA_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.GAMMA_INV]=Q(3,[1,1,1],[],1,0,0),Ge[me.MODE_MULT]=Q(1,[],[32],32,0,0),Ge[me.MODE_SNGL]=Q(1,[],[32],1,0,0),Ge[me.NORM_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.NORM_INV]=Q(3,[1,1,1],[],1,0,0),Ge[me.PERCENTILE_EXC]=Q(2,[49,1],[],1,0,0),Ge[me.PERCENTILE_INC]=Q(2,[49,1],[],1,0,0),Ge[me.PERCENTRANK_EXC]=Q(2,[49,1,65],[],1,0,0),Ge[me.PERCENTRANK_INC]=Q(2,[49,1,65],[],1,0,0),Ge[me.POISSON_DIST]=Q(3,[1,1,4],[],1,0,0),Ge[me.QUARTILE_EXC]=Q(2,[49,1],[],1,0,0),Ge[me.QUARTILE_INC]=Q(2,[49,1],[],1,0,0),Ge[me.RANK_AVG]=Q(2,[1,16,4],[],1,0,0),Ge[me.RANK_EQ]=Q(2,[1,16,4],[],1,0,0),Ge[me.STDEV_S]=Q(1,[],[49],1,0,0),Ge[me.STDEV_P]=Q(1,[],[49],1,0,0),Ge[me.T_DIST]=Q(3,[1,1,4],[],1,0,0),Ge[me.T_DIST_2T]=Q(2,[1,1],[],1,0,0),Ge[me.T_DIST_RT]=Q(2,[1,1],[],1,0,0),Ge[me.T_INV]=Q(2,[1,1],[],1,0,0),Ge[me.T_INV_2T]=Q(2,[1,1],[],1,0,0),Ge[me.VAR_S]=Q(1,[],[49],1,0,0),Ge[me.VAR_P]=Q(1,[],[49],1,0,0),Ge[me.WEIBULL_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.NETWORKDAYS_INTL]=Q(2,[95,95,75,127],[],9,0,0),Ge[me.WORKDAY_INTL]=Q(2,[95,95,75,127],[],9,0,0),Ge[me.ECMA_CEILING]=Q(2,[1,1],[],1,0,0),Ge[me.ISO_CEILING]=Q(1,[1,65],[],1,0,0),Ge[me.DEBUG]=Q(1,[2],[1151],1087,0,0),Ge[me.BETA_DIST]=Q(4,[1,1,1,4,65,65],[],1,0,0),Ge[me.BETA_INV]=Q(3,[1,1,1,65,65],[],1,0,0),Ge[me.CHISQ_DIST]=Q(3,[1,1,4],[],1,0,0),Ge[me.CHISQ_DIST_RT]=Q(2,[1,1],[],1,0,0),Ge[me.CHISQ_INV]=Q(2,[1,1],[],1,0,0),Ge[me.CHISQ_INV_RT]=Q(2,[1,1],[],1,0,0),Ge[me.F_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.F_DIST_RT]=Q(3,[1,1,1],[],1,0,0),Ge[me.F_INV]=Q(3,[1,1,1],[],1,0,0),Ge[me.F_INV_RT]=Q(3,[1,1,1],[],1,0,0),Ge[me.HYPGEOM_DIST]=Q(5,[1,1,1,1,4],[],1,0,0),Ge[me.LOGNORM_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.LOGNORM_INV]=Q(3,[1,1,1],[],1,0,0),Ge[me.NEGBINOM_DIST]=Q(4,[1,1,1,4],[],1,0,0),Ge[me.NORM_S_DIST]=Q(2,[1,4],[],1,0,0),Ge[me.NORM_S_INV]=Q(1,[1],[],1,0,0),Ge[me.T_TEST]=Q(4,[32,32,1,1],[],1,0,0),Ge[me.Z_TEST]=Q(2,[49,1,1],[],1,0,0),Ge[me.ERF_PRECISE]=Q(1,[95],[],9,0,0),Ge[me.ERFC_PRECISE]=Q(1,[95],[],9,0,0),Ge[me.GAMMALN_PRECISE]=Q(1,[1],[],1,0,0),Ge[me.CEILING_PRECISE]=Q(1,[1,65],[],1,0,0),Ge[me.FLOOR_PRECISE]=Q(1,[1,65],[],1,0,0),Ge[me.ACOT]=Q(1,[1],[],1,0,0),Ge[me.ACOTH]=Q(1,[1],[],1,0,0),Ge[me.COT]=Q(1,[1],[],1,0,0),Ge[me.COTH]=Q(1,[1],[],1,0,0),Ge[me.CSC]=Q(1,[1],[],1,0,0),Ge[me.CSCH]=Q(1,[1],[],1,0,0),Ge[me.SEC]=Q(1,[1],[],1,0,0),Ge[me.SECH]=Q(1,[1],[],1,0,0),Ge[me.IMTAN]=Q(1,[95],[],9,0,0),Ge[me.IMCOT]=Q(1,[95],[],9,0,0),Ge[me.IMCSC]=Q(1,[95],[],9,0,0),Ge[me.IMCSCH]=Q(1,[95],[],9,0,0),Ge[me.IMSEC]=Q(1,[95],[],9,0,0),Ge[me.IMSECH]=Q(1,[95],[],9,0,0),Ge[me.BITAND]=Q(2,[1,1],[],1,0,0),Ge[me.BITOR]=Q(2,[1,1],[],1,0,0),Ge[me.BITXOR]=Q(2,[1,1],[],1,0,0),Ge[me.BITLSHIFT]=Q(2,[1,1],[],1,0,0),Ge[me.BITRSHIFT]=Q(2,[1,1],[],1,0,0),Ge[me.PERMUTATIONA]=Q(2,[1,1],[],1,0,0),Ge[me.COMBINA]=Q(2,[1,1],[],1,0,0),Ge[me.XOR]=Q(1,[],[52],4,0,0),Ge[me.PDURATION]=Q(3,[1,1,1],[],1,0,0),Ge[me.BASE]=Q(2,[1,1,65],[],2,0,0),Ge[me.DECIMAL]=Q(2,[2,1],[],1,0,0),Ge[me.DAYS]=Q(2,[3,3],[],1,0,0),Ge[me.BINOM_DIST_RANGE]=Q(3,[1,1,1,65],[],1,0,0),Ge[me.GAMMA]=Q(1,[1],[],1,0,0),Ge[me.SKEW_P]=Q(1,[],[49],1,0,0),Ge[me.GAUSS]=Q(1,[1],[],1,0,0),Ge[me.PHI]=Q(1,[1],[],1,0,0),Ge[me.RRI]=Q(3,[1,1,1],[],1,0,0),Ge[me.UNICHAR]=Q(1,[1],[],2,0,0),Ge[me.UNICODE]=Q(1,[2],[],1,0,0),Ge[me.MUNIT]=Q(1,[1],[],32,0,0),Ge[me.ARABIC]=Q(1,[2],[],1,0,0),Ge[me.ISOWEEKNUM]=Q(1,[1],[],1,0,0),Ge[me.NUMBERVALUE]=Q(1,[2,66,66],[],1,0,0),Ge[me.SHEET]=Q(0,[50],[],1,4095,0),Ge[me.SHEETS]=Q(0,[48],[],1,4095,0),Ge[me.FORMULATEXT]=Q(1,[16],[],2,4095,0),Ge[me.ISFORMULA]=Q(1,[16],[],4,0,0),Ge[me.IFNA]=Q(2,[47,575],[],47,0,0),Ge[me.CEILING_MATH]=Q(1,[1,65,65],[],1,0,0),Ge[me.FLOOR_MATH]=Q(1,[1,65,65],[],1,0,0),Ge[me.IMSINH]=Q(1,[95],[],9,0,0),Ge[me.IMCOSH]=Q(1,[95],[],9,0,0),Ge[me.FILTERXML]=Q(2,[2,2],[],47,0,0),Ge[me.WEBSERVICE]=Q(1,[2],[],10,0,0),Ge[me.ENCODEURL]=Q(1,[2],[],10,0,0),Ge[me.FORECAST_ETS]=Q(3,[1,48,48,65,65,65],[],1,0,0),Ge[me.FORECAST_ETS_CONFINT]=Q(3,[1,48,48,65,65,65,65],[],1,0,0),Ge[me.FORECAST_ETS_SEASONALITY]=Q(2,[48,48,65,65],[],1,0,0),Ge[me.FORECAST_LINEAR]=Q(3,[1,32,32],[],1,0,0),Ge[me.FORECAST_ETS_STAT]=Q(3,[48,48,1,65,65,65],[],1,0,0),Ge[me.MAXIFS]=Q(3,[16],[16,15],1,0,0),Ge[me.MINIFS]=Q(3,[16],[16,15],1,0,0),Ge[me.TEXTJOIN]=Q(3,[114,68],[114],2,0,0),Ge[me.CONCAT]=Q(1,[],[114],2,0,0),Ge[me.IFS]=Q(2,[],[44,575],575,0,0),Ge[me.SWITCH]=Q(3,[47,575],[575,575],575,0,0),Ge[me.SINGLE]=Q(1,[1079,4],[],1055,0,1),Ge[me.AVERAGE_WEIGHTED]=Q(2,[],[113,113],1,0,1),Ge[me.ANCHORARRAY]=Q(1,[16],[],48,0,1),Ge[me.IMAGE]=Q(1,[2],[],2,0,1),Ge[me.RECORD]=Q(3,[47],[2,47],47,0,1),Ge[me.GRF]=Q(1,[15,2],[],15,0,1),Ge[me.UNIT]=Q(2,[15,2],[],15,0,1),Ge[me.RICHERROR]=Q(1,[1],[],10,0,1),Ge[me.FILTER]=Q(2,[48,48],[],32,0,1),Ge[me.FUN]=Q(1,[],[63],63,0,1),Ge[me.LET]=Q(3,[63,63,63],[],63,0,1),Ge[me.ARRAYMAKE]=Q(3,[1,1,63],[],32,0,1),Ge[me.APPLY]=Q(1,[],[63],63,0,1),Ge[me.ISFUN]=Q(1,[63],[],4,0,1),Ge[me.ARITY]=Q(1,[63],[],9,0,1),Ge[me.RECURSE]=Q(0,[],[],63,0,1);var Ve,xe=Q(0,[],[P.All],P.All,b.All,B.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot"}(Ve||(Ve={}));var We,He,Ke=U.Number|U.String|U.Boolean,Qe=U.Number|U.String|U.Boolean|U.Blank,Xe=Q(2,[U.Number,U.Number],[],U.Number,b.None,B.None),Ye=Q(1,[U.Number],[],U.Number,b.None,B.None),je=Q(1,[Ke],[],Ke,b.None,B.None),Je=Q(2,[U.String,U.String],[],U.String,b.None,B.None),qe=Q(2,[Qe,Qe],[],U.Boolean,b.None,B.None),ze=Q(2,[U.Range,U.Range],[],U.Range,b.AllCells,B.None),Ze=Q(2,[U.Range,U.Range],[],U.Range,b.None,B.None),$e=Q(2,[U.Boolean,U.Boolean],[],U.Boolean,b.None,B.None),er=[];function rr(e){var r=er[e];return null!=r?r:xe}function nr(e){var r=Ge[e];return null!=r?r:xe}function tr(e,r){var n=Ge[e];null!=n&&(n.staticPrecs=r)}function ar(e){return 1===e.length}function or(e){return 1===e.rows&&1===e.cols}function ir(e){return ar(e.sheet)}function ur(e){return or(e.range)}function cr(e){return or(e)?e:_(e.row,e.col,1,1)}function lr(e){return ur(e)?e:W(e.sheet,cr(e.range))}function sr(e,r){var n=e.row,t=e.col,a=r.row,o=r.col;return _(Math.min(n,a),Math.min(t,o),Math.abs(a-n)+1,Math.abs(o-t)+1)}function fr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===le.Literal&&pr(r.oper)===U.Missing)return 0}return e.args.length}(e)?[]:e.args}function dr(e,r){A("calc.runtime.getArgType",r);var n=e.headTypes,t=n.length;if(r<t)return n[r];var a=e.restTypes,o=a.length;return o>0?a[(r-t)%o]:P.None}function Er(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function pr(e){switch(typeof e){case"number":return U.Number;case"string":return U.String;case"boolean":return U.Boolean;default:return e.kind}}function vr(e){return"number"==typeof e&&isFinite(e)}function hr(e){return{kind:We.Success,value:e}}function Tr(e){return{kind:We.Failure,reason:e}}function Rr(e){return null!=e&&e.kind===We.Success}function Sr(e){return{kind:He.NotImplemented,features:e}}function Ir(e){return 0===e.length&&g("calc.lang.unavailable: expected nonempty array"),{kind:He.Unavailable,objects:e}}function gr(e){if(null!=e){var r=e.path,n=e.name;return null!=r&&"string"!=typeof r?(R.ULS.traceTag(595969803,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document path: type is "+typeof r),C):"string"!=typeof n?(R.ULS.traceTag(595969804,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document name: type is "+typeof n),C):e}}er[Ve.Add]=Xe,er[Ve.Sub]=Xe,er[Ve.Mul]=Xe,er[Ve.Div]=Xe,er[Ve.Pow]=Xe,er[Ve.Percent]=Ye,er[Ve.Neg]=Ye,er[Ve.Pos]=je,er[Ve.Concat]=Je,er[Ve.Eq]=qe,er[Ve.Ne]=qe,er[Ve.Lt]=qe,er[Ve.Le]=qe,er[Ve.Gt]=qe,er[Ve.Ge]=qe,er[Ve.Range]=ze,er[Ve.Isect]=Ze,er[Ve.Union]=Ze,er[Ve.And]=$e,er[Ve.Or]=$e,er[Ve.Xor]=$e,er[Ve.Min]=Xe,er[Ve.Max]=Xe,tr(me.ROW,b.OwnRow),tr(me.COLUMN,b.OwnCol),tr(me.SHEET,b.OwnDocSheets),tr(me.SHEETS,b.OwnDocSheets),tr(me.OFFSET,b.AllCells),tr(me.INDIRECT,b.AllCells),tr(me.SUMIF,b.AllCells),tr(me.NOW,b.Time),tr(me.TODAY,b.Time),tr(me.RAND,b.Calc),tr(me.RANDBETWEEN,b.Calc),tr(me.SUBTOTAL,b.CellProps),tr(me.CELL,b.CellProps|b.AllCells),tr(me.INFO,b.Calc),tr(me.FORMULATEXT,b.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(We||(We={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(He||(He={}));var Ar=65;function mr(e){for(var r=e+1,n="";r>0;){var t=(r-1)%26;n=String.fromCharCode(Ar+t)+n,r=Math.floor((r-t)/26)}return n}function Nr(e,r,n){var t=n.kind,a=n.index;return t===ce.Abs?r+e.formatNumber(a+1):0===a?r:r+e.leftBracket+e.formatNumber(a)+e.rightBracket}function Cr(e,r,n,t){if(r===oe.A1){if(null==n){return R.ULS.assertTag(595935437,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,r,n){var t=n.kind===ce.Abs,a=e.formatNumber(n.index+(t?0:r)+1);return t?"$"+a:a}(e,n,t)}return Nr(e,e.rowLetter,t)}function Or(e,r,n,t){if(r===oe.A1){if(null==n){return R.ULS.assertTag(595935438,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,r){var n=r.kind===ce.Abs,t=mr(r.index+(n?0:e));return n?"$"+t:t}(n,t)}return Nr(e,e.columnLetter,t)}function Lr(e){return function(r,n,t,a,o){var i=e(r,n,t,a);return n===oe.R1C1&&a.kind===o.kind&&a.index===o.index?i:i+":"+e(r,n,t,o)}}var Dr=Lr(Cr),Mr=Lr(Or);function _r(e,r,n,t,a){var o=Cr(e,r,null!=n?n.row:void 0,t),i=Or(e,r,null!=n?n.col:void 0,a);return r===oe.A1?i+o:o+i}var yr,Fr={ULS:new c.NulLogger};Object(c.initStopwatchFactory)(function(e){return Fr.ULS.traceTag(595948114,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,e)});!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet"}(yr||(yr={}));var kr=function(e){return!1},Ur={};function Pr(e){return void 0===Ur[e]&&(Ur[e]=kr(e)),Ur[e]}function br(e,r){return{wrap:e,unwrap:r}}function Br(e){return e}function wr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function Gr(e){var r=wr();for(var n in e)r[n]=e[n];return r}function Vr(e){return null!=e}function xr(e){return null==e}function Wr(e,r){return void 0!==e?e:r}var Hr=100;function Kr(e,r,n){return void 0===n&&(n=Hr),r.maxDepth=n,r.level=0,Qr(e,r)}function Qr(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var n;switch(r.level+=1,e.kind){case le.Literal:n=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===U.Missing)return r.visitMissing(e);if(e.kind===U.Error)switch(e.type){case w.NULL:return r.visitNullError(e);case w.DIV0:return r.visitDiv0Error(e);case w.VALUE:return r.visitValueError(e);case w.REF:return r.visitRefError(e);case w.NAME:return r.visitNameError(e);case w.NUM:return r.visitNumError(e);case w.NA:return r.visitNAError(e);case w.GETTING_DATA:return r.visitDataError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case le.Array:n=r.visitArray(e);break;case le.App:n=r.visitApp(e);break;case le.Paren:n=r.visitParen(e);break;case le.Name:n=r.visitName(e);break;case le.CellRef:n=r.visitCellRef(e);break;case le.Bad:n=r.visitBad(e);break;case le.Operator:n=r.visitOperator(e);break;case ue.Error:n=r.visitRefError(e);break;case ue.Single:n=r.visitSingle(e);break;case ue.Range:n=r.visitRange(e);break;case ue.Row:n=r.visitRow(e);break;case ue.Col:n=r.visitCol(e);break;case ie.Error:n=r.visitNameError(e);break;case ie.Relative:n=r.visitRelative(e);break;case ie.Document:n=r.visitDocument(e);break;case ie.Sheet:n=r.visitSheet(e);break;case ie.Ident:n=r.visitIdent(e);break;case ie.SheetRange:n=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,n}function Xr(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e}}function Yr(e,r,n){return{level:0,operVisitor:e,visitArray:Wr(n.vArray,r),visitApp:Wr(n.vApp,r),visitParen:Wr(n.vParen,r),visitName:Wr(n.vName,r),visitCellRef:Wr(n.vCellRef,r),visitBad:Wr(n.vBad,r),visitOperator:Wr(n.vOperator,r),visitRefError:Wr(n.vRefError,r),visitSingle:Wr(n.vSingle,r),visitRange:Wr(n.vRange,r),visitRow:Wr(n.vRow,r),visitCol:Wr(n.vCol,r),visitNameError:Wr(n.vNameError,r),visitRelative:Wr(n.vRelative,r),visitDocument:Wr(n.vDocument,r),visitSheet:Wr(n.vSheet,r),visitIdent:Wr(n.vIdent,r),visitSheetRange:Wr(n.vSheetRange,r)}}var jr=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","];var Jr={level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"}},visitArray:function(e){var r=[];return e.nodes.forEach(function(e){var n=[];e.forEach(function(e){n.push(Qr(e,Jr))}),r.push(n.join(","))}),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach(function(e){r.push(Qr(e,Jr))});var n=Qr(e.head,Jr);if(e.head.kind===le.Operator){if(e.head.id===Ve.Percent)return r[0]+"%";if(1===r.length)return n+r[0];if(2===r.length)return r[0]+n+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return n+"("+r.join(",")+")"},visitParen:function(e){return"("+Qr(e.node,Jr)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=Qr(e.qualifier,this)+"!"),r+Qr(e.ref,this)},visitBad:function(e){if(e.type===se.Sequence){var r=[];return e.contents.forEach(function(e){r.push(Qr(e,Jr))}),r.join("")}return e.contents},visitOperator:function(e){return jr[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){return r=e.row.index,n=e.row.kind===ce.Abs,t=e.col.index,(e.col.kind===ce.Abs?"$":"")+mr(t)+(n?"$":"")+(r+1);var r,n,t},visitRange:function(e){return Qr(e.ref1,Jr)+":"+Qr(e.ref2,Jr)},visitRow:function(e){var r=e.row1.index+1,n=e.row1.kind===ce.Abs,t=e.row2.index+1;return(n?"$":"")+r+":"+(e.row2.kind===ce.Abs?"$":"")+t},visitCol:function(e){var r=e.col1.index,n=e.col1.kind===ce.Abs,t=e.col2.index,a=e.col2.kind===ce.Abs;return(n?"$":"")+mr(r)+":"+(a?"$":"")+mr(t)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?Qr(e.document,Jr):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function qr(e){var r=function(e){try{return hr("="+Kr(e,Jr))}catch(e){return R.ULS.traceTag(595964180,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"PrettyPrinter failed: "+e),Jr.level=0,Tr(e)}}(e);if(r.kind===We.Success){return r.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp('[^/=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*/g/\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9/g/\\s\\ua0c2/gd]',"g"),"w")}}function zr(e){return qr(e.node)}function Zr(e){return T.FormulaNode=qr,T.Formula=zr,{localeInfo:e}}function $r(e,r){var n;S(e),function(e){Fr.ULS=e}(e),"function"==typeof(n=r)&&(kr=n)}function en(e,r,n,t,a,o,i,u,c,l,s,f,d,E,p,v,h,T,R,S,I,g){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:n,getWorksheetFuncName:t,isNumeral:a,getOrdinal:o,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:l,trueName:s,falseName:f,rowLetter:d,columnLetter:E,leftBrace:p,rightBrace:v,leftBracket:h,rightBracket:T,decimalSeparator:R,listSeparator:S,columnSeparator:I,rowSeparator:g}}var rn,nn,tn,an,on,un,cn,ln,sn,fn,dn,En,pn=ue,vn=ce,hn=ie,Tn=Te,Rn=F,Sn=M,In=D,gn=V,An=H,mn=K,Nn=sr,Cn=Rr,On=He,Ln=Sr;function Dn(e){if(void 0===e)return!0;switch(e.kind){case On.NotImplemented:case On.Unavailable:return!0}return!1}function Mn(e,r,n){return function(t,a){return void 0===a?r(t):Dn(a)?n(a,t):e(a)}}function _n(e,r){return function(n){if(Array.isArray(n)){for(var t=void 0,a=0;a<n.length;a+=1){var o=n[a];if(void 0!==(t=e(o)))return[o,t]}return r}var i=e(n);return void 0===i?r:[n,i]}}function yn(e,r){return r.kind===vn.Abs?r.index:e+r.index}function Fn(e,r){var n=yn(e.row,r.row),t=yn(e.col,r.col);return Rn(n,t)}function kn(e,r){switch(r.kind){case pn.Error:return;case pn.Single:var n=Fn(e,r);return Rn(n.row,n.col);case pn.Range:var t=Fn(e,r.ref1),a=Fn(e,r.ref2);return Nn(t,a);case pn.Row:return Ln(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case pn.Col:return Ln(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function Un(e){function r(r){var n=e.getDocumentLoc(r.path,r.document);return Vr(n)?n:void 0}function n(n,t){var a=Vr(t.document)?r(t.document):n;if(!xr(a)){var o=e.getSheetIndex(a,t.sheet);return Cn(o)?Vr(o.value)?Sn(a,o.value):void 0:o.reason}}return{resolveName:function(t,a,o){if(xr(a)||a.kind===hn.Relative)return[mn(t.sheet,o),mn(An(t.sheet.document),o)];var i=function(t,a){switch(a.kind){case hn.Document:var o=r(a);return Vr(o)?An(o):o;case hn.Sheet:return n(t.sheet.document,a);case hn.Ident:var i=t.sheet.document,u=e.getSheetIndex(i,a.name);if(Cn(u)){if(Vr(u.value))return Sn(i,u.value);var c=r(Tn(a.name));return Vr(c)?An(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",a)}}(t,a);return Dn(i)?i:mn(i,o)},resolveGridRef:kn,resolveCellRef:function(r,t,a){var o=kn(r.range,a);if(Dn(o))return o;var i=xr(t)?r.sheet:function(r,t){switch(t.kind){case hn.Error:return;case hn.Sheet:return n(r.document,t);case hn.SheetRange:var a=r.document,o=e.getSheetIndex(a,t.sheet1);if(!Cn(o))return o.reason;var i=e.getSheetIndex(a,t.sheet2);if(!Cn(i))return i.reason;var u=o.value,c=i.value;if(xr(u)||xr(c))return;return u===c?Sn(a,u):In(a,Math.min(u,c),Math.abs(c-u)+1);case hn.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",t)}}(r.sheet,t);return Dn(i)?i:gn(i,o)}}}(nn=rn||(rn={})).FormulaSource=p,nn.documentLoc=O,nn.sheetIndex=M,nn.sheetRange=D,nn.gridCell=F,nn.gridRange=y,nn.sheetGridCell=W,nn.sheetGridRange=x,nn.sheetGridCube=V,nn.documentScope=H,nn.nameLoc=K,(an=tn||(tn={})).SpecialPrecs=b,an.OperKind=U,an.ErrorType=w,an.ErrorTypeBounds=G,an.precedents=X,an.errorOper=Y,an.nullErrorOper=j,an.div0ErrorOper=J,an.valueErrorOper=q,an.refErrorOper=z,an.nameErrorOper=Z,an.numErrorOper=$,an.naErrorOper=ee,an.gettingDataErrorOper=re,an.arrayOper=ne,an.rangeSeqOper=te,an.range3DOper=ae,an.missingOper=fe,an.blankOper=de,(un=on||(on={})).RefStyle=oe,un.QualifierKind=ie,un.CellRefKind=ue,un.PosKind=ce,un.NodeKind=le,un.BadType=se,un.errorQualifierLabeled=Ee,un.relativeQualifierLabeled=pe,un.errorQualifier=ve,un.relativeQualifier=he,un.documentQualifier=Te,un.sheetQualifier=Re,un.identQualifier=Se,un.sheetRangeQualifier=Ie,un.pos=ge,un.cellRefErrorLabeled=Ae,un.cellRefError=Ne,un.cellRefSingle=Ce,un.cellRefRange=Oe,un.cellRefRow=Le,un.cellRefCol=De,un.formula=Me,un.formulaSpan=_e,un.literalNode=ye,un.arrayNode=Fe,un.appNode=ke,un.operatorNode=Ue,un.parenNode=Pe,un.nameNode=be,un.cellRefNode=Be,un.badNode=we,(ln=cn||(cn={})).SignatureType=P,ln.FunctionFlags=B,ln.OperatorId=Ve,ln.WorksheetFuncId=me,ln.SpecialPrecs=b,ln.functionType=Q,ln.unknownFunctionType=xe,ln.getOperatorType=rr,ln.getWorksheetFuncType=nr,(fn=sn||(sn={})).isSheetIndex=ar,fn.isSheetGridRange=ir,fn.isGridCell=or,fn.isSheetGridCell=ur,fn.gridRangeAnchor=cr,fn.sheetGridRangeAnchor=lr,fn.gridCellRange=sr,fn.getArguments=fr,fn.getArgType=dr,fn.isValidArgsLength=Er,fn.operKind=pr,fn.ResultKind=We,fn.success=hr,fn.failure=Tr,fn.isSuccess=Rr,fn.ReasonKind=He,fn.notImplemented=Sr,fn.unavailable=Ir,fn.columnName=mr,fn.formatRow=Cr,fn.formatCol=Or,fn.formatRowRange=Dr,fn.formatColRange=Mr,fn.formatCellPos=_r,fn.createResolver=Un,fn.createResolutionHandler=Mn,fn.createNameFinder=_n,fn.defaultLiteralVisitor=Xr,fn.defaultFormulaVisitor=Yr,fn.dispatch=Qr,fn.startVisit=Kr,(En=dn||(dn={})).localeInfo=en,En.calcConfig=Zr,En.initCalc=$r;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Pn=function(e,r){return(Pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])})(e,r)};function bn(e,r){function n(){this.constructor=e}Pn(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var Bn=function(){return(Bn=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var a in r=arguments[n])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};var wn,Gn=sn.ReasonKind,Vn=sn.notImplemented;!function(e){e.BadFormulaString="BadFormulaString"}(wn||(wn={}));var xn=Bn({},Gn,wn);function Wn(e){return{kind:xn.BadFormulaString,message:e}}var Hn=" \t\n\r";function Kn(e){return Hn.indexOf(e)>=0}function Qn(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Xn(e,r){return"."===r||Qn(e,r)||e.isNumeral(r)}function Yn(e,r){var n=r-1;return function(r){if(r<=n){var t=e+": internal error: no progress made at index "+r;return R.ULS.assertTag(595980821,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}n=r}}function jn(e,r,n){for(var t=r;t<e.length&&n(e[t]);t+=1);return[e.substring(r,t),t]}function Jn(e,r,n,t,a){var o=e[r];return n(o)?1:o===t&&a(e[r+1])?2:0}function qn(e,r,n,t,a){for(var o=[],i=r,u=r;u<e.length;){var c=Jn(e,u,n,t,a);if(0===c)break;2===c&&(i!==u&&o.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&o.push(e.substring(i,u)),[o.join(""),u]}var zn,Zn,$n,et,rt=tn.nullErrorOper,nt=tn.div0ErrorOper,tt=tn.valueErrorOper,at=tn.refErrorOper,ot=tn.nameErrorOper,it=tn.numErrorOper,ut=tn.naErrorOper,ct=tn.gettingDataErrorOper,lt=cn.OperatorId;function st(e,r,n){return{kind:e,start:r,chars:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(zn||(zn={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Zn||(Zn={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}($n||($n={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(et||(et={}));var ft=function(e){return st(zn.End,e,"")},dt=function(e,r){return st(zn.Spaces,e,r)},Et=function(e,r){return st(zn.Unexpected,e,r)},pt=function(e,r){return st(zn.Ident,e,r)};function vt(e,r,n,t){return{kind:e,start:r,chars:n,value:t}}var ht=function(e){return vt(zn.Left,e,"(",Zn.Paren)},Tt=function(e,r){return vt(zn.Left,e,r,Zn.Bracket)},Rt=function(e,r){return vt(zn.Left,e,r,Zn.Brace)},St=function(e){return vt(zn.Left,e,"'",Zn.SQuote)},It=function(e){return vt(zn.Right,e,")",Zn.Paren)},gt=function(e,r){return vt(zn.Right,e,r,Zn.Bracket)},At=function(e,r){return vt(zn.Right,e,r,Zn.Brace)},mt=function(e){return vt(zn.Right,e,"'",Zn.SQuote)},Nt=function(e,r){return vt(zn.Sep,e,r,$n.List)},Ct=function(e,r){return vt(zn.Sep,e,r,$n.Col)},Ot=function(e,r){return vt(zn.Sep,e,r,$n.Row)},Lt=function(e){return vt(zn.Sep,e,"!",$n.Qual)},Dt={"#ALL":function(e,r){return vt(zn.SpecialRef,e,r,et.All)},"#DATA":function(e,r){return vt(zn.SpecialRef,e,r,et.Data)},"#HEADERS":function(e,r){return vt(zn.SpecialRef,e,r,et.Headers)},"#TOTALS":function(e,r){return vt(zn.SpecialRef,e,r,et.Totals)},"#THIS ROW":function(e,r){return vt(zn.SpecialRef,e,r,et.ThisRow)}};function Mt(e,r,n,t,a,o,i,u){return{kind:zn.CellRef,start:e,chars:r,row:n,col:t,refStyle:a,isName:o,isNumber:i,isQualPart:u}}function _t(e,r,n,t){void 0===t&&(t=!0);var a="number"==typeof n&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:zn.Literal,start:e,chars:r,oper:n,hasRight:t,isQualPart:a}}var yt=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return _t(e,r,rt)},function(e,r){return _t(e,r,nt)},function(e,r){return _t(e,r,tt)},function(e,r){return _t(e,r,at)},function(e,r){return _t(e,r,ot)},function(e,r){return _t(e,r,it)},function(e,r){return _t(e,r,ut)},function(e,r){return _t(e,r,ct)}];function Ft(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?_t(r,n,!1):0===e.stringCompareCI(e.trueName,n)?_t(r,n,!0):pt(r,n)}var kt=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function Ut(e){var r=kt[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(n){return{kind:zn.Operator,start:n,chars:r,value:e}}}var Pt=Ut(lt.Add),bt=Ut(lt.Sub),Bt=Ut(lt.Mul),wt=Ut(lt.Div),Gt=Ut(lt.Pow),Vt=Ut(lt.Percent),xt=Ut(lt.Concat),Wt=Ut(lt.Eq),Ht=Ut(lt.Lt),Kt=Ut(lt.Gt),Qt=Ut(lt.Ne),Xt=Ut(lt.Le),Yt=Ut(lt.Ge),jt=Ut(lt.Range);Ut(lt.And),Ut(lt.Or),Ut(lt.Xor),Ut(lt.Dot);function Jt(e,r,n){return n.push(r),r.start+e}var qt=on.PosKind,zt=on.pos,Zt=on.RefStyle;function $t(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function ea(e){return e.toUpperCase().charCodeAt(0)-65+1}function ra(e,r,n,t){for(var a=0,o=t,i=Math.min(n.length,t+r);o<i;o+=1){var u=n[o];if(!e.isNumeral(u))break;a=10*a+e.getOrdinal(u)}return o===i&&e.isNumeral(n[o])?[0,t]:[a,o]}function na(e,r,n){return function(t,a,o,i){var u=function(e,r){return"$"===e[r]?[qt.Abs,r+1]:[qt.Rel,r]}(o,i),c=u[0],l=u[1],s=e(t,n,o,l),f=s[0],d=s[1];if(d>l){if(f<1||f>r)return;var E=c===qt.Rel?f-a:f;return[zt(c,E-1),!1,d]}return[void 0,!1,i]}}function ta(e,r,n){return function(t,a,o,i){var u=e?t.rowLetter:t.columnLetter;if(i>=o.length||0!==t.stringCompareCI(u,o[i]))return[void 0,!1,i];var c=i+1,l=ra(t,n,o,c),s=l[0],f=l[1];if(f>c){if(s<1||s>r)return;return[zt(qt.Abs,s-1),!1,f]}if(o[c]===t.leftBracket){var d=1;"+"===o[c+=1]?c+=1:"-"===o[c]&&(d=-1,c+=1);var E=ra(t,n,o,c),p=E[0],v=E[1];if(v>c&&p<r&&o[v]===t.rightBracket)return[zt(qt.Rel,p*d),!0,v+1]}return[!1,!1,f]}}function aa(e,r,n,t,a,o,i){var u=t(e,r,o,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],l=u[1],s=u[2];if(s>i){var f=a(e,n,o,s);if(null==f)return l?[c,void 0,!0,s]:[void 0,void 0,!1,i];var d=f[0],E=f[1],p=f[2];return p>s?[c,d,E,p]:[c,void 0,l,s]}var v=a(e,n,o,i);if(null==v)return[void 0,void 0,!1,i];var h=v[0],T=v[1],R=v[2];return R>i?[void 0,h,T,R]:[void 0,void 0,!1,i]}var oa=na(ra,1048576,7),ia=na(function(e,r,n,t){return function(e,r,n){for(var t=0,a=n,o=Math.min(r.length,n+e);a<o;a+=1){var i=r[a];if(!$t(i))break;t=26*t+ea(i)}return a===o&&$t(r[a])?[0,n]:[t,a]}(r,n,t)},16384,3),ua=ta(!0,1048576,7),ca=ta(!1,16384,5);function la(e,r,n,t,a,o){var i,u,c,l,s,f=function(e,r,n,t,a){if(r===Zt.A1&&null!=n){var o=n.range,i=aa(e,o.col,o.row,ia,oa,t,a),u=i[0],c=i[1],l=i[2],s=i[3];if((null!=c&&null!=u||null!=c&&c.kind===qt.Abs||null!=u&&u.kind===qt.Abs||(null!=c||null!=u)&&(":"===t[a-1]||":"===t[s]))&&(l||s>=t.length||!Xn(e,t[s])))return[Zt.A1,c,u,s]}var f=aa(e,void 0,void 0,ua,ca,t,a),d=f[0],E=f[1],p=f[2],v=f[3];if((null!=d||null!=E)&&(p||v>=t.length||!Xn(e,t[v])))return[Zt.R1C1,d,E,v]}(e,r,n,t,a);if(null!=f){var d=f[0],E=f[1],p=f[2],v=f[3],h=t.substring(v,a);return Jt(v-a,d===Zt.A1?function(e,r,n,t){var a=null==n&&null!=t&&t.kind===on.PosKind.Rel,o=null==t&&null!=n&&n.kind===on.PosKind.Rel,i=!(null!=n&&n.kind!==on.PosKind.Rel||null!=t&&t.kind!==on.PosKind.Rel);return Mt(e,r,n,t,on.RefStyle.A1,a,o,i)}(a,h,E,p):(i=a,u=h,l=p,s=!(!1!==(c=E)&&null!=c&&c.kind!==on.PosKind.Abs||!1!==l&&null!=l&&l.kind!==on.PosKind.Abs),Mt(i,u,!1===c?on.pos(on.PosKind.Rel,0):c,!1===l?on.pos(on.PosKind.Rel,0):l,on.RefStyle.R1C1,!1,!1,s)),o)}}var sa=tn.numErrorOper,fa=tn.ErrorTypeBounds,da="+-*/^%&=<>:";function Ea(e){return da.indexOf(e)>=0}var pa={"+":Pt,"-":bt,"*":Bt,"/":wt,"^":Gt,"%":Vt,"&":xt,"=":Wt,"<":Ht,">":Kt,":":jt},va={"<>":Qt,"<=":Xt,">=":Yt};function ha(e,r,n){if(r<e.length-1){var t=va[e.substr(r,2)];if(null!=t)return Jt(2,t(r),n)}var a=pa[e[r]];if(null!=a)return Jt(1,a(r),n);return R.ULS.assertTag(595980822,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Ta(e,r,n,t){function a(n){var t=n,a=r[t];if("e"!==a&&"E"!==a)return n;if((t+=1)>=r.length)return n;if("+"===(a=r[t])||"-"===a){if((t+=1)>=r.length)return n;a=r[t]}if(!e.isNumeral(a))return n;for(t+=1;t<r.length&&e.isNumeral(r[t]);t+=1);return t}function o(n,t){var o=n,i=r[o];if(i===e.decimalSeparator){if((o+=1)>=r.length)return t?n:o;i=r[o]}if(!e.isNumeral(i))return t?n:a(o);for(o+=1;o<r.length;o+=1)if(!e.isNumeral(r[o]))return a(o);return o}for(var i=n;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=o(i,i===n);break}if(i>n){var u=r.substring(n,i),c=e.parseNumber(u);return Jt(i-n,_t(n,u,vr(c)?c:sa,!0),t),i}}function Ra(e,r,n){var t=qn(e,r+1,function(e){return'"'!==e},'"',function(e){return'"'===e}),a=t[0],o=t[1],i=e.substring(r,o+1);return o<e.length?Jt(o+1-r,_t(r,i,a,!0),n):Jt(o-r,_t(r,i,a,!1),n)}function Sa(e,r,n,t){for(var a=fa.First;a<=fa.Last;a+=1){var o=e.errorNames[a],i=r.substr(n,o.length),u=yt[a];if(0===e.stringCompareCI(o,i)&&null!=u)return Jt(o.length,u(n,i),t)}}var Ia=Object.getOwnPropertyNames(Dt);function ga(e,r,n,t){for(var a=0;a<Ia.length;a+=1){var o=Ia[a],i=r.substr(n,o.length);if(i.toUpperCase()===o)return Jt(o.length,Dt[o](n,i),t)}}function Aa(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function ma(e,r,n,t){var a=Jt(1,Tt(n,r[n]),t);"#"===r[a]&&(null!=(l=ga(0,r,a,t))&&(a=l));for(var o=function(r){return Aa(e,r)},i=function(r){return!Aa(e,r)},u=Yn("calc.parse.tokenizeBracketedColRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Jt(1,gt(a,c),t);if(Jn(r,a,o,"'",i)>0){var l,s=qn(r,a,o,"'",i),f=s[0];a=Jt((l=s[1])-a,pt(a,f),t)}else a=Jt(1,Et(a,c),t)}return a}function Na(e,r){return!Kn(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function Ca(e,r,n,t){var a=Jt(1,Tt(n,r[n]),t);"#"===r[a]&&(null!=(f=ga(0,r,a,t))&&(a=f));for(var o=function(r){return Na(e,r)},i=function(r){return!Na(e,r)},u=Yn("calc.parse.tokenizeBracketedRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Jt(1,gt(a,c),t);if(Jn(r,a,o,"'",i)>0){var l=qn(r,a,o,"'",i),s=l[0];a=Jt((f=l[1])-a,pt(a,s),t)}else if(Kn(c)){var f,d=jn(r,a,Kn);s=d[0];a=Jt((f=d[1])-a,dt(a,s),t)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Jt(1,Et(a,c),t):ma(e,r,a,t):Jt(1,Nt(a,c),t):Jt(1,jt(a),t)}return a}var Oa,La="':*?";function Da(e,r,n,t){for(var a=Jt(1,St(n),t),o=function(r){return function(e,r){return La.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=Yn("calc.parse.tokenizeQuotedQualifier",a);a<r.length;){u(a);var c=r[a];if("'"===c&&"'"!==r[a+1])return Jt(1,mt(a),t);if(":"!==c)if(c!==e.leftBracket)if(Jn(r,a,o,"'",i)>0){var l=qn(r,a,o,"'",i),s=l[0];a=Jt(l[1]-a,pt(a,s),t)}else a=Jt(1,Et(a,c),t);else a=Ca(e,r,a,t);else a=Jt(1,jt(a),t)}return a}function Ma(e,r,n,t){for(var a=e[r],o=r+1;o<e.length;o+=1){var i=e[o];if(i.kind!==n)break;a=t(a,i)}return[a,o]}function _a(e,r){return Et(e.start,e.chars+r.chars)}function ya(e,r,n,t,a){for(var o=function(e,r,n,t,a){for(var o=[],i=[],u=Oa.Decimal,l=a,s=Yn("calc.parse.tokenize",l);l<t.length;){s(l);var f=la(e,r,n,t,l,o);if(null==f){var d=t[l];if(u===Oa.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var E=Ta(e,t,l,o);if(null!=E){l=E,u=Oa.FieldAccess;continue}if(d!==e.decimalSeparator){var p="calc.parse.tokenize: failed to tokenize numeral at "+l;return R.ULS.assertTag(595980823,c.LogCategory.msoulscat_ES_EWAJS,!1,p)}}if('"'!==d)if(Qn(e,d)){var v=jn(t,l,function(r){return Xn(e,r)}),h=v[0];l=Jt(v[1]-l,Ft(e,l,h),o),u=Oa.FieldAccess}else if("#"!==d)if(Ea(d))l=ha(t,l,o),u=Oa.Decimal;else if(Kn(d)){var T=jn(t,l,Kn);h=T[0],l=Jt(T[1]-l,dt(l,h),o),u=Oa.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===Zn.Brace){if(d===e.columnSeparator){l=Jt(1,Ct(l,d),o),u=Oa.Decimal;continue}if(d===e.rowSeparator){l=Jt(1,Ot(l,d),o),u=Oa.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(l=Jt(1,Et(l,d),o),u=Oa.Decimal):(l=Da(e,t,l,o),u=Oa.Decimal):(l=Jt(1,Lt(l),o),u=Oa.Decimal):(l=Jt(1,Nt(l,d),o),u=Oa.Decimal)}else l=Jt(1,gt(l,d),o),u=Oa.FieldAccess;else l=Ca(e,t,l,o),u=Oa.FieldAccess;else i.length>0&&i[i.length-1]===Zn.Brace&&i.pop(),l=Jt(1,At(l,d),o),u=Oa.FieldAccess;else i.push(Zn.Brace),l=Jt(1,Rt(l,d),o),u=Oa.Decimal;else i.length>0&&i[i.length-1]===Zn.Paren&&i.pop(),l=Jt(1,It(l),o),u=Oa.FieldAccess;else i.push(Zn.Paren),l=Jt(1,ht(l),o),u=Oa.Decimal;else{var S=Sa(e,t,l,o);if(null!=S){l=S,u=Oa.FieldAccess;continue}l=Jt(1,Et(l,d),o),u=Oa.Decimal}else l=Ra(t,l,o),u=Oa.FieldAccess}else l=f,u=Oa.FieldAccess}return o}(e.config.localeInfo,r,n,t,a),i=[],u=0;u<o.length;){var l=o[u];if(l.kind!==zn.Unexpected)i.push(l),u+=1;else{var s=Ma(o,u,zn.Unexpected,_a),f=s[0],d=s[1];i.push(f),u=d}}return i.push(ft(t.length)),i}function Fa(e,r,n,t){var a=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,n,t,function(e,r){a=[e,r]},function(){a=!1})),null==a){var o="calc.parse.runParser: internal error: parser did not call resolve or reject on "+E(r);return R.ULS.assertTag(595980827,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}function ka(e){return function(r,n,t,a,o){return a(e,n)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(Oa||(Oa={}));var Ua,Pa=function(e,r,n,t,a){return a};function ba(e,r){return function(n,t,a,o,i){return e(n,t,a,function(e,t){return r(a,e)(n,t,a,o,i)},i)}}function Ba(e,r){return function(n,t,a,o,i){return e(n,t,a,o,function(){return r(n,t,a,o,i)})}}function wa(e){return 0===e.length?Pa:e.reduce(Ba)}function Ga(e,r){return function(n,t,a,o,i){return e(n,t,a,o,function(){return o(r,t)})}}function Va(e,r){return function(n,t,a,o,i){var u=n[t];if(null==u)return i;var c=e(a,u);return null==c?i:o(c,t+r)}}function xa(e){return Va(e,1)}function Wa(e){return Va(e,0)}function Ha(e){return function(r,n,t,a,o){var i=r[n],u=r[n+1];if(null==i||null==u)return o;var c=e(t,i,u);return null==c?o:a(c,n+1)}}function Ka(e,r,n){return function(t,a,o,i,u){var l=n,s=a;function f(){return e(t,s,o,d,p)}function d(e,n){if(n<=s){var a=E(t),i="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return R.ULS.assertTag(595980829,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return l=r(o,e,l),s=n,f}function p(){return i(l,s)}return f}}function Qa(e,r){return Ka(e,function(e,r,n){return n.push(r),n},r)}function Xa(e){return function(r,n,t,a,o){return Qa(e,[])(r,n,t,a,o)}}function Ya(e,r){return ba(e,function(e,n){return Qa(r,[n])})}function ja(e){var r=e.length;return function(n,t,a,o,i){var u=t,c=[];function l(){return e[c.length](n,u,a,s,i)}function s(e,n){return u=n,c.push(e),c.length<r?l:o(c,u)}return l}}function Ja(e,r){return ja([e,r])}function qa(e,r,n,t,a){return ja([e,r,n,t,a])}function za(e,r){return function(n,t,a,o,i){return e(n,t,a,function(e,n){return o(r(a,e),n)},i)}}function Za(e,r,n){return za(ja([e,r]),function(e,r){return n(e,r[0],r[1])})}function $a(e,r,n,t){return za(ja([e,r,n]),function(e,r){return t(e,r[0],r[1],r[2])})}function eo(e,r,n,t,a){return za(ja([e,r,n,t]),function(e,r){return a(e,r[0],r[1],r[2],r[3])})}function ro(e,r,n,t,a,o){return za(ja([e,r,n,t,a]),function(e,r){return o(e,r[0],r[1],r[2],r[3],r[4])})}function no(e,r){return Za(e,r,function(e,r,n){return r})}function to(e,r){return Za(e,r,function(e,r,n){return n})}function ao(e,r){var n=e.spans[r.label];if(null==n){var t="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+E(r);return R.ULS.assertTag(595980824,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}return n}function oo(e,r,n,t,a){var o=e.label;return e.label+=1,e.spans[o]=on.formulaSpan(r,n,t,a),o}function io(e,r,n,t){var a=ao(e,n);return a.pre=r,a.post=t,n}function uo(e,r,n){return function(t,a,o,i,u){var c=o.leftDelim,l=o.listSep;return o.leftDelim=e,o.listSep=r,n(t,a,o,function(e,r){return o.leftDelim=c,o.listSep=l,i(e,r)},function(){return o.leftDelim=c,o.listSep=l,u})}}function co(e,r){return r.kind===zn.Spaces||r.kind===zn.End?r.start:ao(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(Ua||(Ua={}));var lo=Ga(xa(function(e,r){return r.kind===zn.Spaces?r.chars:void 0}),"");function so(e){return $a(lo,xa(e),lo,io)}var fo=so(function(e,r){return r.kind!==on.NodeKind.Operator||r.id!==cn.OperatorId.Add&&r.id!==cn.OperatorId.Sub?void 0:r}),Eo=Za(xa(function(e,r){if(r.kind===on.NodeKind.Operator){if(r.id===cn.OperatorId.Add)return on.operatorNode(cn.OperatorId.Pos,r.label);if(r.id===cn.OperatorId.Sub)return on.operatorNode(cn.OperatorId.Neg,r.label)}}),lo,function(e,r,n){return io(e,"",r,n)}),po=so(function(e,r){return r.kind!==on.NodeKind.Operator||r.id!==cn.OperatorId.Mul&&r.id!==cn.OperatorId.Div?void 0:r}),vo=so(function(e,r){return r.kind===on.NodeKind.Operator&&r.id===cn.OperatorId.Pow?r:void 0}),ho=function(e){return Za(lo,xa(e),function(e,r,n){return io(e,r,n,"")})}(function(e,r){return r.kind===on.NodeKind.Operator&&r.id===cn.OperatorId.Percent?r:void 0}),To=so(function(e,r){return r.kind===on.NodeKind.Operator&&r.id===cn.OperatorId.Concat?r:void 0}),Ro=so(function(e,r){return r.kind===on.NodeKind.Operator&&r.id>=cn.OperatorId.Eq&&r.id<=cn.OperatorId.Ge?r:void 0}),So=so(function(e,r){return r.kind===on.NodeKind.Operator&&r.id===cn.OperatorId.Range?r:void 0}),Io=so(function(e,r){return r.kind===on.NodeKind.Operator&&r.id===cn.OperatorId.Union?r:void 0}),go=Ha(function(e,r,n){if(r.kind===zn.Spaces&&n.kind!==zn.End&&n.kind!==on.NodeKind.Operator){var t=oo(e,r.start,co(e,n),r.chars,"");return on.operatorNode(cn.OperatorId.Isect,t)}});function Ao(e,r,n){return Za(e,Xa(Ja(r,e)),function(e,r,t){return 0===t.length?r:t.reduce(n(e),r)})}function mo(e){return function(r,n){var t=n[0],a=n[1],o=ao(e,r).start,i=ao(e,a).end,u=oo(e,o,i,"","");return on.appNode(t,[r,a],!0,u)}}function No(e,r){var n=oo(e,ao(e,r[0]).start,ao(e,r[r.length-1]).end,"","");return on.badNode(on.BadType.Sequence,r,n)}var Co,Oo,Lo=Ao(Za(function(e,r,n,t,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+E(e);return R.ULS.assertTag(595980864,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(co(n,o),r)},Xa(xa(function(e,r){return r.kind!==on.NodeKind.Operator&&r.kind!==zn.Spaces&&r.kind!==zn.End?r:void 0})),function(e,r,n){return 0===n.length?on.literalNode(tn.missingOper,!0,oo(e,r,r,"","")):1===n.length?n[0]:No(e,n)}),So,mo),Do=Ao(Lo,go,mo),Mo=Ao(Do,Io,mo),_o=Ao((Co=Mo,Oo=function(e){var r=!0;return function(n,t){var a=ao(e,t).start,o=ao(e,n).end,i=oo(e,a,o,"","");if(r&&(r=!1,n.kind===on.NodeKind.Literal&&"number"==typeof n.oper)){var u=t.id===cn.OperatorId.Pos?n.oper:-n.oper;return on.literalNode(u,!0,i)}return on.appNode(t,[n],!0,i)}},Za(Xa(Eo),Co,function(e,r,n){return 0===r.length?n:r.reduceRight(Oo(e),n)})),ho,function(e){return function(r,n){var t=n[0],a=n[1],o=ao(e,r).start,i=ao(e,t).end,u=oo(e,o,i,"",""),c=on.appNode(t,[r],!0,u);return a.kind===on.NodeKind.Literal&&sn.operKind(a.oper)===tn.OperKind.Missing?c:No(e,[c,a])}}),yo=Ao(_o,vo,mo),Fo=Ao(yo,po,mo),ko=Ao(Fo,fo,mo),Uo=Ao(ko,To,mo),Po=Ao(Uo,Ro,mo);var bo=Ga(xa(function(e,r){return r.kind===zn.Spaces?r.chars:void 0}),""),Bo=function(e,r,n,t,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+E(e);return R.ULS.assertTag(595980830,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(o.start,r)};function wo(e){return xa(function(r,n){return n.kind===zn.Sep&&n.value===e||void 0})}function Go(e){return xa(function(r,n){return n.kind===zn.Left&&n.value===e?n.start:void 0})}function Vo(e){return xa(function(r,n){return n.kind===zn.Right&&n.value===e||void 0})}var xo,Wo=wo($n.List),Ho=wo($n.Row),Ko=wo($n.Col),Qo=wo($n.Qual),Xo=Go(Zn.Paren),Yo=Vo(Zn.Paren),jo=Go(Zn.Brace),Jo=Vo(Zn.Brace),qo=Go(Zn.SQuote),zo=Vo(Zn.SQuote),Zo=xa(function(e,r){return r.kind===zn.Operator&&r.value===cn.OperatorId.Range||void 0}),$o=xo={impl:function(e,r,n,t,a){return R.ULS.assertTag(595980828,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,r,n,t,a){return function(){return xo.impl(e,r,n,t,a)}}},ei=$a(bo,$o.parser,bo,io),ri=eo(Xo,uo(Zn.Paren,Ua.Union,ei),Ga(Yo,!1),Bo,function(e,r,n,t,a){var o=oo(e,r,a,"","");return on.parenNode(n,t,o)}),ni=Ya(ei,to(Ko,ei)),ti=Ya(ni,to(Ho,ni)),ai=eo(jo,uo(Zn.Brace,Ua.Union,ti),Ga(Jo,!1),Bo,function(e,r,n,t,a){var o=oo(e,r,a,"","");return on.arrayNode(n,t,o)}),oi=xa(function(e,r){if(r.kind===zn.Ident||r.kind===zn.CellRef&&r.isQualPart||r.kind===zn.Literal&&r.isQualPart||r.kind===zn.Operator&&r.value===cn.OperatorId.Dot)return r.chars}),ii=Ya(oi,oi),ui=xa(function(e,r){return r.kind===zn.Ident?r.chars:void 0});function ci(e){return e.kind===zn.Literal&&"object"==typeof e.oper&&e.oper.kind===tn.OperKind.Error&&e.oper.type===tn.ErrorType.REF}function li(e,r,n,t){return null==r?[on.identQualifier(e,n,t),n?"'"+e+"'":e]:[on.sheetRangeQualifier(e,r,n,t),n?"'"+e+":"+r+"'":e+":"+r]}var si=eo(Bo,ii,Ga(to(Zo,ii),void 0),Bo,function(e,r,n,t,a){var o=oo(e,r,a,"","");return li(n.join(""),null!=t?t.join(""):void 0,!1,o)}),fi=ro(qo,ui,Ga(to(Zo,ui),void 0),zo,Bo,function(e,r,n,t,a,o){return li(n,t,!0,oo(e,r,o,"",""))}),di=eo(qo,Xa(xa(function(e,r){return r.kind===zn.End||r.kind===zn.Right&&r.value===Zn.SQuote?void 0:r.chars})),Ga(Ja(zo,Ga(no(Qo,bo),!1)),[!1,!1]),Bo,function(e,r,n,t,a){var o=t[0],i=t[1],u="'"+n.join("")+(o?"'":"")+(i?"!":""),c=oo(e,r,a,"","");return[on.badNode(on.BadType.Qualifier,u,c),u]}),Ei=Ha(function(e,r,n){if(ci(r)){var t=oo(e,r.start,n.start,"","");return[on.errorQualifierLabeled(t),r.chars]}}),pi=Za(wa([si,fi,Wa(function(e,r){var n=oo(e,r.start,r.start,"","");return[on.relativeQualifierLabeled(n),""]})]),no(Qo,bo),function(e,r,n){return[r[0],r[1]+"!"]}),vi=wa([Ei,pi,di]);function hi(e,r){return r.kind===zn.CellRef&&e.refStyle===r.refStyle}var Ti=Ha(function(e,r,n){return hi(e,r)?[r,n.start]:void 0});function Ri(e,r){if(null!=e.row&&null!=e.col)return on.cellRefSingle(e.row,e.col,r);if(null!=e.row)return on.cellRefRow(e.row,e.row,r);if(null!=e.col)return on.cellRefCol(e.col,e.col,r);var n="calc.parse.cellRefToken2cellRef: bad token "+E(e);return R.ULS.assertTag(595980831,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var Si=Ha(function(e,r,n){if(hi(e,r)&&(r.refStyle!==on.RefStyle.A1||null!=r.row&&null!=r.col))return Ri(r,t=oo(e,r.start,n.start,"",""));if(ci(r)){var t=oo(e,r.start,n.start,"","");return on.cellRefErrorLabeled(t)}}),Ii=Ba(ba(qa(Ti,bo,Zo,bo,Ti),function(e,r){var n=r[0],t=n[0],a=n[1],o=r[1],i=(r[2],r[3]),u=r[4],c=u[0],l=u[1],s=oo(e,t.start,a,"",o),f=oo(e,c.start,l,i,""),d=Ri(t,s),E=Ri(c,f),p=void 0;if(d.kind===on.CellRefKind.Single&&E.kind===on.CellRefKind.Single){var v=oo(e,t.start,l,"","");p=on.cellRefRange(d,E,v)}else if(0===o.length&&0===i.length)if(d.kind===on.CellRefKind.Row&&E.kind===on.CellRefKind.Row){v=oo(e,t.start,l,"","");p=on.cellRefRow(d.row1,E.row1,v)}else if(d.kind===on.CellRefKind.Col&&E.kind===on.CellRefKind.Col){v=oo(e,t.start,l,"","");p=on.cellRefCol(d.col1,E.col1,v)}return null==p?Pa:t.isQualPart&&c.isQualPart?Wa(function(e,r){return r.kind===zn.Sep&&r.value===$n.Qual?void 0:p}):ka(p)}),Si),gi=xa(function(e,r){return r.kind===zn.Ident||r.kind===zn.CellRef&&r.isName?r.chars:void 0}),Ai=ba(qa(Bo,vi,Bo,Ga(Ba(Ii,gi),void 0),Bo),function(e,r){var n=r[0],t=r[1],a=t[0],o=t[1],i=r[2],u=r[3],c=r[4];if(null==u)return a.kind!==on.QualifierKind.SheetRange||a.isQuoted?a.kind===on.QualifierKind.Error?ka(on.literalNode(tn.refErrorOper,!0,a.label)):ka(a.kind===on.NodeKind.Bad?a:on.badNode(on.BadType.Qualifier,o,a.label)):Pa;if("string"==typeof u){if(a.kind===on.QualifierKind.SheetRange&&!a.isQuoted)return Pa;var l=oo(e,n,c,"","");if(a.kind===on.NodeKind.Bad||a.kind===on.QualifierKind.Error||a.kind===on.QualifierKind.SheetRange){var s=a.kind===on.NodeKind.Bad?a:on.badNode(on.BadType.Qualifier,o,a.label),f=on.nameNode(u,void 0,oo(e,i,c,"",""));return ka(on.badNode(on.BadType.Sequence,[s,f],l))}return ka(on.nameNode(u,a,l))}var d=oo(e,n,c,"","");if(a.kind===on.NodeKind.Bad||a.kind===on.QualifierKind.Document){var E=a.kind===on.NodeKind.Bad?a:on.badNode(on.BadType.Qualifier,o,a.label);f=on.cellRefNode(u,void 0,oo(e,i,c,"",""));return ka(on.badNode(on.BadType.Sequence,[E,f],d))}var p=a.kind===on.QualifierKind.Ident?on.sheetQualifier(a.name,void 0,a.isQuoted,a.label):a;return ka(on.cellRefNode(u,p,d))}),mi=$a(Bo,Ba(Ii,gi),Bo,function(e,r,n,t){var a=oo(e,r,t,"","");return"string"==typeof n?on.nameNode(n,void 0,a):n.kind===on.CellRefKind.Error?on.literalNode(tn.refErrorOper,!0,a):on.cellRefNode(n,void 0,a)}),Ni=Ha(function(e,r,n){if(r.kind===zn.Literal)return on.literalNode(r.oper,r.hasRight,oo(e,r.start,n.start,"",""));if(r.kind===zn.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var t=r.row.index+e.range.range.row+1;return on.literalNode(t,!0,oo(e,r.start,n.start,"",""))}});function Ci(e){return Ha(function(r,n,t){if(e(n)){var a=oo(r,n.start,t.start,"","");return on.badNode(on.BadType.Unexpected,n.chars,a)}})}var Oi=Ci(function(e){return e.kind===zn.Left&&e.value===Zn.Bracket}),Li=Ci(function(e){return e.kind===zn.Right&&e.value===Zn.Bracket}),Di=ro(Bo,Oi,uo(Zn.Bracket,Ua.Union,ei),Ga(Li,void 0),Bo,function(e,r,n,t,a,o){var i=[n,t];null!=a&&i.push(a);var u=oo(e,r,o,"","");return on.badNode(on.BadType.Sequence,i,u)}),Mi=Ha(function(e,r,n){switch(r.kind){case zn.End:case zn.Operator:case zn.Spaces:return;case zn.Sep:if(r.value!==$n.Qual&&(e.leftDelim===Zn.Brace||r.value!==$n.Col&&r.value!==$n.Row))return;break;case zn.Right:if(r.value===e.leftDelim)return}var t=r.kind===zn.CellRef?on.BadType.CellRef:on.BadType.Unexpected,a=oo(e,r.start,n.start,"","");return on.badNode(t,r.chars,a)}),_i=Ha(function(e,r,n){if((r.kind===zn.Ident||r.kind===zn.CellRef)&&n.kind===zn.Left&&n.value===Zn.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var t=oo(e,r.start,n.start,"","");return on.nameNode(r.chars,void 0,t)}}),yi=eo(Xo,uo(Zn.Paren,Ua.Arg,Ya(ei,to(Wo,ei))),Ga(Yo,!1),Bo,function(e,r,n,t,a){return[n,t,a]}),Fi=Za(_i,yi,function(e,r,n){var t=n[0],a=n[1],o=n[2],i=oo(e,ao(e,r).start,o,"","");return on.appNode(r,t,a,i)}),ki=Za(wa([Fi,Ai,mi,Ni,ri,ai,Di,Mi]),Xa(yi),function(e,r,n){var t=ao(e,r).start;return n.reduce(function(r,n){var a=n[0],o=n[1],i=n[2],u=oo(e,t,i,"","");return on.appNode(r,a,o,u)},r)}),Ui=Ha(function(e,r,n){var t=void 0;if(r.kind===zn.Operator&&(t=r.value),r.kind===zn.Sep&&r.value===$n.List&&e.listSep===Ua.Union&&(t=cn.OperatorId.Union),null!=t){var a=oo(e,r.start,n.start,"","");return on.operatorNode(t,a)}}),Pi=xa(function(e,r){return r.kind===zn.Spaces?r:void 0}),bi=Ba(ki,Ui),Bi=ba(bi,function(e,r){return Ka(Ja(Ga(Pi,void 0),bi),function(e,r,n){var t=r[0],a=r[1];return null!=t&&n.push(t),n.push(a),n},[r])}),wi=Za(Ga(Bi,void 0),Bo,function(e,r,n){if(null==r){var t=oo(e,n,n,"","");return on.literalNode(tn.missingOper,!0,t)}if(1===r.length){var a=r[0];if(a.kind!==on.NodeKind.Operator&&a.kind!==zn.Spaces)return a}return r.push(ft(n)),function(e,r){var n=e.length-1;if(n<0){var t="calc.parse.parseTerms: internal error: expected at least 1 term";return R.ULS.assertTag(595980865,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}if(e[0].kind===zn.Spaces)return t="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+E(e),R.ULS.assertTag(595980866,c.LogCategory.msoulscat_ES_EWAJS,!1,t);if(n-1>=0&&e[n-1].kind===zn.Spaces)return t="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+E(e),R.ULS.assertTag(595980867,c.LogCategory.msoulscat_ES_EWAJS,!1,t);if(e[n].kind!==zn.End)return t="calc.parse.parseTerms: internal error: array[n].kind !== End in "+E(e),R.ULS.assertTag(595980868,c.LogCategory.msoulscat_ES_EWAJS,!1,t);var a=Fa(Po,e,0,r);if(!1===a)return t="calc.parse.parseTerms: internal error: failed to parse "+E(e),R.ULS.assertTag(595980869,c.LogCategory.msoulscat_ES_EWAJS,!1,t);var o=a[0],i=a[1];if(i<n)return t="calc.parse.parseTerms: internal error: consumed "+i+" out of "+n+" in "+E(e),R.ULS.assertTag(595980870,c.LogCategory.msoulscat_ES_EWAJS,!1,t);return o}(r,e)});function Gi(e,r,n,t,a){var o=a.length-1;if(o<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return R.ULS.assertTag(595980832,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(a[o].kind!==zn.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+E(a);return R.ULS.assertTag(595980833,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,n,t){return{localeInfo:e,refStyle:r,range:n,source:t,leftDelim:void 0,listSep:Ua.Union,label:1,spans:{}}}(e.config.localeInfo,r,n,t),l=Fa(ei,a,0,u);if(!1===l){i="calc.parse.parseTokens: internal error: failed to parse "+E(a);return R.ULS.assertTag(595980834,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}var s=l[0],f=l[1];if(f<o){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+o+" in "+E(a);return R.ULS.assertTag(595980835,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return on.formula(s,u.spans)}$o.impl=wi;var Vi={"=":1,"+":0,"-":0,"@":-1};function xi(e){return{parseFormula:function(r,n,t,a){return function(e,r,n,t,a){var o=a[0],i=null!=o?Vi[o]:void 0;if(null==i)return sn.failure(Wn("first character is not '=', '+', '-' or '@'"));if(i<0)return sn.failure(Vn(["Lotus 1-2-3 syntax"]));if(r===on.RefStyle.A1&&null==n)return R.ULS.assertTag(595980825,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined");var u=Gi(e,r,n,t,ya(e,r,n,a,i));return sn.success(u)}(e,r,n,t,a)},formatFormula:function(e,r,n,t){return function(e,r,n,t,a){if(r===on.RefStyle.A1&&null==n)return R.ULS.assertTag(595980826,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.formatFormula: in A1 style, expected range to be defined");return sn.failure(Vn(["formatFormula"]))}(0,e,r)}}}var Wi=on.QualifierKind,Hi=on.CellRefKind,Ki=on.NodeKind,Qi=sn.ResultKind;function Xi(e){return e.kind===Qi.Success}function Yi(e,r){var n=e[r];return null==n?g("ParseResultHelper.getFormulaSpan: expected span for label "+r+" to be defined"):n}function ji(e,r,n){return!!Xi(e)&&(function(e,r,n){if(null==e||null==n)return;var t={};null!=r?r.forEach(function(e){t[e]=!0}):t["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var o=a.pop();if(null!=o)switch(o.kind){case Ki.Literal:c("literal")&&n("literal",{label:o.label,value:o});break;case Ki.Array:o.nodes.map(function(e){return e.map(function(e){a.push(e)})});break;case Ki.App:if("object"!=typeof o.head)c("literal")&&n("literal",{label:o.label,value:o.head});else{var i=o.head;switch(i.kind){case Ki.Operator:c("operator")&&n("operator",{label:o.label,value:i.id});break;case Ki.Name:c("function")&&n("function",{label:o.label,name:i.whole});break;default:a.push(i)}}o.args.map(function(e){a.push(e)});break;case Ki.Paren:a.push(o.node);break;case Ki.Name:if(c("namedRange")){var u=o.whole.split(".");n("namedRange",{label:o.label,name:u[0],names:u.slice(1),qualifier:l(o)})}break;case Ki.CellRef:c("range")&&s(o);break;case Ki.Bad:break;default:return I("calc.parse.traverseFormula",o)}}function c(e){return t[e]||t["*"]}function l(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case Wi.Sheet:var n=e.qualifier;r.type=Wi.Sheet,r.sheet=n.sheet,null!=n.document&&(r.document=n.document.document,null!=n.document.path&&(r.documentPath=n.document.path));break;case Wi.SheetRange:var t=e.qualifier;r.type=Wi.SheetRange,r.sheet1=t.sheet1,r.sheet2=t.sheet2;break;case Wi.Ident:var a=e.qualifier;r.type=Wi.Ident,r.name=a.name;break;case Wi.Document:var o=e.qualifier;r.document=o.document,null!=o.path&&(r.documentPath=o.path)}return r}}function s(r){if(null!=e&&null!=n)switch(r.ref.kind){case Hi.Error:break;case Hi.Col:var t=r.ref;n("range",{label:r.label,type:"col",startIndex:t.col1,endIndex:t.col2,span:Yi(e.spans,t.label),qualifier:l(r)});break;case Hi.Row:var a=r.ref;n("range",{label:r.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:Yi(e.spans,a.label),qualifier:l(r)});break;case Hi.Single:var o=r.ref;n("range",{label:r.label,type:"cell",row:o.row,col:o.col,span:Yi(e.spans,o.label),qualifier:l(r)});break;case Hi.Range:var i=r.ref;n("range",{label:r.label,type:"range",top:i.ref1.row,left:i.ref1.col,bottom:i.ref2.row,right:i.ref2.col,topLeftSpan:Yi(e.spans,i.ref1.label),bottomRightSpan:Yi(e.spans,i.ref2.label),qualifier:l(r)})}}}(e.value,r,n),!0)}var Ji,qi={isSuccess:Xi,traverse:ji,extractReferences:function(e){if(Xi(e)){var r=[];return ji(e,["range","namedRange"],function(n,t){var a={kind:n,ref:t,span:Yi(e.value.spans,t.label)};r.push(a)}),r.sort(function(e,r){return e.span.start-r.span.start}),r}}};!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Ji||(Ji={}));var zi={Unclosed_expression:{code:1,category:Ji.SyntaxError},Illegal_array_literal_element:{code:2,category:Ji.SyntaxError},Empty_array_literal:{code:3,category:Ji.SyntaxError},Irregular_array_shape:{code:4,category:Ji.SyntaxError},Empty_parenthesis:{code:5,category:Ji.SyntaxError},Missing_operation_argument:{code:6,category:Ji.SyntaxError},Bad_node:{code:7,category:Ji.SyntaxError},Invalid_binder:{code:8,category:Ji.SyntaxError},Empty_formula:{code:9,category:Ji.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Ji.SyntaxError},Types_not_related:{code:1001,category:Ji.TypeError},Unexpected_application_head:{code:1002,category:Ji.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Ji.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Ji.TypeError},Excess_function_arguments:{code:1005,category:Ji.TypeError},Insufficient_function_arguments:{code:1006,category:Ji.TypeError}},Zi=on.NodeKind,$i=on.QualifierKind,eu=on.BadType,ru=on.CellRefKind,nu=rn.FormulaSource,tu=tn.OperKind,au=tn.ErrorType,ou=cn.SignatureType,iu=cn.SpecialPrecs,uu=cn.getOperatorType,cu=cn.WorksheetFuncId,lu=cn.getWorksheetFuncType,su=sn.operKind,fu=sn.getArguments,du=sn.getArgType,Eu=sn.defaultLiteralVisitor,pu=sn.defaultFormulaVisitor,vu=sn.dispatch,hu=sn.startVisit,Tu={};function Ru(e,r){return{context:e,result:r}}function Su(e){return function(r){return r.kind===Zi.Literal&&e(r.oper)}}var Iu=Su(function(e){return su(e)===tu.Missing}),gu=Su(function(e){return su(e)===tu.Error&&e.type===au.REF}),Au=Su(function(e){return 0!=(su(e)&(tu.String|tu.Error|tu.Boolean))});function mu(e){return e.kind===Zi.Name&&void 0===e.qualifier}function Nu(e,r,n,t){void 0===t&&(t=!1),t||(e.errorData=e.reportError(r,n,e.errorData))}function Cu(e,r){return r!==tu.Range||0!=(e&tu.Range)}function Ou(e,r){if(r.kind===Zi.Literal)switch(Nu(e,r,zi.Unclosed_expression,r.isClosed),su(r.oper)){case tu.Number:case tu.Boolean:case tu.String:case tu.Error:return;default:return void Nu(e,r,zi.Illegal_array_literal_element)}Nu(e,r,zi.Illegal_array_literal_element)}function Lu(e,r,n){Nu(e,r,zi.Types_not_related,Cu(tu.Array,n)),Nu(e,r,zi.Unclosed_expression,r.isClosed);var t=r.nodes.length>0;if(Nu(e,r,zi.Empty_array_literal,t),!t)return Ru(e,n);for(var a=r.nodes[0].length,o=0;o<r.nodes.length;o+=1){var i=r.nodes[o],u=i.length;Nu(e,r,zi.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)Ou(e,i[c])}return Ru(e,n)}function Du(e,r,n){if(e.earlyExit&&!e.isOk())throw Tu;switch(r.kind){case Zi.Array:return Lu(e,r,n);case Zi.Paren:return Nu(e,r,zi.Unclosed_expression,r.isClosed),Nu(e,r,zi.Empty_parenthesis,!Iu(r.node)),Du(e,r.node,n);case Zi.Bad:case Zi.Name:case Zi.CellRef:case Zi.App:case Zi.Literal:var t=yu(e,r);return Nu(e,r,zi.Types_not_related,Cu(t.result,n)),t.result=n,t;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function Mu(e,r,n){var t,a=lu(r),o=n.args,i=o.length,u=fu(n),c=u.length,l=e.isOk();c<a.minArgs&&Nu(e,void 0===(t=o[i-1])?n:t,zi.Insufficient_function_arguments);0===a.restTypes.length&&c>a.headTypes.length&&Nu(e,void 0===(t=o[i-1])?n:t,zi.Excess_function_arguments);a.restTypes.length>1&&r!==cu.SWITCH&&((c-a.headTypes.length)%a.restTypes.length!=0&&Nu(e,void 0===(t=o[i-1])?n:t,zi.Insufficient_function_arguments));for(var s=0;s<c;s+=1)Du(e,u[s],du(a,s));var f=!l||e.isOk();return f&&(e.specialDependencies|=a.staticPrecs,function(e,r,n){switch(r){case cu.LET:var t=n[0];return void 0!==t?Nu(e,t,zi.Invalid_binder,mu(t)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",t);case cu.FUN:for(var a=0;a<n.length-1;a+=1){var o=n[a];Nu(e,o,zi.Invalid_binder,mu(o))}}}(e,r,o)),Ru(e,f?a.returnType:ou.All)}function _u(e,r){Nu(e,r,zi.Unclosed_expression,r.isClosed);var n=r.args;if(r.head.kind===Zi.Operator)return function(e,r,n){var t=uu(r.id),a=n.length,o=a===t.minArgs;Nu(e,r,zi.Incorrect_number_of_operator_arguments,o);for(var i=0;i<a;i+=1){var u=n[i];Iu(u)&&(o=!1,Nu(e,u,zi.Missing_operation_argument)),Du(e,u,du(t,i))}return o?(e.specialDependencies|=t.staticPrecs,Ru(e,t.returnType)):Ru(e,ou.All)}(e,r.head,n);if(mu(r.head)){var t=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==t)return Mu(e,t,r)}for(var a=0;a<n.length;a+=1)Du(e,n[a],ou.All);var o=r.head,i=yu(e,o);return Cu(i.result,tu.Range)||i.result===tu.Error&&function(e){for(var r=e;r.kind===Zi.Paren;)r=r.node;return gu(r)}(o)?Ru(e,ou.All):(Nu(e,o,Au(o)||o.kind===Zi.Array?zi.Unexpected_application_head:zi.Unexpected_application_head_with_fix),Ru(e,ou.All))}function yu(e,r){if(e.earlyExit&&!e.isOk())throw Tu;switch(r.kind){case Zi.App:return _u(e,r);case Zi.Array:return Lu(e,r,tu.Array);case Zi.Bad:return Nu(e,r,zi.Bad_node),Ru(e,ou.All);case Zi.CellRef:return e.source!==nu.Cell&&e.source!==nu.Range||void 0===r.qualifier||r.qualifier.kind!==$i.Relative?Ru(e,tu.Range):(Nu(e,r,zi.Invalid_rel_sheet_qualifier_in_cell),Ru(e,ou.All));case Zi.Literal:return Nu(e,r,zi.Unclosed_expression,r.isClosed),Ru(e,su(r.oper));case Zi.Name:return Ru(e,ou.All);case Zi.Paren:return Nu(e,r,zi.Unclosed_expression,r.isClosed),Nu(e,r,zi.Empty_parenthesis,!Iu(r.node)),yu(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var Fu={ok:!0,isOk:Br,collect:function(e,r,n){return!1}};function ku(e,r,n,t,a){void 0===a&&(a=!0);var o={globals:e,location:r,source:n,reportError:t.collect,isOk:function(){return t.isOk(o.errorData)},earlyExit:a,specialDependencies:iu.None,errorData:t.ok};return o}function Uu(e,r){try{return Nu(e,r.node,zi.Empty_formula,!Iu(r.node)),Du(e,r.node,ou.All)}catch(r){return r!==Tu&&R.ULS.traceTag(595952020,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+E(r)),Ru(e,ou.All)}}function Pu(e,r){if(r.kind!==Zi.Bad||r.type!==eu.Sequence||3!==r.contents.length)return!1;var n=r.contents[0],t=r.contents[2];return n.kind===Zi.Bad&&n.type===eu.Unexpected&&n.contents===e.leftBracket&&(t.kind===Zi.Bad&&t.type===eu.Unexpected&&t.contents===e.rightBracket)}function bu(e,r){if(2===r.length){var n,t=r[0],a=r[1];return Pu(e,t)?(n=a).kind===Zi.Name&&null!=n.qualifier&&n.qualifier.kind===$i.Ident?Zi.Name:function(e){return e.kind===Zi.CellRef&&null!=e.qualifier&&e.qualifier.kind===$i.Sheet&&null==e.qualifier.document}(a)?Zi.CellRef:void 0:function(e,r){return r.kind===Zi.Bad&&r.type===eu.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,t)?mu(a)?Zi.Name:function(e){return e.kind===Zi.CellRef&&null==e.qualifier}(a)?Zi.CellRef:void 0:void 0}}function Bu(e){if(e.kind===Zi.Literal&&e.isClosed)switch(su(e.oper)){case tu.Number:case tu.Boolean:case tu.String:case tu.Error:return!0;default:return!1}return!1}function wu(e,r){var n=r.head,t=n.kind!==Zi.Operator;if(!r.isClosed||r.args.some(function(r){return!Gu(e,r,t)}))return!1;if(n.kind===Zi.Operator)return(o=uu(n.id)).minArgs===r.args.length;if(!Gu(e,n,!1))return!1;if(mu(n)){var a=e.config.localeInfo.getWorksheetFuncId(n.whole.toLocaleUpperCase());if(void 0!==a){var o=lu(a),i=fu(r).length;if(i<o.minArgs)return!1;if(0===o.restTypes.length&&i>o.headTypes.length)return!1;if(o.restTypes.length>1&&a!==cu.SWITCH)if((i-o.headTypes.length)%o.restTypes.length!=0)return!1;return function(e,r){switch(e){case cu.LET:return mu(r[0]);case cu.FUN:return r.slice(0,r.length-1).every(mu);default:return!0}}(a,r.args)}}return!0}function Gu(e,r,n){switch(r.kind){case Zi.Literal:return r.isClosed&&(!!n||su(r.oper)!==tu.Missing);case Zi.Name:case Zi.CellRef:return!0;case Zi.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every(function(e){return n=e,t=r.nodes[0].length,n.length===t&&n.every(Bu);var n,t});case Zi.App:return wu(e,r);case Zi.Paren:return r.isClosed&&Gu(e,r.node,!1);case Zi.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function Vu(e,r,n){switch(r.kind){case Zi.Literal:case Zi.Name:break;case Zi.CellRef:r.ref.kind===ru.Row&&(n.rowRef+=1),r.ref.kind===ru.Col&&(n.colRef+=1);break;case Zi.Array:r.nodes.forEach(function(r){return r.forEach(function(r){return Vu(e,r,n)})});break;case Zi.App:r.head.kind!==Zi.Operator&&Vu(e,r.head,n),r.args.forEach(function(r){return Vu(e,r,n)});break;case Zi.Paren:Vu(e,r.node,n);break;case Zi.Bad:if(r.type===eu.Sequence){var t=r.contents;if(function(e,r){return 2===r.length&&mu(r[0])&&Pu(e,r[1])}(e,t))n.structRef+=1;else{var a=bu(e,t);null!=a?(a===Zi.Name?n.docQualName+=1:a===Zi.CellRef&&(n.docQualCellRef+=1),Vu(e,t[1],n)):t.forEach(function(r){return Vu(e,r,n)})}}else r.type===eu.Qualifier&&(n.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var xu=pu(Eu(function(e){return 1}),function(e){return 1},{vArray:function(e){var r=-1;return e.nodes.forEach(function(e){e.forEach(function(e){var n=vu(e,xu);r=Math.max(r,n)})}),1+r},vRange:function(e){var r=vu(e.ref1,xu),n=vu(e.ref2,xu);return 1+Math.max(r,n)},vBad:function(e){if(e.type===eu.Sequence){var r=-1;return e.contents.forEach(function(e){var n=vu(e,xu);r=Math.max(r,n)}),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var n=vu(e.qualifier,xu);r=Math.max(r,n)}return 1+Math.max(r,vu(e.ref,xu))},vParen:function(e){return 1+vu(e.node,xu)},vApp:function(e){var r=-1;return e.args.forEach(function(e){var n=vu(e,xu);r=Math.max(r,n)}),1+r}});var Wu=[];function Hu(e,r,n,t,a){var o,i={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(Vu(e.config.localeInfo,t.node,i),i.rowRef+i.colRef+i.structRef+i.docQualName+i.docQualCellRef+i.badQual>0&&R.ULS.traceTag(595961670,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+a+"; anonymize: "+E(t.node)+"; stats = "+JSON.stringify(i)),Pr(yr.CalcStrictFormulaChecking))if(Wu.length<10){var u=(o=t.node,hu(o,xu,-1));Wu.push(u)}else R.ULS.traceTag(595957962,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+Wu.join("; ")),Wu=[];var l=Pr(yr.CalcStrictFormulaChecking)?function(e,r,n,t){return Uu(ku(e,r,n,Fu),t).context.errorData}(e,r,n,t):Gu(e,t.node,!1);return l||function(e){e.kind!==Zi.App||e.isClosed||R.ULS.traceTag(595949718,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(t.node),Bn({},t,{isWellFormed:l})}var Ku,Qu,Xu=tn.SpecialPrecs,Yu=tn.precedents;function ju(e){return{findStaticPrecedents:function(e){return Yu([],[],Xu.All,!1)},checkFormula:function(r,n,t,a){return Hu(e,r,n,t,void 0!==a?a:"undefined")},checkFormulaWithCodes:function(r,n,t){return function(e,r,n,t){return Uu(ku(e,r,n,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,n){return n.push({label:e.label,errorCode:r.code}),n}},!1),t).context.errorData}(e,r,n,t)},findBestFormat:function(e,r,n){n.node}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(Ku||(Ku={})),function(e){e.RangeValues="RangeValues"}(Qu||(Qu={}));var Ju=tn.div0ErrorOper,qu=tn.numErrorOper,zu=Math.pow(2,-52),Zu=Math.pow(2,-1022);function $u(e){return Math.abs(e)<Zu?0:e}function ec(e){return isFinite(e)?$u(e):qu}var rc=Math.pow(2,32)-2;function nc(e,r){var n=Math.pow(e,r);return isFinite(n)?$u(n):r<0?Ju:qu}var tc,ac,oc,ic={sqrt:function(e){return ec(Math.sqrt(e))},sqrtpi:function(e){return ec(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return ec(Math.exp(e))},power:function(e,r){return 0===r?0===e?qu:1:0===e?r<0?Ju:0:e>0?nc(e,r):function(e){if(e<-rc||e>rc)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*zu<=r&&r<=1+2*zu}(r)?nc(e,Math.round(r)):qu},ln:function(e){return ec(Math.log(e))},log10:function(e){return ec(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return qu;var n=Math.log(e)/Math.log(r);return isFinite(n)?$u(n):Ju},sin:function(e){return Math.abs(e)<Math.pow(2,27)?ec(Math.sin(e)):qu},cos:function(e){return Math.abs(e)<Math.pow(2,27)?ec(Math.cos(e)):qu},tan:function(e){return Math.abs(e)<Math.pow(2,27)?ec(Math.tan(e)):qu},asin:function(e){return ec(Math.asin(e))},acos:function(e){return ec(Math.acos(e))},atan:function(e){return ec(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Ju:$u(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(oc||(oc={}));var uc=(tc=br(Br,Br)).wrap,cc=tc.unwrap,lc=(ac=br(function(e){return-e},function(e){return-e})).wrap,sc=ac.unwrap;function fc(e){return e>0}function dc(e){return{kind:e,data:void 0,children:void 0}}function Ec(e,r,n){var t=dc(oc.Array);return t.children=n,t.data={rows:e,cols:r},t}function pc(e,r){var n=dc(oc.Fun);return n.children=r,n.data=e,n}function vc(e,r,n){var t=dc(oc.Let);return t.children=[r,n],t.data=e,t}function hc(e,r,n){var t=dc(oc.App);return t.children=n,t.data={funName:e,funType:r},t}function Tc(e){var r=dc(oc.Ident);return r.data=e,r}function Rc(e,r,n){var t=dc(oc.If);return t.children=[e,r,n],t}function Sc(e){return"object"!=typeof e||e.kind>0}function Ic(e,r){for(var n,t=0;t<e.length;t+=1){var a=e[t],o=r(a);void 0===n?o!==a&&(n=e.slice(0,t)).push(o):n.push(o)}return void 0!==n?n:e}function gc(e,r){return Ic(e,function(e){return function(r){return Ic(r,e)}}(r))}function Ac(e,r){return r(function(e,r){if(Sc(e))return e;switch(e.kind){case oc.Let:var n=e.children,t=n[0],a=n[1],o=r(t),i=r(a);return t===o&&a===i?e:vc(e.data,o,i);case oc.App:var u=Ic(e.children,r);return u===e.children?e:hc(e.data.funName,e.data.funType,u);case oc.If:var c=e.children,l=c[0],s=c[1],f=c[2],d=r(l),E=r(s),p=r(f);return l===d&&s===E&&f===p?e:Rc(d,E,p);case oc.Fun:var v=r(e.children);return v===e.children?e:pc(e.data,v);case oc.Array:var h=gc(e.children,r);return h===e.children?e:Ec(e.data.rows,e.data.cols,h);case oc.Name:case oc.CellRef:case oc.Ident:return e}}(e,function(e){return Ac(e,r)}))}var mc=function(){function e(e,r,n){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var t=n.length;t<e&&g("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+t);for(var a=0;a<t;a+=1){var o=n[a].length;o<r&&g("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+o)}this.rows=e,this.cols=r,this.elements=n}return e.prototype.get=function(e,r){return N("calc.common.StrictArray2D.get",e,this.rows),N("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new Nc(this.rows,this.cols,function(n,t){return e(r.elements[n][t])})},e}();var Nc=function(){function e(e,r,n){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=n}return e.prototype.get=function(e,r){return N("calc.common.NonstrictArray2D.get",e,this.rows),N("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=Cc(this.rows,this.cols,this.func);return new mc(this.rows,this.cols,e)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,function(e,t){return r(n.func(e,t))})},e}();function Cc(e,r,n){for(var t=[],a=0;a<e;a+=1){for(var o=[],i=0;i<r;i+=1)o[i]=n(a,i);t[a]=o}return t}function Oc(e){return Cc(e.rows,e.cols,e.get.bind(e))}function Lc(e,r,n){for(var t=[],a=[],o=0;o<r;o+=1)a[o]=n;for(var i=0;i<e;i+=1)t[i]=a;return t}function Dc(e,r,n){return new Nc(e,r,function(e,r){return n})}var Mc,_c=rn.FormulaSource,yc=sn.ResultKind,Fc=sn.isGridCell,kc=sn.ReasonKind,Uc=sn.notImplemented,Pc=sn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(Mc||(Mc={}));var bc,Bc,wc=Bn({},kc,Mc);function Gc(e){return{kind:wc.IllFormedFormula,message:e}}function Vc(e){return{kind:bc.FinalValue,oper:e}}function xc(e){return{kind:bc.PendingValue,anchor:e}}function Wc(e,r,n){return r!==_c.Cell||Fc(e.range)||g("calc.runtime.cellFormula: expected single-cell range; given "+E(e)),{kind:bc.Formula,range:e,source:r,formula:n}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(bc||(bc={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Bc||(Bc={}));var Hc={kind:wc.Stopped};function Kc(e){return 0===e.length&&g("calc.runtime.unevaluated: expected nonempty array"),{kind:wc.Unevaluated,anchors:e}}function Qc(e,r,n,t,a,o,i,u,c,l,s,f,d,E,p,v){return void 0===v&&(v=function(e){return Tr(Uc(["getUsedRange"]))}),{config:e,mathpack:r,getDocumentLoc:function(e,r){return gr(n(e,r))},getSheetIndex:t,getCellValue:a,getCellValues:o,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[Bc.Continue],schedulerInfo:null!=p?p:{},setCellValue:l,setCellValues:s,setCellFailure:f,setDynamicPrecs:d,loadObjects:E,getUsedRange:v}}function Xc(e){return{kind:wc.NameCycle,names:e}}function Yc(e){return{kind:wc.CellCycle,cells:e}}function jc(e){return{kind:wc.PreviousFailure,range:e}}function Jc(e){return{kind:wc.JavaScriptError,error:e}}function qc(e){return{kind:yc.Paused,reason:wc.Timeout,resume:e}}function zc(e){if(e.kind===yc.Failure)return e.reason.kind}var Zc=rn.gridCell,$c=rn.gridRange,el=tn.arrayOper,rl=tn.naErrorOper,nl=tn.OperKind,tl=nl.Number|nl.String|nl.Boolean|nl.Error|nl.Rich|nl.Array,al=nl.Number|nl.String|nl.Boolean|nl.Error|nl.Blank|nl.Rich,ol=al|nl.Array;function il(e,r,n){var t=e+": generated Excel error, type "+r+"; "+n;R.ULS.traceTag(596120270,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,t)}function ul(e){return"object"==typeof e&&e.kind===nl.Error}function cl(e){return"object"==typeof e&&e.kind===nl.Blank}function ll(e){return"object"==typeof e&&e.kind===nl.Array}function sl(e){return e.kind===We.Success?e.value:void 0}function fl(e,r){switch(e.kind){case We.Success:return hr(Vc(e.value));case We.Failure:return Tr(jc(r))}}function dl(e,r,n){var t=ll(n)?function(e,r,n,t,a,o){if(e===n&&r===t)return a;if(1===e&&1===r)return Lc(n,t,void 0===a[0]?o:a[0][0]);var i,u=[];i=1===e?function(e,n){return n<r?a[0][n]:o}:1===r?function(r,n){return r<e?a[r][0]:o}:function(n,t){return n<e&&t<r?a[n][t]:o};for(var c=0;c<n;c+=1){u.push([]);for(var l=0;l<t;l+=1)u[c][l]=i(c,l)}return u}(n.rows,n.cols,e,r,n.opers,rl):Lc(e,r,n);return el(e,r,t)}function El(e,r){var n=e.row,t=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.min(n,i),f=Math.min(t,u),d=Math.max(n+a,i+c)-s,E=Math.max(t+o,u+l)-f;return $c(s,f,d,E)}function pl(e){return 0===e.length&&g("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(El)}function vl(e,r){var n=e.row,t=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.max(n,i),f=Math.max(t,u),d=Math.min(n+a,i+c)-s,E=Math.min(t+o,u+l)-f;if(!(d<=0||E<=0))return $c(s,f,d,E)}function hl(e){return e.rows*e.cols}var Tl,Rl=on.NodeKind,Sl=sn.getArguments,Il=tn.arrayOper,gl=cn.WorksheetFuncId,Al=sn.success,ml=(Tl=0,function(){var e=Tl;return Tl+=1,e});function Nl(e){return"object"!=typeof e||Sc(e)&&("object"!=typeof(r=e)||r.kind===nl.Error||r.kind===nl.Array||r.kind===nl.Rich);var r}function Cl(e,r,n){var t=Sl(n).map(function(n){return Ol(e,r,n)}),a=cn.getWorksheetFuncType(gl._UDF);return hc(lc(gl._UDF),a,[Ol(e,r,n.head)].concat(t))}function Ol(e,r,n){switch(n.kind){case Rl.Array:var t=n.nodes.map(function(n){return n.map(function(n){return Ol(e,r,n)})});return T=(h=t).length,S=void 0===h[0]?0:h[0].length,h.every(function(e){return e.every(Nl)})?Il(T,S,h):Ec(T,S,h);case Rl.App:var a=n.head;if(a.kind===Rl.Operator){var o=Sl(n).map(function(n){return Ol(e,r,n)}),i=cn.getOperatorType(a.id);return hc(uc(a.id),i,o)}if(a.kind===Rl.Name&&null==a.qualifier)if(null!=(l=e.config.localeInfo.getWorksheetFuncId(a.whole.toLocaleUpperCase()))){var u=void 0;switch(l){case gl.LET:u=function(e,r,n){if(3===n.args.length){var t=n.args[0];if(t.kind===Rl.Name&&null==t.qualifier){var a=t.whole,o=ml(),i=Gr(r);return i[a]=o,vc(o,Ol(e,r,n.args[1]),Ol(e,i,n.args[2]))}}}(e,r,n);break;case gl.FUN:u=function(e,r,n){var t=n.args.slice(0,n.args.length-1);if(t.length>0&&t.every(function(e){return e.kind===Rl.Name&&null==e.qualifier})){for(var a=t.map(function(e){return e.whole}),o=a.map(ml),i=Gr(r),u=0;u<a.length;u+=1)i[a[u]]=o[u];return pc(o,Ol(e,i,n.args[t.length-1]))}}(e,r,n);break;case gl.IF:u=function(e,r,n){var t=n.args;return 3===t.length?Rc(Ol(e,r,t[0]),Ol(e,r,t[1]),Ol(e,r,t[2])):2===t.length?Rc(Ol(e,r,t[0]),Ol(e,r,t[1]),!1):void 0}(e,r,n);break;default:o=Sl(n).map(function(n){return Ol(e,r,n)}),i=cn.getWorksheetFuncType(l);u=hc(lc(l),i,o)}return void 0===u?Cl(e,r,n):u}return Cl(e,r,n);case Rl.Paren:return Ol(e,r,n.node);case Rl.Name:var l;if(null==n.qualifier)if(void 0!==(l=r[n.whole]))return Tc(l);return f=n.whole,d=n.whole.split("."),p=n.qualifier,(v=dc(oc.Name)).data={whole:f.toLocaleUpperCase(),split:d.map(function(e){return e.toLocaleUpperCase()}),qualifier:p},v;case Rl.CellRef:return function(e,r){var n=dc(oc.CellRef);return n.data={ref:e,qualifier:r},n}(n.ref,n.qualifier);case Rl.Literal:return n.oper;case Rl.Bad:var s="calc.runtime.compile: unexpected bad node "+E(n);return R.ULS.assertTag(595980820,c.LogCategory.msoulscat_ES_EWAJS,!1,s);default:return I("calc.runtime.compile",n)}var f,d,p,v,h,T,S}var Ll=function(e){if(!Sc(e)&&e.kind===oc.App&&!fc(e.data.funName)){var r=sc(e.data.funName);if(r===gl.IFERROR||r===gl.IFNA){var n=ml(),t=Tc(n),a=r===gl.IFERROR?gl.ISERROR:gl.ISNA,o=cn.getWorksheetFuncType(a),i=Rc(hc(lc(a),o,[t]),e.children[1],t);return vc(n,e.children[0],i)}}return e};var Dl,Ml=function(){return function(e){this.term=e}}();function _l(e,r){return r instanceof Ml?r.term:g(e+": expected known compiled formula type; given "+E(r))}function yl(e,r,n,t){var a=Ol(e,wr(),t.node),o=Ac(a,Ll);return Al(new Ml(o))}function Fl(e){return{compileFormula:function(r,n,t){return yl(e,0,0,t)}}}function kl(e,r){return 0==(e&r)}function Ul(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(Dl||(Dl={}));var Pl={kind:Dl.Empty};function bl(e){return e===Pl}function Bl(e,r){return{kind:Dl.Lf,key:e,value:r}}function wl(e,r,n,t){return{kind:Dl.Br,prefix:e,mask:r,l:n,r:t}}function Gl(e,r,n,t){var a=function(e,r){return n=e^r,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)^n>>>1;var n}(e,n),o=Ul(e,a),i=kl(e,a);return wl(o,a,i?r:t,i?t:r)}var Vl,xl=Pl,Wl=function e(r,n,t){switch(t.kind){case Dl.Empty:return Bl(r,n);case Dl.Lf:var a=Bl(r,n);return t.key===r?a:Gl(r,a,t.key,t);case Dl.Br:return function(e,r,n){return Ul(e,n)===r}(r,t.prefix,t.mask)?kl(r,t.mask)?wl(t.prefix,t.mask,e(r,n,t.l),t.r):wl(t.prefix,t.mask,t.l,e(r,n,t.r)):Gl(r,Bl(r,n),t.prefix,t)}},Hl=function(e,r){for(var n=r;n.kind===Dl.Br;)n=kl(e,n.mask)?n.l:n.r;if(!bl(n))return e===n.key?n.value:void 0},Kl=rn.FormulaSource,Ql=sn.isSheetGridCell,Xl=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Yl(e){throw new Xl(e)}function jl(e,r,n,t){return{range:e,source:r,precedents:n,visitedCellMap:t}}function Jl(e,r,n,t){if(r===Kl.Cell){if(Ql(e))return jl(e,r,n,t);g("calc.runtime.evalLocals: expected single-cell range; given "+E(e))}return jl(e,r,n,t)}Xl.prototype=Object.create(Error.prototype),Xl.prototype.constructor=Xl,function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(Vl||(Vl={}));var ql={kind:Vl.Default},zl=function(){function e(e){this.context=e,this.latestTransition=Vl.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=Vl.Default,ql},e.prototype.performDependencyTransition=function(e){return this.latestTransition=Vl.Dependency,{kind:Vl.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=Vl.Call,{kind:Vl.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=Vl.Write,{kind:Vl.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=Vl.Return,{kind:Vl.Return,result:e}},e}(),Zl={newVisitedMap:es,visit:function(e,r,n){return rs(is,e,r,n)},unVisit:function(e,r,n){return ns(is,e,r,n)},lookup:function(e,r){return ts(is,e,r)},runFrom:function(e,r){return as(is,e,r)}},$l={newVisitedMap:es,visit:function(e,r,n){return rs(us,e,r,n)},unVisit:function(e,r,n){return ns(us,e,r,n)},lookup:function(e,r){return ts(us,e,r)},runFrom:function(e,r){return as(us,e,r)}};function es(){return{run:[],visited:wr()}}function rs(e,r,n,t){var a=e(r);t.visited[a]=n,t.run.push([a,r])}function ns(e,r,n,t){var a=e(r);t.visited[a]=n,t.run.pop()}function ts(e,r,n){return n.visited[e(r)]}function as(e,r,n){for(var t=[],a=n.run,o=0;o<a.length;){var i=a[o][0];if(e(r)===i)break;o+=1}for(;o<a.length;)t.push(a[o][1]),o+=1;return t}function os(e){var r=e.document,n=e.index,t="$";return null!=r.path&&(t+=r.path),t+=";",t+=r.name,t+=";",null!=n&&(t+=n,t+=";"),t}function is(e){var r=os(e.scope);return r+=";",r+=e.name}function us(e){var r=os(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var cs=tn.SpecialPrecs,ls=tn.precedents,ss=tn.OperKind,fs=sn.failure,ds=sn.sheetGridRangeAnchor,Es=sn.success,ps=sn.ResultKind,vs=function(e){function r(r,n){var t=e.call(this,r)||this;return t.cell=n,t.locals=void 0,t}return bn(r,e),r.prototype.getRealReason=function(e){if(e.kind!==wc.PreviousFailure)return e;var r=ds(e.range),n=$l.lookup(r,this.context.visitedCellMap);return"object"==typeof n&&n.kind===ps.Failure?n.reason:e},r.prototype.visitAnchor=function(e){var r=ds(e.range),n=$l.lookup(r,this.context.visitedCellMap);if(null!=n){var t="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+E(r)+"; given "+E(n));return R.ULS.assertTag(595980812,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}$l.visit(r,bc.PendingValue,this.context.visitedCellMap);var a=ls([],[],cs.None,!0);return this.locals=Jl(e.range,e.source,a,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var n=ds(r.range);return $l.unVisit(n,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===ps.Failure)return this.performReturnTransition(fs(this.getRealReason(e.reason)));var r=e.value;if(r.kind===bc.FinalValue)return this.performReturnTransition(Es(r.oper));var n=this.context.globals.getCellFormula(r.anchor);if(n.kind===ps.Failure){var t="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return R.ULS.assertTag(595980813,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}var a=n.value;if(null==a){t="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+E(r.anchor)+") != null");return R.ULS.assertTag(595980814,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}var o=this.visitAnchor(a),i=this.context.createFormulaEvaluationMachine(this.context,o,a.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===ss.Range||r.kind===ss.Missing)){var n="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+E(r));return R.ULS.assertTag(595980815,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=this.unVisitAnchor(void 0);if(null==t){n="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return R.ULS.assertTag(595980816,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(e,t)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===wc.Unevaluated){var n="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+E(r));return R.ULS.assertTag(595980817,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=r===e.reason?e:fs(r),a=this.unVisitAnchor(t);if(null==a){n="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return R.ULS.assertTag(595980818,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(t,a)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(zl);function hs(e,r){return new vs(e,r)}function Ts(e,r){if(0===r.length)return[];for(var n=xf(e),t=[],a=0;a<r.length;a+=1)t.push(hs(n.machineContext,r[a]));return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t:qc(function(t){return e(r,"number"==typeof t?t:n)})}(new Hf(n,t),Gf(wf(e.schedulerInfo)))}var Rs=rn.FormulaSource,Ss=rn.sheetGridCell,Is=rn.sheetGridRange,gs=tn.OperKind,As=tn.ErrorType,ms=tn.refErrorOper,Ns=tn.valueErrorOper,Cs=tn.arrayOper,Os=sn.ResultKind,Ls=sn.isGridCell,Ds=sn.isSheetIndex,Ms=sn.getArgType;function _s(e,r){if($l.lookup(e,r.visitedCellMap)===bc.PendingValue)return Yl(Yc($l.runFrom(e,r.visitedCellMap)))}function ys(e,r,n,t){r.precedents.cells.push(n);var a=e.getCellValue(n);if(a.kind===Os.Failure)return Yl(a.reason);var o=a.value;if(o.kind===bc.FinalValue)return o.oper;_s(o.anchor,r),t.push(o.anchor)}function Fs(e,r,n,t){r.precedents.cells.push(n);var a=e.getCellValues(n);if(a.kind===Os.Failure)return Yl(a.reason);var o=t.length,i=function(e,r,n){for(var t=[],a=r.length,o=0,i=0;i<a;i+=1){t.push([]);var u=r[i].length;o=0===o?u:Math.min(u,o);for(var c=0;c<u;c+=1){var l=r[i][c];bc.FinalValue===l.kind?t[i][c]=l.oper:(_s(l.anchor,e),n.push(l.anchor),t[i][c]=ms)}}return new mc(a,o,t)}(r,a.value,t);return o===t.length?i:void 0}function ks(e,r,n,t){var a=Fs(e,r,n,t);if(null!=a)return Cs(a.rows,a.cols,Oc(a.map(function(e){return cl(e)?0:e})))}function Us(e,r,n,t,a){if(0!=(t&gs.Range))return n;if("object"!=typeof n||n.kind!==gs.Range)return n;var o=n.sheets;if(!Ds(o))return il("calc.runtime.dereference",As.REF,"3D range, oper = "+E(n)),ms;if(1!==n.ranges.length)return il("calc.runtime.dereference",As.VALUE,"union range, oper = "+E(n)),Ns;var i=n.ranges[0];if(0!=(t&al)){if(Ls(i))return ys(e,r,Ss(o,i),a);if(r.source===Rs.Cell){var u=function(e,r){var n=e.row,t=e.col,a=r.row,o=r.col,i=r.rows,u=r.cols,c=a<=n&&n<a+i,l=o<=t&&t<o+u;return c&&l?Zc(n,t):c&&1===u?Zc(n,o):l&&1===i?Zc(a,t):void 0}(r.range.range,i);return null==u?(il("calc.runtime.dereference",As.VALUE,"empty intersection, oper = "+E(n)),Ns):ys(e,r,Ss(o,u),a)}return ks(e,r,Is(o,i),a)}return 0!=(t&gs.Array)?ks(e,r,Is(o,i),a):(il("calc.runtime.dereference",As.VALUE,"bad target type "+t),Ns)}function Ps(e,r,n,t){for(var a=[],o=0;o<n.length;o+=1){var i=Us(e,r,n[o],Ms(t,o),a);null!=i&&(n[o]=i)}if(a.length>0)return Yl(Kc(a))}var bs=tn.OperKind,Bs=tn.valueErrorOper,ws=tn.arrayOper,Gs=sn.operKind,Vs=[Bs,0,"",!1,!1],xs=bs.Number|bs.String|bs.Boolean;function Ws(e){var r=e&xs;return Vs[r&-r]}function Hs(e,r,n){var t=function e(r,n,t){if("number"==typeof n)return 0!=(t&bs.Number)?n:0!=(t&bs.String)?r.formatNumber(n):0!=(t&bs.Boolean)?0!==n:0!=(t&bs.Array)?ws(1,1,[[n]]):Bs;if("string"==typeof n){if(0!=(t&bs.String))return n;if(0!=(t&bs.Number)){if(0===n.length)return Bs;var a=r.parseNumber(n);return vr(a)?a:Bs}return 0!=(t&bs.Boolean)?0===r.stringCompareCI(n,r.trueName)||0!==r.stringCompareCI(n,r.falseName)&&Bs:Bs}if("boolean"==typeof n)return 0!=(t&bs.Boolean)?n:0!=(t&bs.Number)?n?1:0:0!=(t&bs.String)?n?r.trueName:r.falseName:Bs;if(0!=(t&n.kind))return n;switch(n.kind){case bs.Error:return n;case bs.Missing:return 0!=(t&bs.Blank)?tn.blankOper:Ws(t);case bs.Blank:return Ws(t);case bs.Rich:return e(r,n.getFallback(),t);default:return Bs}}(e.config.localeInfo,r,n);return ul(t)&&!ul(r)&&il("calc.runtime.coerceOper",t.type,"kind = "+Gs(r)),t}var Ks=rn.sheetIndex,Qs=tn.OperKind,Xs=tn.rangeSeqOper,Ys=tn.ErrorType,js=tn.valueErrorOper,Js=tn.div0ErrorOper,qs=tn.nullErrorOper,zs=cn.OperatorId,Zs=sn.operKind,$s=sn.isSheetIndex;function ef(e,r){switch(e){case zs.Eq:return 0===r;case zs.Ne:return 0!==r;case zs.Lt:return r<0;case zs.Gt:return r>0;case zs.Le:return r<=0;case zs.Ge:return r>=0}}function rf(e,r,n){return ef(e,r-n)}function nf(e,r,n){return ef(e,r.toLocaleUpperCase().localeCompare(n.toLocaleUpperCase()))}function tf(e,r,n){return ef(e,r<n?-1:r>n?1:0)}function af(e,r,n){if($s(r.sheets))if($s(n.sheets))if(r.sheets.document===n.sheets.document){if(r.sheets.index===n.sheets.index)return Ks(r.sheets.document,r.sheets.index);t="different sheet, range1 = "+E(r)+", range2 = "+E(n);il(e,Ys.VALUE,t)}else{var t="different document, range1 = "+E(r)+", range2 = "+E(n);il(e,Ys.VALUE,t)}else il(e,Ys.VALUE,"3D reference, range2 = "+E(n));else il(e,Ys.VALUE,"3D reference, range1 = "+E(r))}function of(e,r,n){if(1===n.length){var t=n[0];switch(r){case zs.Percent:return $u(t/100);case zs.Neg:return-t;case zs.Pos:return t;default:var a="bad application of "+r+" to 1 argument";return il("calc.runtime.applyOperator",Ys.VALUE,a),js}}if(2===n.length){t=n[0];var o=n[1];switch(r){case zs.Add:return ec(t+o);case zs.Sub:return ec(t-o);case zs.Mul:return ec(t*o);case zs.Div:return 0===o?(il("calc.runtime.applyOperator",Ys.DIV0,"division by zero"),Js):ec(t/o);case zs.Pow:return e.mathpack.power(t,o);case zs.Concat:return t+o;case zs.Eq:case zs.Ne:case zs.Lt:case zs.Le:case zs.Gt:case zs.Ge:return function(e,r,n){var t=Zs(r),a=Zs(n);if(t!==a){if(t===Qs.Blank)switch(a){case Qs.Number:return tf(e,0,n);case Qs.String:return nf(e,"",n);case Qs.Boolean:return rf(e,!1,n)}if(a===Qs.Blank)switch(t){case Qs.Number:return tf(e,r,0);case Qs.String:return nf(e,r,"");case Qs.Boolean:return rf(e,r,!1)}return ef(e,t-a)}switch(t){case Qs.Number:return tf(e,r,n);case Qs.String:return nf(e,r,n);case Qs.Boolean:return rf(e,r,n);case Qs.Blank:return ef(e,0);default:return!1}}(r,t,o);case zs.Range:return function(e,r){var n=af("calc.runtime.applyRangeOp",e,r);if(null==n)return js;var t=[El(pl(e.ranges),pl(r.ranges))];return Xs(n,t)}(t,o);case zs.Isect:return function(e,r){var n=af("calc.runtime.applyIsectOp",e,r);if(null==n)return js;for(var t=[],a=0;a<e.ranges.length;a+=1)for(var o=0;o<r.ranges.length;o+=1){var i=vl(e.ranges[a],r.ranges[o]);null!=i&&t.push(i)}if(0===t.length){var u="empty intersection, range1 = "+E(e)+", range2 = "+E(r);return il("calc.runtime.applyIsectOp",Ys.NULL,u),qs}return Xs(n,t)}(t,o);case zs.Union:return null==(l=af("calc.runtime.applyUnionOp",u=t,c=o))?js:Xs(l,u.ranges.concat(c.ranges));case zs.And:return t&&o;case zs.Or:return t||o;case zs.Xor:return t!==o;case zs.Min:return Math.min(t,o);case zs.Max:return Math.max(t,o);default:var i="bad application of "+r+" to 2 arguments";return il("calc.runtime.applyOperator",Ys.VALUE,i),js}}var u,c,l,s="bad application of "+r+" to "+n.length+" arguments";return il("calc.runtime.applyOperator",Ys.VALUE,s),js}var uf=rn.sheetIndex,cf=rn.sheetGridRange,lf=tn.arrayOper,sf=tn.nameErrorOper,ff=tn.naErrorOper,df=tn.numErrorOper,Ef=tn.valueErrorOper,pf=tn.OperKind,vf=tn.ErrorType,hf=tn.SpecialPrecs,Tf=cn.functionType,Rf=cn.FunctionFlags,Sf=cn.SignatureType,If=cn.WorksheetFuncId,gf=cn.getOperatorType,Af=cn.getWorksheetFuncType,mf=sn.operKind,Nf=sn.ResultKind,Cf=sn.success,Of=sn.getArgType,Lf=sn.isValidArgsLength,Df=pf.Number|pf.String|pf.Boolean|pf.Rich|pf.Error|pf.Blank,Mf=Tf(3,[pf.Boolean,Df,Df],[],Sf.All,hf.None,Rf.None),_f=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var n=Af(e),t=r.some(function(e){return"object"==typeof e&&e.kind===pf.Range})?r.slice(0):r;return Ps(this.globals,this.locals,t,n),this.runFunctionToCompletion(lc(e),n,t)},e.prototype.applyOperatorOrFunction=function(e,r){if(fc(e))return of(this.globals,cc(e),r);var n=sc(e);if(n===If._UDF)return Yl(Uc(["call UDF"]));var t=this.globals.getFirstOrderFunc(n);if(t.kind===Nf.Failure)return Yl(t.reason);var a=t.value;if(null==a){var o="nonexistent worksheet function "+n;return il("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",vf.NAME,o),sf}var i=a(this,r);if("object"==typeof i&&i.kind===pf.Error){o="worksheet function "+n+" return value";il("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,o)}return i},e.prototype.arrayLift=function(e,r,n){for(var t=this,a=0,o=0,i=0;i<n.length;i+=1){var u=n[i];ll(u)&&0==(Of(e,i)&pf.Array)?(a=Math.max(a,u.rows),o=Math.max(o,u.cols)):(a=Math.max(a,1),o=Math.max(o,1))}var c=n.map(function(r,n){return t.broadcastOper(a,o,r,Of(e,n))}),l=new Nc(a,o,function(e,n){return r(c.map(function(r){return r.get(e,n)}))}).map(function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===Ku.WorksheetFunction?t.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case pf.Range:return Ef;case pf.Missing:case pf.Blank:return 0;default:return r}});return lf(l.rows,l.cols,Oc(l))},e.prototype.dispatchFunction=function(e,r,n){var t=this;if(!Lf(r,n.length)){var a=JSON.stringify(r),o="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+a;return il("calc.runtime.FunctionDispatcher.dispatchFunction",vf.NUM,o),df}for(var i=n.length,u=Sf.None,c=0;c<i;c+=1){var l=mf(n[c]);0==(l&Of(r,c))&&(u|=l)}if(u===Sf.None)return this.applyOperatorOrFunction(e,n);if(0!=(u&pf.Array)){return this.arrayLift(r,function(n){return t.dispatchFunction(e,r,n)},n)}if(0!=((u&=~pf.Array)&pf.Rich))return Yl(Uc(["calc.runtime.evalFunction.FunctionDispatcher.dispatchFunction: overloading"]));u&=~pf.Rich;var s=[];for(c=0;c<i;c+=1){var f=n[c];if(0!=(u&mf(f))){var d=Of(r,c);if(f=this.coerceOper(f,d),mf(f)===pf.Error&&0==(d&pf.Error))return f}s[c]=f}return this.applyOperatorOrFunction(e,s)},e.prototype.dispatchStrictIf=function(e){var r=this,n=e[0];if("object"!=typeof n){var t=this.coerceOper(n,pf.Boolean);return!0===t?e[1]:!1===t?e[2]:t}switch(n.kind){case pf.Error:return n;case pf.Missing:case pf.Blank:return e[2];case pf.Array:return this.arrayLift(Mf,function(e){return r.dispatchStrictIf(e)},e);case pf.Rich:return Yl(Uc(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case pf.Range:var a="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+E(n));return R.ULS.assertTag(595980809,c.LogCategory.msoulscat_ES_EWAJS,!1,a);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",n)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,n,t){var a=[],o=Us(e,r,n,t,a);if(null==o){if(a.length>0)return Yl(Kc(a));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+E(n);return R.ULS.assertTag(595980819,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return o}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){Ps(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],n=[],t=0;t<e.length;t+=1){var a=e[t];if("object"==typeof a&&a.kind===pf.Range){for(var o=[],i=a.sheets,u=i.index,c=i.length,l=0;l<c;l+=1)for(var s=uf(a.sheets.document,l+u),f=0;f<a.ranges.length;f+=1){var d=cf(s,a.ranges[f]),E=Fs(this.globals,this.locals,d,r);null!=E&&o.push(E)}n.push({kind:Qu.RangeValues,arrays:o})}else n.push(a)}return r.length>0?Yl(Kc(r)):n},e.prototype.makeOperatorReducer=function(e,r){var n=this.getBinaryOperator(e);return function(e,t){return void 0===e?null!=r?r(t):t:n(e,t)}},e.prototype.makeBranchOperatorReducer=function(e,r){var n=this;return function(t,a){var o=n.makeOperatorReducer(e,r)(t,a);return void 0!==t&&!0===o?t:a}},e.prototype.reduceDerefOpers=function(e,r,n){function t(n,t){if("object"==typeof t){if(t.kind===pf.Array)return a(n,new mc(t.rows,t.cols,t.opers));if(t.kind===pf.Rich)return n}var o=r(t);return null==o?n:e(n,o)}function a(e,r){for(var n=e,a=0;a<r.rows;a+=1)for(var o=0;o<r.cols;o+=1)n=t(n,r.get(a,o));return n}return n.reduce(function(e,r){return"object"==typeof r&&r.kind===Qu.RangeValues?r.arrays.reduce(a,e):t(e,r)},void 0)},e.prototype.broadcastOper=function(e,r,n,t){if("object"!=typeof n)return Dc(e,r,n);switch(n.kind){case pf.Missing:case pf.Blank:return Dc(e,r,0);case pf.Array:return 0!=(t&pf.Array)?Dc(e,r,n):function(e,r,n,t){return n.rows===e&&n.cols===r?n:1===n.rows&&1===n.cols?Dc(e,r,n.get(0,0)):1===n.rows?new Nc(e,r,function(e,r){return r<n.cols?n.get(0,r):t}):1===n.cols?new Nc(e,r,function(e,r){return e<n.rows?n.get(e,0):t}):new Nc(e,r,function(e,r){return e<n.rows&&r<n.cols?n.get(e,r):t})}(e,r,new mc(n.rows,n.cols,n.opers),ff);case pf.Range:default:return Dc(e,r,n)}},e.prototype.coerceOper=function(e,r){return Hs(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,n=gf(e),t=[0,0];return function(a,o){return t[0]=a,t[1]=o,Ps(r.globals,r.locals,t,n),r.runFunctionToCompletion(uc(e),n,t)}},e.prototype.getUnaryOperator=function(e){var r=this,n=gf(e),t=[0];return function(a){return t[0]=a,Ps(r.globals,r.locals,t,n),r.runFunctionToCompletion(uc(e),n,t)}},e.prototype.runFunctionToCompletion=function(e,r,n){var t=this.dispatchFunction(e,r,n);return"object"==typeof t&&t.kind===Ku.WorksheetFunction?this.runFunctionMachineToCompletion(t):t},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),yf=function(e){function r(r,n){var t=e.call(this,r)||this;return t.func=n,t}return bn(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(Cf(e))},r.prototype.receiveSuccess=function(e){return R.ULS.assertTag(595980810,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case wc.Unevaluated:for(var n=[],t=r.anchors,a=t.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,t[a]);n.push(o)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r}(zl);function Ff(e,r){return new yf(e,r)}var kf=rn.FormulaSource,Uf=tn.naErrorOper,Pf=sn.failure,bf=sn.ResultKind,Bf=sn.createResolver;function wf(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Gf(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var Vf={kind:wc.Timeout};function xf(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:function(e){return{globals:e,visitedCellMap:$l.newVisitedMap(),resolver:Bf(e),createCellEvaluationMachine:hs,createFormulaEvaluationMachine:hd,createFunctionEvaluationMachine:Ff}}(e)}}var Wf,Hf=function(){function e(e,r){m("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===Bc.Stop)return this.generatePartialResults(),R.ULS.traceTag(595953880,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var n=this.evaluate(Gf(e));return n instanceof Array?(R.ULS.traceTag(595953881,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(n)):(R.ULS.traceTag(595953882,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise(function(n){return e.scheduleFunction(function(){return R.ULS.traceTag(595964228,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),n(r.evaluateAsync(e))})}))}catch(e){return Promise.reject(Pf(e))}},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return Vf;var r=this.evaluationStack[this.evaluationStack.length-1],n=this.evaluateMachine(r);switch(this.currentResult=void 0,n.kind){case Vl.Default:break;case Vl.Dependency:for(var t=0;t<n.machines.length;t+=1)this.evaluationStack.push(n.machines[t]);break;case Vl.Call:this.evaluationStack.push(n.machine);break;case Vl.Return:case Vl.Write:this.performResultTransition(n);break;case wc.JavaScriptError:this.stopEvaluatingWithJavaScriptError(n);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",n)}}}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return R.ULS.assertTag(595980807,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===bf.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Xl))return Jc(e);this.currentResult=Pf(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Jc(e)}},e.prototype.performResultTransition=function(e){if(e.kind===Vl.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Jc(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===bf.Success){(n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Vl.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var n;if((n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Vl.Dependency)break;if(n.latestTransition===Vl.Call){this.currentResult=e.result;break}var t=this.evaluationStack.pop();null!=t&&t.cleanup()}if(0===this.evaluationStack.length){var a="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+E(e.result));return R.ULS.assertTag(595980808,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case bf.Success:this.setFormulaValue(e,r.value);break;case bf.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var n=cl(r)?0:r;if(e.source===kf.Cell){if(ll(n)){var t=void 0===n.opers[0]?Uf:n.opers[0][0];return this.context.globals.setCellValue(e.range,t)}return this.context.globals.setCellValue(e.range,n)}var a=e.range.range,o=dl(a.rows,a.cols,n).opers;return this.context.globals.setCellValues(e.range,o)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(Pf(Hc))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(Pf(e))},e}(),Kf=rn.documentScope,Qf=rn.nameLoc,Xf=rn.sheetIndex,Yf=rn.sheetRange,jf=rn.gridCell,Jf=on.documentQualifier,qf=on.QualifierKind,zf=on.PosKind,Zf=on.CellRefKind,$f=tn.ErrorType,ed=tn.nameErrorOper,rd=tn.refErrorOper,nd=tn.OperKind,td=tn.arrayOper,ad=tn.range3DOper,od=tn.rangeSeqOper,id=sn.gridCellRange,ud=sn.ResultKind,cd=sn.success,ld=sn.failure,sd=sn.sheetGridRangeAnchor,fd=sn.createResolutionHandler,dd=sn.createNameFinder,Ed=[void 0,ed],pd=xl;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(Wf||(Wf={}));var vd=function(e){function r(r,n,t){var a=e.call(this,r)||this;return a.nameEvaluator=fd(dd(function(e){var r=a.getNameFormulaAsTerm(a.locals,e);return void 0!==r&&a.checkForNameCycle(e,a.visitedNameMap),r},Ed),function(e){var r="name resolution; qualifier = "+E(e);return il("calc.runtime.FormulaEvaluationMachine.evalName",$f.NAME,r),Ed},Yl),a.cellEvaluator=fd(function(e){return ad(e.sheet,e.range)},function(e){var r="error ref, qualifier = "+E(e.data.qualifier);return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,r),rd},Yl),a.term=_l("calc.runtime.FormulaEvaluationMachine",t),a.locals=n,a.continuation=[],a.env=pd,a.visitedNameMap=Zl.newVisitedMap(),a.dispatcher=new _f(a.context.globals,n),a}return bn(r,e),r.prototype.next=function(){if(Sc(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,ol),n=this.dispatcher.coerceOper(r,ol);return R.ULS.traceTag(595964229,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalFormula.next: Formula evaluation finished."),this.performReturnTransition(cd(n))}var t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case wc.Unevaluated:for(var n=[],t=r.anchors,a=t.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,t[a]);n.push(o)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var n=r.context;switch(n.kind){case oc.App:var t=r.holeIndex,a=n.children.length;if((l=r.locals)[t]=e,t+1<a)return this.nextHoleTransition(r,n.children[t+1]);var o=n.data.funName,i=n.data.funType;this.dispatcher.dereferenceOpers(l,i);var u=this.dispatcher.dispatchFunction(o,i,l);return"object"==typeof u&&u.kind===Ku.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case oc.If:var l;if(0===(t=r.holeIndex)){var s=this.dispatcher.dereferenceOper(e,nd.Boolean);if("object"!=typeof s){var f=this.dispatcher.coerceOper(s,nd.Boolean),d=!0===f?n.children[1]:!1===f?n.children[2]:f;return this.popContextTransition(r.env,d)}switch(s.kind){case nd.Error:return this.popContextTransition(r.env,s);case nd.Missing:case nd.Blank:return this.popContextTransition(r.env,n.children[2]);case nd.Array:return r.locals=[s],this.nextHoleTransition(r,n.children[t+1]);case nd.Rich:return this.performReturnTransition(ld(Uc(["IF with a rich value condition"])));case nd.Range:var p="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+E(s));return R.ULS.assertTag(595980811,c.LogCategory.msoulscat_ES_EWAJS,!1,p);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",s)}}if((l=r.locals)[t]=e,1===t)return this.nextHoleTransition(r,n.children[t+1]);this.dispatcher.dereferenceOpers(l,Mf);var v=this.dispatcher.dispatchStrictIf(l);return this.popContextTransition(r.env,v);case oc.Name:var h=r.locals;return Zl.unVisit(h,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case oc.Let:var T=n.data,S=e,g=r.env;return this.popContextTransition(Wl(T,S,g),n.children[1]);case oc.Array:var A=this.dispatcher.dereferenceOper(e,tl),m=n.data,N=m.rows,C=m.cols,O=r.holeIndex,L=O%C,D=C===L+1,M=(O-L)/C,_=r.locals;if(_[M][L]=this.dispatcher.coerceOper(A,tl),N===M+1&&D)return this.popContextTransition(r.env,td(N,C,_));var y=D?M+1:M,F=D?0:L+1;return this.nextHoleTransition(r,n.children[y][F]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",n)}},r.prototype.reduceFormula=function(e){switch(e.kind){case oc.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case oc.App:var r=e.data.funName;if(!fc(r)){var n=this.context.globals.getFirstOrderFunc(sc(r));if(n.kind===ud.Failure)return Yl(n.reason)}if(0===e.children.length){var t=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof t&&t.kind===Ku.WorksheetFunction?this.evaluateFunctionTransition(t,void 0):this.updateTermTransition(t)}return this.pushContextTransition(e,e.children[0],[]);case oc.If:case oc.Let:return this.pushContextTransition(e,e.children[0],void 0);case oc.Name:var a=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==a[0]?this.pushContextTransition(e,a[1],a[0]):this.updateTermTransition(a[1]);case oc.Ident:var o=Hl(e.data,this.env);if(null==o){var i="undefined local "+e.data;il("calc.runtime.FormulaEvaluationMachine.reduceFormula",$f.NAME,i)}return this.updateTermTransition(void 0===o?ed:o);case oc.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map(function(){return[]}));case oc.Fun:return this.performReturnTransition(ld(Uc(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,n){var t=function(e,r,n){return{context:e,holeIndex:0,env:r,locals:n}}(e,this.env,n);return this.continuation[this.continuation.length]=t,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var n=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(n)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:Wf.Document},r.prototype.getSheetIndex=function(e,r){var n=this.context.globals.getSheetIndex(e,r);return n.kind===ud.Failure?Yl(n.reason):null==n.value?void 0:n.value},r.prototype.evalSheetQualifier=function(e,r){var n=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof n)return n;var t=this.getSheetIndex(n,r.sheet);return null==t?Wf.Sheet:Xf(n,t)},r.prototype.evalNameQualifier=function(e,r){var n;switch(r.kind){case qf.Document:return"string"!=typeof(n=this.evalDocumentQualifier(r))?Kf(n):n;case qf.Sheet:return this.evalSheetQualifier(e,r);case qf.Ident:n=e.range.sheet.document;var t=this.getSheetIndex(n,r.name);return null!=t?Xf(n,t):"string"!=typeof(n=this.evalDocumentQualifier(Jf(r.name)))?Kf(n):Wf.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var n=this.context.globals.getNameFormula(r);if(n.kind===ud.Failure)return Yl(n.reason);var t=n.value;return null!=t?_l("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",t):void 0},r.prototype.checkNameCycle=function(e,r,n){return void 0!==Zl.lookup(e,n)?Yl(Xc(Zl.runFrom(e,n))):(Zl.visit(e,!0,n),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==Zl.lookup(e,r))return Yl(Xc(Zl.runFrom(e,r)));Zl.visit(e,!0,r)},r.prototype.evalName=function(e,r,n,t){if(Pr(yr.CalcUnifyRangeResolutionCode)){var a=sd(e.range),o=this.context.resolver.resolveName(a,r,n);return this.nameEvaluator(r,o)}if(null==r||r.kind===qf.Relative){var i=e.range.sheet,u=Qf(i,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);if(u=Qf(Kf(i.document),n),null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var c="name resolution; qualifier = "+E(r);return il("calc.runtime.FormulaEvaluationMachine.evalName",$f.NAME,c),[void 0,ed]}var l=this.evalNameQualifier(e,r);if("string"!=typeof l){var s;u=Qf(l,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var f=null==l.index?"document":"sheet",d="name resolution, qualifier = "+E(r)+", resolved to "+f;return il("calc.runtime.FormulaEvaluationMachine.evalName",$f.NAME,d),[void 0,ed]}var p="qualifier resolution, qualifier = "+E(r)+", failed on "+l;return il("calc.runtime.FormulaEvaluationMachine.evalname",$f.NAME,p),[void 0,ed]},r.prototype.evalPos=function(e,r){return r.kind===zf.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return jf(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var n=e.range.range;switch(r.kind){case Zf.Error:return;case Zf.Single:var t=this.evalCellRefSingle(n,r);return id(t,t);case Zf.Range:var a=this.evalCellRefSingle(n,r.ref1),o=this.evalCellRefSingle(n,r.ref2);return id(a,o);case Zf.Row:return Yl(Uc(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case Zf.Col:return Yl(Uc(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(Pr(yr.CalcUnifyRangeResolutionCode)){var n=sd(this.locals.range),t=this.context.resolver.resolveCellRef(n,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,t)}var a=e.range.sheet.document,o=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+E(o);return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,u),rd}if(null!=o&&o.kind===qf.Error){u="qualifier resolution, qualifier = "+E(o);return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,u),rd}if(null!=o&&o.kind===qf.SheetRange){var c=this.getSheetIndex(a,o.sheet1);if(null==c){u="qualifier resolution, qualifier = "+E(o)+", sheet 1";return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,u),rd}var l=this.getSheetIndex(a,o.sheet2);if(null==l){u="qualifier resolution, qualifier = "+E(o)+", sheet 2";return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,u),rd}if(c===l)return od(Xf(a,c),[i]);var s=Yf(a,Math.min(c,l),Math.abs(l-c)+1);return ad(s,i)}var f=null==o||o.kind===qf.Relative?e.range.sheet:this.evalSheetQualifier(e,o);if("string"==typeof f){u="qualifier resolution, qualifier = "+E(o)+", failed on "+f;return il("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",$f.REF,u),rd}return od(f,[i])},r}(zl);function hd(e,r,n){return R.ULS.traceTag(595964230,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalFormula.createFormulaEvaluationMachine: Creating formula evaluator."),new vd(e,r,n)}function Td(e,r,n,t){var a=xf(e),o=hd(a.machineContext,r,n);return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t[0]:qc(function(t){return e(r,"number"==typeof t?t:n)})}(new Hf(a,[o]),t)}var Rd=tn.SpecialPrecs,Sd=tn.precedents;function Id(e){var r=$l.newVisitedMap();return{evalFormula:function(n,t,a,o){var i=Jl(n,t,Sd([],[],Rd.None,!0),r);return Td(e,i,a,o)},evalCells:function(r){return Ts(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);for(var n=xf(e),t=[],a=0;a<r.length;a+=1)t.push(hs(n.machineContext,r[a]));var o=new Hf(n,t),i=wf(e.schedulerInfo);return o.evaluateAsync(i)}(e,r)}}}var gd=tn.OperKind,Ad=tn.valueErrorOper,md=tn.div0ErrorOper,Nd=cn.OperatorId,Cd=sn.isSheetIndex,Od=32767;function Ld(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case gd.Error:return e;case gd.Missing:case gd.Blank:case gd.Rich:return;default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function Dd(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Nd.Concat,function(r){return e.coerceOper(r,gd.String)}),function(e){return e},n);if(null==t){var a="calc.funcs.concat: returned undefined; args = "+E(r);return R.ULS.assertTag(595969627,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}return"string"==typeof t&&t.length>Od?tn.valueErrorOper:t}function Md(e){var r="object"==typeof e&&e.kind===gd.Blank;return(r=r||""===e)?1:0}function _d(e){return"object"!=typeof e||e.kind!==gd.Blank?1:0}function yd(e,r){var n=r[0];if("object"!=typeof n||n.kind!==gd.Range||!Cd(n.sheets)||1!==n.ranges.length)return Ad;var t=e.dereferenceAllOpers(r),a=e.makeOperatorReducer(Nd.Add),o=e.reduceDerefOpers(a,_d,t);return null==o?0:o}function Fd(e){return function(r){if("boolean"==typeof r)return r;if("number"==typeof r)return e.coerceOper(r,gd.Boolean);if("string"!=typeof r)switch(r.kind){case gd.Error:return r;case gd.Missing:case gd.Blank:case gd.Rich:return;default:return I("funcs.aggregationFuncs: booleanOperationCoerce",r)}}}function kd(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Nd.And),Fd(e),n);return null==t?Ad:t}function Ud(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Nd.Or),Fd(e),n);return null==t?Ad:t}function Pd(e){return function(r,n){return e(r)(n[0])}}function bd(e){return function(r,n){return e(r)(n[0],n[1])}}var Bd=tn.numErrorOper,wd=tn.div0ErrorOper,Gd=180/Math.PI,Vd=Math.PI/180;function xd(e,r){return Math.PI}var Wd=Pd(function(e){return e.getMathpack().sqrt}),Hd=Pd(function(e){return e.getMathpack().exp}),Kd=bd(function(e){return e.getMathpack().power}),Qd=Pd(function(e){return e.getMathpack().ln}),Xd=Pd(function(e){return e.getMathpack().log10});function Yd(e,r){var n=r[0],t=r.length<2?10:r[1];return e.getMathpack().log(n,t)}var jd=Pd(function(e){return e.getMathpack().sin}),Jd=Pd(function(e){return e.getMathpack().cos}),qd=Pd(function(e){return e.getMathpack().tan}),zd=Pd(function(e){return e.getMathpack().asin}),Zd=Pd(function(e){return e.getMathpack().acos}),$d=Pd(function(e){return e.getMathpack().atan}),eE=bd(function(e){return e.getMathpack().atan2});function rE(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,Math.ceil(a));return t<0?-Math.round(-t*o)/o:Math.round(t*o)/o}function nE(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return t<0?-Math.ceil(-t*o)/o:Math.ceil(t*o)/o}function tE(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return t<0?-Math.floor(-t*o)/o:Math.floor(t*o)/o}function aE(e,r){var n=r,t=n[0],a=n[1];return 0===a?0:a<0&&t>0?Bd:a*Math.ceil(t/a)}function oE(e,r){var n=r,t=n[0],a=n[1];return 0===a?0===t?0:wd:a<0&&t>0?Bd:a*Math.floor(t/a)}function iE(e,r){var n=r[0];return 2*(n<0?Math.floor(n/2):Math.ceil(n/2))}function uE(e,r){var n=r[0];return Math.abs(n)}function cE(e,r){var n=r[0];return n>0?1:0===n?0:n<0?-1:Bd}function lE(e,r){return r[0]*Gd}function sE(e,r){return r[0]*Vd}var fE=170;function dE(e,r){var n=r[0];if(!isFinite(n)||n<0)return Bd;var t=Math.floor(n+2147483648-2147483648);return t>fE?Bd:function e(r){return A("call just Fact with non Natural value",r),0===r?1:r*e(r-1)}(t)}function EE(e,r){var n=r[0];if(sn.operKind(n)===tn.OperKind.Range){var t=n.sheets,a=n.ranges[0];if(1!==t.length||1!==a.rows||1!==a.cols)return tn.valueErrorOper;n=e.dereferenceOper(n,tn.OperKind.Number)}switch(sn.operKind(n)===tn.OperKind.String&&(n=e.coerceOper(n,tn.OperKind.Number)),sn.operKind(n)){case tn.OperKind.Number:return 0==(1&Math.floor(Math.abs(n)));case tn.OperKind.Error:return n;case tn.OperKind.Missing:return tn.naErrorOper;case tn.OperKind.Blank:return!0;default:return tn.valueErrorOper}}var pE=tn.valueErrorOper;function vE(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function hE(e,r){var n=vE(r),t=n[0],a=n[1];return a<0?pE:a>=t.length?t:t.substr(t.length-a,a)}function TE(e,r){var n=vE(r),t=n[0],a=n[1];return a<0?pE:a>=t.length?t:t.substr(0,a)}function RE(e,r){var n=r[0],t=r[1]-1,a=Math.floor(r[2]);return t<0||a<0?pE:n.substr(t,a)}function SE(e,r){return r[0].length}var IE={};IE[cn.WorksheetFuncId.SUM]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Nd.Add),Ld,n);return null==t?0:t},IE[cn.WorksheetFuncId.PRODUCT]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Nd.Mul),Ld,n);return null==t?0:t},IE[cn.WorksheetFuncId.AVERAGE]=function(e,r){var n,t=e.makeOperatorReducer(Nd.Add),a=e.dereferenceAllOpers(r),o=e.reduceDerefOpers(t,Ld,a),i=e.reduceDerefOpers(t,(n=Ld,function(e){if(null!=n(e))return 1}),a);if(null!=o&&null!=i)return e.getBinaryOperator(Nd.Div)(o,i);if(null==o&&null==i)return md;var u="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+E(r);return R.ULS.assertTag(595980871,c.LogCategory.msoulscat_ES_EWAJS,!1,u)},IE[cn.WorksheetFuncId.CONCAT]=Dd,IE[cn.WorksheetFuncId.CONCATENATE]=Dd,IE[cn.WorksheetFuncId.COUNTBLANK]=function(e,r){var n=r[0];if("object"!=typeof n||n.kind!==gd.Range||!Cd(n.sheets)||1!==n.ranges.length)return Ad;var t=e.dereferenceAllOpers(r),a=e.makeOperatorReducer(Nd.Add),o=e.reduceDerefOpers(a,Md,t);return null==o?0:o},IE[cn.WorksheetFuncId.MAX]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(Nd.Gt,function(e){return!1}),a=e.reduceDerefOpers(t,Ld,n);return null==a?0:a},IE[cn.WorksheetFuncId.MIN]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(Nd.Lt,function(e){return!1}),a=e.reduceDerefOpers(t,Ld,n);return null==a?0:a},IE[cn.WorksheetFuncId.ISERROR]=function(e,r){return sn.operKind(r[0])===tn.OperKind.Error},IE[cn.WorksheetFuncId.ISERR]=function(e,r){var n=r[0];return sn.operKind(n)===tn.OperKind.Error&&n.type!==tn.ErrorType.NA},IE[cn.WorksheetFuncId.ISBLANK]=function(e,r){return sn.operKind(r[0])===tn.OperKind.Blank},IE[cn.WorksheetFuncId.ISLOGICAL]=function(e,r){return sn.operKind(r[0])===tn.OperKind.Boolean},IE[cn.WorksheetFuncId.ISNA]=function(e,r){var n=r[0];return sn.operKind(n)===tn.OperKind.Error&&n.type===tn.ErrorType.NA},IE[cn.WorksheetFuncId.ISNONTEXT]=function(e,r){return sn.operKind(r[0])!==tn.OperKind.String},IE[cn.WorksheetFuncId.ISTEXT]=function(e,r){return sn.operKind(r[0])===tn.OperKind.String},IE[cn.WorksheetFuncId.ISNUMBER]=function(e,r){return sn.operKind(r[0])===tn.OperKind.Number},IE[cn.WorksheetFuncId.ISREF]=function(e,r){return sn.operKind(r[0])===tn.OperKind.Range},IE[cn.WorksheetFuncId.ISEVEN]=EE,IE[cn.WorksheetFuncId.ISODD]=function(e,r){var n=EE(e,r);return sn.operKind(n)===tn.OperKind.Boolean?!n:n};var gE,AE,mE=!1;function NE(e){return mE||(mE=!0,Pr(yr.CalcNewFunctions)&&(IE[cn.WorksheetFuncId.AND]=kd,IE[cn.WorksheetFuncId.OR]=Ud,IE[cn.WorksheetFuncId.COUNTA]=yd,IE[cn.WorksheetFuncId.ABS]=uE,IE[cn.WorksheetFuncId.CEILING]=aE,IE[cn.WorksheetFuncId.DEGREES]=lE,IE[cn.WorksheetFuncId.FLOOR]=oE,IE[cn.WorksheetFuncId.RADIANS]=sE,IE[cn.WorksheetFuncId.ROUND]=rE,IE[cn.WorksheetFuncId.ROUNDUP]=nE,IE[cn.WorksheetFuncId.ROUNDDOWN]=tE,IE[cn.WorksheetFuncId.EVEN]=iE,IE[cn.WorksheetFuncId.SIGN]=cE,IE[cn.WorksheetFuncId.PI]=xd,IE[cn.WorksheetFuncId.SQRT]=Wd,IE[cn.WorksheetFuncId.EXP]=Hd,IE[cn.WorksheetFuncId.POWER]=Kd,IE[cn.WorksheetFuncId.LN]=Qd,IE[cn.WorksheetFuncId.LOG10]=Xd,IE[cn.WorksheetFuncId.LOG]=Yd,IE[cn.WorksheetFuncId.SIN]=jd,IE[cn.WorksheetFuncId.COS]=Jd,IE[cn.WorksheetFuncId.TAN]=qd,IE[cn.WorksheetFuncId.ASIN]=zd,IE[cn.WorksheetFuncId.ACOS]=Zd,IE[cn.WorksheetFuncId.ATAN]=$d,IE[cn.WorksheetFuncId.ATAN2]=eE,IE[cn.WorksheetFuncId.FACT]=dE,IE[cn.WorksheetFuncId.LEFT]=TE,IE[cn.WorksheetFuncId.RIGHT]=hE,IE[cn.WorksheetFuncId.MID]=RE,IE[cn.WorksheetFuncId.LEN]=SE)),IE[e]}(AE=gE||(gE={})).DerefOperKind=Qu,AE.FuncKind=Ku;var CE=[];function OE(e){CE.push(e),25===CE.length&&(R.ULS.traceTag(595944340,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.common.ds.hashSet. collisions: "+CE.join(";")+"."),CE=[])}function LE(e){if(null==e)return"";var r,n=gr(e.sheet.document);n===C?r="illegalDocument":r=(null==n.path?"":"p:"+n.path.toLocaleUpperCase()+",")+"n:"+n.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}function DE(e){var r=1;return r=31*(r=31*(r=31*(r=31*r+e.sheet.index)+e.range.col)+e.range.row)+e.sheet.document.name.length,void 0!==e.sheet.document.path&&(r=31*r+e.sheet.document.path.length),r}function ME(e,r){var n,t,a=e.sheet.document,o=r.sheet.document;return a.name.toLocaleUpperCase()===o.name.toLocaleUpperCase()&&(n=a.path,t=o.path,null==n?null==t:null==t?null==n:n.toLocaleUpperCase()===t.toLocaleUpperCase())&&e.sheet.index===r.sheet.index&&e.range.col===r.range.col&&e.range.row===r.range.row}function _E(){return{map:{},hashCode:e=DE,equality:ME,nelements:0,add:function(r){var n=e(r);if(void 0===this.map[n]||null===this.map[n])this.map[n]=[];else{for(var t=this.map[n],a=0;a<t.length;a+=1)if(this.equality(r,t[a]))return;OE(E(r)+" and "+E(t))}this.map[n].push(r),this.nelements+=1},contains:function(r){var n=e(r),t=this.map[n];if(null==t)return!1;for(var a=0;a<t.length;a+=1)if(this.equality(r,t[a]))return!0;return OE(E(r)+" and "+E(t)),!1},forEach:function(e){var r=this;Object.keys(this.map).forEach(function(n){r.map[+n].forEach(function(r){e(r)})})},size:function(){return this.nelements},remove:function(r){var n=this,t=e(r),a=this.map[t];if(null==a)return!1;var o=[],i=!1;return a.forEach(function(e){n.equality(r,e)?(n.nelements-=1,i=!0):o.push(e)}),this.map[t]=o,i||OE(E(r)+" and "+E(a)),i}};var e}var yE=sn.createResolutionHandler,FE=sn.createNameFinder;function kE(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&UE(e.name,r.name)&&UE(e.path,r.path)}function UE(e,r){return null==e&&null==r||null!=e&&null!=r&&e.toLocaleUpperCase()===r.toLocaleUpperCase()}function PE(e,r,n,t){var a=function(e,r){if(void 0===e){var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t)}switch(e.kind){case ie.Error:return;case ie.Relative:var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t);case ie.Sheet:var a=void 0!==e.document?O(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==a)return;var o=r.getSheetIndex(a,e.sheet);if(null==o)return;return M(a,o);case ie.SheetRange:if(null==(a=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(a,e.sheet1),u=r.getSheetIndex(a,e.sheet2);if(null==i||null==u)return;return i===u?M(a,i):D(a,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,n);if(void 0!==a)if(kE(r.sheet.document,a.document)||(t.crossDocRefs+=1),ar(a))switch(a.index!==r.sheet.index&&(t.crossSheetRefs+=1),e.ref.kind){case ue.Error:return void(t.errRefs+=1);case ue.Col:return void(t.columnRefs+=1);case ue.Row:return void(t.rowRefs+=1);case ue.Range:var o=sr(bE(e.ref.ref1,r),bE(e.ref.ref2,r));return n.maxRangeSize>0&&hl(o)>n.maxRangeSize?void(t.largeRanges+=1):x(a,o);case ue.Single:var i=bE(e.ref,r);return W(a,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else t.crossSheetRefs+=1;else t.errRefs+=1}function bE(e,r){return F(BE(e.row,r.range.row),BE(e.col,r.range.col))}function BE(e,r){switch(e.kind){case ce.Abs:return e.index;case ce.Rel:return e.index+r}}function wE(e,r){var n=void 0;if(void 0===e.qualifier){var t=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==t||null==a)return;n=M(t,a)}else switch(e.qualifier.kind){case ie.Document:n=H(O(e.qualifier.path,e.qualifier.document));break;case ie.Relative:t=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==t||null==a)return;n=M(t,a);break;case ie.Ident:var o=r.getCurrentDocumentLoc();if(null==o)return;var i=r.getSheetIndex(o,e.qualifier.name);n=null==i?H(O(void 0,e.qualifier.name)):M(o,i);break;case ie.Sheet:if(null==(o=void 0!==e.qualifier.document?O(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(o,e.qualifier.sheet)))return;n=M(o,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return K(n,e.whole)}function GE(e,r){switch(r.ref.kind){case ue.Error:e.errRefs+=1;break;case ue.Col:e.columnRefs+=1;break;case ue.Row:e.rowRefs+=1}}function VE(e,r){var n=r[e];return void 0===n&&(n=0),n}function xE(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:wr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){if(Pr(yr.CalcHashSet)){var n=_E();e.forEach(function(e){n.add(e)}),r.forEach(function(r){n.contains(r)||e.push(r)})}else{var t=wr();e.forEach(function(e){t[LE(e)]=!0}),r.forEach(function(r){var n=LE(r);t[n]||(e.push(r),t[n]=!0)})}}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach(function(n){var t=e.functionsCount[n];void 0===t&&(t=0),e.functionsCount[n]=t+r.functionsCount[n]}),Object.keys(r.operatorsCount).forEach(function(n){var t=Number(n),a=e.operatorsCount[t];void 0===a&&(a=0),e.operatorsCount[t]=a+r.operatorsCount[t]})}};return e}function WE(e){var r={_logger:e,_dependencyGraph:wr(),haveDependents:function(e){return void 0!==r._dependencyGraph[LE(e)]},directDependents:function(e){var n=[],t=r._dependencyGraph[LE(e)];return void 0!==t&&t.forEach(function(e){n.push(e)}),n},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=wr()},add:function(e,n,t){var a=Bn({},e);a.getCurrentDocumentLoc=function(){return gr(e.getCurrentDocumentLoc())};var o=xE();if(null==t)return o;var i=void 0,u=void 0;Pr(yr.CalcUnifyRangeResolutionCode)&&(i=function(e,r,n,t){return yE(FE(function(a){var o=r.nameRefToSheetGridRange(e,a);return null==o?o:(n.addDependency(o,e,r.maxRangeSize,t),o)},void 0),Br,function(){})}(n,a,r,o),u=function(e,r,n,t){return yE(function(a){ar(a.sheet)||(t.crossSheetRefs+=1),kE(e.sheet.document,a.sheet.document)||(t.crossDocRefs+=1),a.sheet.index!==e.sheet.index&&(t.crossSheetRefs+=1),ir(a)&&n.addDependency(a,e,r.maxRangeSize,t)},function(e){return GE(t,e)},function(e,r){e.kind===He.NotImplemented?GE(t,r):t.errRefs+=1})}(n,a,r,o));var l,s,f,d=[];for(d.push(t.node);d.length>0;){var E=d.pop();if(null!=E)switch(E.kind){case le.Literal:break;case le.Array:E.nodes.map(function(e){return e.map(function(e){d.push(e)})});break;case le.App:if("object"==typeof E.head){var p=E.head;switch(p.kind){case le.Operator:o.operatorsCount[p.id]=(l=p.id,s=o.operatorsCount,f=void 0,void 0===(f=s[l])&&(f=0),f+1);break;case le.Name:o.functionsCount[p.whole]=VE(p.whole,o.functionsCount)+1;break;default:d.push(p)}}E.args.map(function(e){d.push(e)});break;case le.Paren:d.push(E.node);break;case le.Name:if(o.nameRefs+=1,Pr(yr.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,a.resolver.resolveName(n,E.qualifier,E.whole));else if(void 0===i){var v=wE(E,a);if(void 0!==v)null!=(h=a.nameRefToSheetGridRange(n,v))&&r.addDependency(h,n,a.maxRangeSize,o)}else R.ULS.traceTag(595952269,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case le.CellRef:if(Pr(yr.CalcUnifyRangeResolutionCode)&&void 0!==u)u(E,a.resolver.resolveCellRef(n,E.qualifier,E.ref));else if(void 0===u){var h;void 0!==(h=PE(E,n,a,o))&&r.addDependency(h,n,a.maxRangeSize,o)}else R.ULS.traceTag(595952270,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case le.Bad:o.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",E)}}return o},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=WE(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){var n=function(n){var t=r._dependencyGraph[n],a=e[n];void 0===t&&(t=[]);var o=t;if(Pr(yr.CalcHashSet)){var i=_E();o.forEach(function(e){i.add(e)}),a.forEach(function(e){i.contains(e)||o.push(e)})}else{var u=wr();o.forEach(function(e){u[LE(e)]=!0}),a.forEach(function(e){u[LE(e)]||o.push(e)})}r._dependencyGraph[n]=o};for(var t in e)n(t)},addDependency:function(e,n,t,a){if(ur(e)){var o=LE(e);r.updateDependency(o,n)&&a.dependents.push(e)}else if(hl(e.range)>t)a.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=W(e.sheet,F(i,u));r.addDependency(c,n,t,a)}},updateDependency:function(e,n){var t=r._dependencyGraph[e];return void 0===t&&(t=[]),!t.some(function(e){return t=n,a=(r=e).sheet,o=t.sheet,a.document===o.document&&a.index===o.index&&function(e,r){return e.row===r.row&&e.col===r.col}(r.range,t.range);var r,t,a,o})&&(t.push(n),r._dependencyGraph[e]=t,!0)},getDependents:function(e,n){if(Pr(yr.CalcHashSet)){for(var t=_E(),a=[],o=r.directDependents(e);o.length>0;){if(void 0!==(l=o.shift()))if(!t.contains(l))t.add(l),(s=r.directDependents(l)).length>0&&s.forEach(function(e){o.push(e)}),n&&0!==s.length||a.push(l)}return a}for(var i=wr(),u=[],c=r.directDependents(e);c.length>0;){var l;if(void 0!==(l=c.shift())){var s,f=LE(l);if(!i[f])i[f]=!0,(s=r.directDependents(l)).length>0&&(c=c.concat(s)),n&&0!==s.length||u.push(l)}}return u},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return HE(0,0);var n=e.length,t=0;return e.forEach(function(e){var n=r._dependencyGraph[e];t+=n.length}),HE(n,t)}};return r}function HE(e,r){return{nodes:e,arcs:r}}var KE=sn.createResolver,QE=sn.success;function XE(e){return S(e),WE(e)}function YE(e,r,n,t,a,o,i,u,c,l){return{maxRangeSize:e,nameRefs:r,rowRefs:n,columnRefs:t,crossSheetRefs:a,crossDocRefs:o,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:l,resolver:KE({getSheetIndex:function(e,r){return QE(c(e,r))},getDocumentLoc:i})}}var jE=rn.FormulaSource,JE=rn.sheetGridCell,qE=rn.gridCell,zE=rn.documentLoc,ZE=rn.sheetIndex,$E=on.RefStyle,ep=sn.ResultKind,rp=sn.failure;function np(e,r,n,t){return{getNumberFormatCategory:e,getCellFormat:r,knownFormats:n,formatValueTypes:t}}function tp(e,r,n){return{config:e,mathpack:r,formatInfo:n}}function ap(e){var r,n,t,a,o,i,u,l,s,f={globals:e,runtime:(n=(r=e).config,t=r.mathpack,a={config:n},o=Bn({config:n},r.formatInfo),i={config:n,mathpack:t},u=xi(a),l=ju(o),s=Fl(i),{parser:u,analyzer:l,compiler:s}),cache:wr(),lazyCreateCacheItem:function(e){var r,n=LE(e),t=f.cache[n];return void 0===t&&(t={cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},f.cache[n]=t),t},size:function(){var e=0;for(var r in f.cache)e+=1;return e},clear:function(){f.cache=wr()},cells:function(){var e=Object.keys(f.cache);return void 0===e||0===e.length?[]:e.map(function(e){return f.cache[e].cell})},getItem:function(e){var r=LE(e);return f.cache[r]},getValue:function(e){var r=f.getItem(e);if(void 0!==r&&null!==r.rawValue)return r.rawValue},getFormula:function(e,r,n){var t=f.getItem(e);if(void 0!==t&&op(f.runtime,t,r,n)&&ip(t.formula))return t.formula},getFormulaFormat:function(e){var r=f.getItem(e);if(void 0!==r)return r.format},getCompiledFormula:function(e,r){var n=f.getItem(e);if(void 0!==n&&function(e,r,n){if(ip(r.compiledFormula))return!0;if(!op(e,r,n))return!1;if(void 0!==n&&n)return!1;r.compiledFormula=null;try{var t=e.compiler.compileFormula(r.cell,jE.Cell,r.formula);return t.kind===ep.Success&&(r.compiledFormula=t.value,!0)}catch(e){return R.ULS.traceTag(595968586,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+E(e)),!1}}(f.runtime,n,r)&&ip(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var r=f.getItem(e);if(void 0!==r)return r.evalResult},isEqualValue:function(e,r){var n=f.getItem(e);return void 0!==n&&n.rawValue===r},updateCellValue:function(e,r,n,t,a){if(!f.isEqualValue(e,r)){var o=f.lazyCreateCacheItem(e);if(o.rawValue=r,o.formula=void 0,o.compiledFormula=void 0,o.evalResult=void 0,o.format=void 0,null!=n){var i=n.getValue(e);void 0!==i&&r===i&&(o.formula=n.getFormula(e,!0),o.compiledFormula=n.getCompiledFormula(e,!0),o.evalResult=void 0,o.format=o.format)}null!=a&&(o.format=a),null!=t&&t.forEach(function(e){var r=f.getItem(e);void 0!==r&&(r.evalResult=void 0)})}},updateEvalResult:function(e,r,n){var t=f.lazyCreateCacheItem(e);t.evalResult=r,null!=n&&(t.format=n)},merge:function(e,r){e.cells().forEach(function(n){var t=e.getValue(n);void 0===t||!0!==r&&void 0!==f.getItem(n)||f.updateCellValue(n,t,e)})},parseCompileNameFormula:function(e,r,n){var t,a=void 0===n?$E.A1:n,o=jE.NameManager;if(void 0!==r)t=f.runtime.parser.parseFormula(a,r,o,e);else{var i=ZE(zE(void 0,"Doc"),0),u=qE(0,0);t=f.runtime.parser.parseFormula(a,JE(i,u),o,e)}var l=E(e);if(t.kind!==ep.Success){var s="calc.formulaCache.parseCompileNameFormula: couldn't parse "+l;return R.ULS.traceTag(595969230,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,s),rp(Wn(s))}var d=f.runtime.analyzer.checkFormula(r,jE.NameManager,t.value);if(d.isWellFormed)return f.runtime.compiler.compileFormula(r,o,d);var p="calc.formulaCache.parseCompileNameFormula: formula "+l+" is not well-formed.";return R.ULS.traceTag(595969231,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,p),rp(Gc(p))}};return f}function op(e,r,n,t){if(ip(r.formula))return!0;if(!ip(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==n&&n)return!1;r.formula=null;var a=r.rawValue;try{var o=e.parser.parseFormula(on.RefStyle.A1,r.cell,jE.Cell,a);if(o.kind!==ep.Success)return!1;var i=e.analyzer.checkFormula(r.cell,jE.Cell,o.value,t);if(!i.isWellFormed)return!1;if(r.formula=i,Pr(yr.CalcFormatCalculations)){var u=e.analyzer.findBestFormat(r.cell,jE.Cell,i);r.format=void 0===u?void 0:u.iformat}return!0}catch(e){return R.ULS.traceTag(595968585,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+E(e)),!1}}function ip(e){return null!=e}n.d(r,"location",function(){return rn}),n.d(r,"formula",function(){return on}),n.d(r,"value",function(){return tn}),n.d(r,"signature",function(){return cn}),n.d(r,"util",function(){return sn}),n.d(r,"config",function(){return dn}),n.d(r,"parse",function(){return t}),n.d(r,"analyze",function(){return a}),n.d(r,"runtime",function(){return o}),n.d(r,"calc",function(){return i}),n.d(r,"funcs",function(){return u})}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map