var sharedClipboard=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.utils=n;var o=r(5);t.idbPromised=o;var i=r(1);t.ULS=i.ULS,t.TraceLevel=i.TraceLevel,t.LogCategory=i.LogCategory,t.NulLogger=i.NulLogger,t.ConsoleLogger=i.ConsoleLogger;var a=r(6);t.browserSupport=a;var s=r(7);t.perfWatch=s;var d=r(8);t.initEwaUtils=d.initEwaUtils,t.ewaUtils=d.ewaUtils;var c=r(9);t.initStopwatchFactory=c.initStopwatchFactory},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,o){return t.traceTag(e,r,n,o)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,o){return t.debugTraceTag(e,r,n,o)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,o){return t.assertTag(e,r,n,o)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,o){return t.shipAssertTag(e,r,n,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce(function(e,n){return e.then(function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)})},Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){if(void 0===r&&(r=0),r<0||r>n)return t;if(null==t||"object"!=typeof t)return t;var o={};Object.getOwnPropertyNames(t).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var a={};return Object.keys(o).forEach(function(t){a[t]=e(o[t],r+1)}),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=5;var o="_",i=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(i,o).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===o&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===o&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),n=function(t){r=r.catch(function(r){return e(t,r)})},o=1;o<=t;o+=1)n(o);return r}},function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"sharedClipboardSettingsVariableName",function(){return V}),r.d(n,"defaultPromiseTimeoutInMinutes",function(){return $}),r.d(n,"getSharedClipboardSettings",function(){return X}),r.d(n,"initializeSharedClipboardSettingsFromWindow",function(){return Y}),r.d(n,"initializeSharedClipboardSettings",function(){return Z}),r.d(n,"createEmptySharedClipboardSettings",function(){return te});var o,i=r(0);function a(){return o}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function d(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var c,l,u,p,g,f="";!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.SystemClipboardAndIndexedDB=1]="SystemClipboardAndIndexedDB",e[e.IndexedDB=2]="IndexedDB",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage"}(c||(c={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.IndexedDBSetClipboardItems=4]="IndexedDBSetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.IndexedDBGetClipboardItems=6]="IndexedDBGetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.SelectClipboardStrategy=14]="SelectClipboardStrategy",e[e.IndexedDBProviderNotSupported=15]="IndexedDBProviderNotSupported",e[e.IndexedDBCacheInitialization=16]="IndexedDBCacheInitialization",e[e.IndexedDBGetCache=17]="IndexedDBGetCache",e[e.IndexedDBDeleteDb=18]="IndexedDBDeleteDb",e[e.IndexedDBSetItem=19]="IndexedDBSetItem",e[e.IndexedDBGetItem=20]="IndexedDBGetItem",e[e.IndexedDBGetAllKeys=21]="IndexedDBGetAllKeys",e[e.IndexedDBGetAllItems=22]="IndexedDBGetAllItems",e[e.IndexedDBRemoveItem=23]="IndexedDBRemoveItem",e[e.IndexedDBRemoveAllItems=24]="IndexedDBRemoveAllItems",e[e.IndexedDBClearAll=25]="IndexedDBClearAll",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IndexedDBCacheInitializationTimeout=30]="IndexedDBCacheInitializationTimeout",e[e.IndexedDBSetTimeout=31]="IndexedDBSetTimeout",e[e.IndexedDBGetTimeout=32]="IndexedDBGetTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageClipboardStrategyInitilization=40]="LocalStorageClipboardStrategyInitilization",e[e.IframeProxyGeneralError=41]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=42]="IframeProxyEmptyResultMessage"}(l||(l={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var m=function(e){function t(r,n,o){var s=this,d=t.augmentParameterValue(r);if((s=e.call(this,d)||this).name=t.augmentParameterValue(n),s.errorName=s.name,s.name?a().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+s.name+"': "+d):a().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+d),o){s.innerError=o;var c=s.innerError.message;c||(c=s.innerError.name);var l=t.augmentParameterValue(c);l.length>0&&a().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+l)}return s.stack||(s.stack=(new Error).stack),s}return d(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():f},t}(Error),h=function(e){function t(r,n,o){var i=this,a=m.augmentParameterValue(n),s=t.getDefaultMessage(a),d=m.augmentParameterValue(r);return 0===d.length&&(d=s),(i=e.call(this,d,"MissingArgumentError",o)||this).name=a,i}return d(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(m),S=function(e){function t(r,n,o,i){var a=this,s=m.augmentParameterValue(n),d=o;d||(d=f);var c=t.getDefaultMessage(s,d),l=m.augmentParameterValue(r);return 0===r.length&&(l=c),(a=e.call(this,l,"InvalidArgumentError",i)||this).name=s,a.value=d,a}return d(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(m),b=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return d(t,e),t}(m);(function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}d(t,e)})(m),function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}d(t,e)}(m);function v(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:f}var C=function(e){function t(t,r,n,o,i){var a=e.call(this,r||"reason="+t,n,o)||this;return a.reason=t,i&&(a.errorName=i),a}return d(t,e),t}(m),w=(function(e){function t(t,r,n){return e.call(this,t,r,"CopyError",n,v(t,u))||this}d(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"PasteError",n,v(t,p))||this}d(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"CancelError",n,v(t,g))||this}d(t,e)}(C),function(e){function t(t,r,n){return e.call(this,t,r,"ClipboardPlatformError",n,v(t,l))||this}return d(t,e),t}(C));!function(e){function t(t,r,n){return e.call(this,t,r,"SharedClipboardError",n,v(t,l))||this}d(t,e)}(C);function y(){return _}var _={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:f},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:f}},E={};new RegExp("(\\bTrident/| MSIE )");var I=16.16299,L=17.17123,T=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function P(){if(void 0===E.isEdgeProperty){E.isEdgeProperty=!1,E.isEdgeWithTextHtmlClipboardSupportProperty=!1,E.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=y();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(T);if(r&&2===r.length){E.isEdgeProperty=!0;var n=Number(r[1]);isNaN(n)||(n>=I&&(E.isEdgeWithTextHtmlClipboardSupportProperty=!0),n>=L&&(E.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return E.isEdgeProperty}var D={postMessage:function(e,t,r,n){e.postMessage(t,r,n)}},A="text/plain",M="text/html";1..toString();var x,W,U,F=(x={items:{}},{getData:function(){return x},getItem:function(e){},setItem:function(e,t){throw new b("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":f)+"empty)")},get:function(){return k(void 0)}});function R(){return F}function H(e){return e&&e.items?Object.keys(e.items).length:0}function O(e){return H(e&&e.getData())}function J(e){void 0===e&&(e=void 0);var t=e;return t||(t={items:{}}),{getItem:function(e){return j(t,e)},setItem:function(e,r){!function(e,t,r){if(!e)throw new h(f,"clipboardItemsData");if(!e.items)throw new S(f,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},getData:function(){return t},get:function(){return k(t)}}}function j(e,t){if(!e)throw new h(f,"clipboardItemsData");if(!e.items)throw new S(f,"clipboardItemsData.items");return e.items[t]}function B(e,t){if(!e||0===e.length||!t||!t.trim())return f;var r=void 0;return e.forEach(function(e){e.clipboardDataFormat===t&&(r=e.data)}),r||f}function N(e){if(e){var t=z(e);if(t){var r=Number(t);if(r&&!isNaN(r))return r}}}function z(e){if(e)return j(e,"metadata/system-clipboard-data-ccp-timestamp")}function k(e){var t=[];if(0===H(e))return t;for(var r in e.items){var n=j(e,r);n||(n=f);var o={clipboardDataFormat:r,data:n};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.IndexedDB=1]="IndexedDB",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(W||(W={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose"}(U||(U={}));var V="sharedClipboardSettings",G=te(),q=!1,K=1,Q=3600,$=2;function X(){if(!q)throw new b("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return G}function Y(){q=!1,function(){if(!(window&&V in window))return G=te(),void(q=!0);var e=window[V];if(!e||"string"!=typeof e)return G=te(),void(q=!0);ee(JSON.parse(e))}()}function Z(e){q=!1,ee(e)}function ee(e){if(!e)throw new h(f,"sharedClipboardSettingsCandidate");var t=te();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return G=t,void(q=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),G=t,void(q=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,n=r.indexOf(re);n>=0&&(r=r.substr(n+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(e){}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(function(e){return!e||!e.trim()}))return a().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],G=t,void(q=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(e){}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(function(e){return!e||!e.trim()}))return a().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],G=t,void(q=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return a().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],G=t,void(q=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return a().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],G=t,void(q=!0)}t.whitelistOriginComponents=!0,G=t,q=!0}function te(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:f,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:K,sharedClipboardExpirationInMinutes:Q,clipboardPromiseTimeoutInMinutes:$}}new RegExp("^\\d+$");var re="-";var ne=1;function oe(e,t){var r;return null==(r=t)?a().ULS.traceTag(595973151,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is undefined."):r===ne&&a().ULS.traceTag(596451804,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"validateUserHash: userHash is set to the default non-user-hash value of "+ne),null==e||e===ne||null==t||e!==t}function ie(e){if(!e)throw new h(f,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new S(f,"id");return t}function ae(){return(Math.random()+1).toString(36).substring(7)}var se=function(){function e(){}return e.localStorageData="localStorage/data",e.indexedDBData="indexedDB/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function de(e){return"get"===e||"set"===e||"init"===e||"getMetadata_longPolling"===e}var ce=function(e){if(!e)throw new h(f,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new h(f,"id");if(!e.operationCode)throw new h(f,"operationCode");if(!e.destination)throw new h(f,"destination");if(!de(e.operationCode))throw new S(f,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function le(e,t,r,n,o){var i={id:e,operationCode:t,failed:r,error:n,clipboardItemsData:o};return ue(i),i}var ue=function(e){if(!e)throw new h(f,"clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new h(f,"id");if(!e.operationCode)throw new h(f,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new S(f,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new S("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new S("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new S("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new S("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function pe(e){if(!e||0===e.trim().length)throw new S(f,"className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&a().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new b(r(e))}}}()}var ge="\n",fe=new RegExp("("+ge+"\r)|(\r"+ge+")|(\r)","g"),me=new RegExp("(\t)","g"),he=new RegExp("<","g"),Se="&lt;",be=new RegExp(">","g"),ve="&gt;",Ce="pre",we="table",ye="tr",_e="td",Ee="\x3c!--StartFragment--\x3e",Ie="\x3c!--EndFragment--\x3e",Le=(Ee.length,Ie.length,"Version:0.9"+ge+"StartHTML:0000000100"+ge+"EndHTML:{EndHTML0}"+ge+"StartFragment:0000000134"+ge+"EndFragment:{EndFragm}"+ge+"<html>"+ge+"<body>"+ge+Ee+ge),Te=""+Ie+ge+"</body>"+ge+"</html>",Pe="0000000000",De="</html>".length,Ae="data-ccp-timestamp",Me=0;function xe(e){if(0!==O(e)){var t=Date.now();N(e.getData())||e.setItem("metadata/system-clipboard-data-ccp-timestamp",t.toString());var r=function(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:A,data:f}),t}(e);if(!B(r,M)){var n=function(e){return B(e,A)}(r),o=function(e,t,r){if(r!==Me&&!r)throw new h(f,"timestamp");if(isNaN(r))throw new S(f,"timestamp",r.toString());var n=function(e){return e?e.replace(fe,"</"+_e+"></"+ye+"><"+ye+"><"+_e+">"):e}((s=function(e){if(!e)return f;return e.replace(he,Se).replace(be,ve)}(t),s?s.replace(me,"</"+_e+"><"+_e+">"):s)),o="<"+e+" "+Ae+"='"+r+"'><"+we+"><"+ye+"><"+_e+">"+n+"</"+_e+"></"+ye+"></"+we+"></"+e+">";var s;if(!P()||P()&&E.isEdgeVersionWithTextHtmlWrapperSupportProperty)return o;return function(e){var t=Pe.length,r=Le.length+e.length+Te.length,n=(r-Te.length).toString();n.length<t&&(n=Pe.substr(0,t-n.length)+n);if(n.length!==t){var o="addClipboardWrapper: the string representation of the opening bracket position of the End Fragment xml comment is "+n.length+" but it should be "+t;throw a().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new w(l.UnexpectedClipboardTextHtmlContentLength,o)}var s=(r-De).toString();s.length<t&&(s=Pe.substr(0,t-s.length)+s);if(s.length!==t){var o="addClipboardWrapper: the string representation of the opening bracket position of the End Html tag is "+s.length+" but it should be "+t;throw a().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new w(l.UnexpectedClipboardTextHtmlContentLength,o)}var d=Le.replace("{EndHTML0}",s).replace("{EndFragm}",n)+e+Te;return a().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,d.length===r,"addClipboardWrapper: The resulting text/html payload length of "+d.length+" differs from the expected length of "+r),d}(o)}(Ce,n,t);e.setItem(M,o)}}}var We=function(){function e(e,t){this.addMetadataDuringSet=t,this.clipboardStrategyType=e,this.disposableImplementationExtension=pe(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then(function(e){return t.clipboardStorage=e,a().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)},function(e){return a().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)})},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new w(l.ClipboardStrategyNotInitialized))}return this.addMetadataDuringSet&&xe(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new w(l.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new w(l.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e)}catch(e){return Promise.reject(new w(l.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),Ue=function(){function e(e){this.clipboardStorageType=e}return e.prototype.setMetadataAndCacheItems=function(e,t,r){var n=this,o=void 0;if(e&&e.found&&e.result){var i=e.result.lastSystemClipboardDataCcpTimestamp;i&&!isNaN(i)&&1!==i&&(o=i)}if(!t||0===O(t))return this.clear().then(function(){if(!o)return Promise.resolve();var e={id:"2",userHash:r.userHash,lastSystemClipboardDataCcpTimestamp:o};return n.setItem(e)});var a=N(t.getData());a&&(1!==a&&(o=a),function(e){if(e){var t=z(e);(t||t===f)&&delete e.items["metadata/system-clipboard-data-ccp-timestamp"]}}(t.getData()));var s=Date.now(),d={id:"2",created:s,lastUsed:s,userHash:r.userHash,lastSystemClipboardDataCcpTimestamp:o},c={id:"1",clipboardItemsData:t.getData()};return this.setItem(d).then(function(){return n.setItem(c)})},e.prototype.getCacheItemsAndUpdateMetadata=function(e){var t=this,r=R();return this.getItem("2").then(function(n){if(n&&n.found&&n.result){var o=n.result,s=o.userHash,d=e&&e.userHash;return t.clearClipboardNecessary(s,d)?t.clear().then(function(){return Promise.resolve(r)}):t.getItem("1").then(function(e){if(e&&e.found&&e.result){var n=e.result.clipboardItemsData;return a().ULS.traceTag(595952592,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getCacheItemsAndUpdateMetadata: item count="+H(n)),o.lastUsed=Date.now(),t.setItem(o).then(function(){return n=function(e,t){if(!t||isNaN(t))return e;var r=e;return r||(r={items:{}}),r.items["metadata/system-clipboard-data-ccp-timestamp"]=t.toString(),r}(n,o.lastSystemClipboardDataCcpTimestamp),Promise.resolve(J(n))})}return Promise.resolve(r)})}return Promise.resolve(r)})},e.prototype.clearClipboardNecessary=function(e,t){return!1},e}(),Fe=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Re(e){var t=e;return t&&0!==t.trim().length||(t=ae()),new je(t)}function He(){return Fe?window.performance.now():Date.now()}function Oe(e){return Fe?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Je(e,t,r){if(!r)throw new h(f,"creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":He()-r)+"ms"}var je=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=ie(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=He(),a().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+Oe(this.creationTimestamp)),this.promise=new Promise(function(e,t){a().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+Oe(He())),r.internalResolve=e,r.internalReject=t})}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=He(),a().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+Je(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return a().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&a().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+Oe(this.fulfillmentTimestamp)+". "+Je(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();!function(){function e(){this.deferredResultMessagePromiseCache={}}e.prototype.getDeferredPromise=function(e){var t=ie(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return a().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;a().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=Re(e);if(this.getDeferredPromise(t.id))throw new S("A deferred promise already exists in the cache for the specified id","id",t.id);var r=ie(t.id);return this.deferredResultMessagePromiseCache[r]=t,a().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=ie(e);delete this.deferredResultMessagePromiseCache[t],a().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else a().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(a().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){a().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}}}();function Be(e){if(!e)throw new h(f,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new h(f,"incomingMessage");if(!t)throw new h(f,"validator");if(0===e.length)throw new S("An empty message is invalid","incomingMessage");var r,n=e.trim();if(0===n.length)throw new S("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(n)}catch(t){throw new S("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new S("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function Ne(e){if(!e)throw new h(f,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new h(f,"outgoingMessage");if(!t)throw new h(f,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new S("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return a().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}var ze="initmessageid";var ke=function(){function e(e,t,r,n){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=pe(n)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(!function(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach(function(e){if(t+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new b(e.message,e))}else a().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")}),r)throw r}else a().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new h(f,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new b(t)}this.sender.postMessage(e)},e}();function Ve(){return Ge}var Ge={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};var qe="message",Ke=function(){function e(e,t,r){var n=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return n.onMessageReceived(e)},!e)throw new h(f,"deserializer");if(!t)throw new h(f,"handler");if(!r)throw new h(f,"windowRPC");this.disposableImplementationExtension=pe("WindowRPCReceiverInternal"),this.remoteWindow=r.remoteWindow,Ve().addEventListener(qe,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Ve().removeEventListener(qe,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(i.utils.getStringifiedError(e))}catch(e){a().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(function(e){a().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))})}catch(e){a().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else a().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();var Qe=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new h(f,"serializer");if(!t)throw new h(f,"windowRPC");this.disposableImplementationExtension=pe("WindowRPCSenderInternal"),this.remoteWindow=t.remoteWindow}return e.prototype.postMessage=function(e){if(!e)throw new h(f,"outgoingMessage");if(!this.remoteWindow.window)throw new b("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new b("The remote window does not support postMessage");var t=this.serializer.serialize(e);D.postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();var $e;!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}($e||($e={}));var Xe=new(r(1).ConsoleLogger),Ye=function(e){function t(t){var r=e.call(this)||this;return r.clipboardStrategy=t,r.nameForTelemetry="ClipboardStrategyMessageHandler_StrategyType_"+t.clipboardStrategyType,r.addMessageHandler("get",{handleMessage:r.get.bind(r)}),r.addMessageHandler("set",{handleMessage:r.set.bind(r)}),r}return d(t,e),t.prototype.get=function(e,t){var r={userHash:e.userHash};return this.clipboardStrategy.get(r).then(function(e){return t.clipboardItemsData=e.getData(),Promise.resolve(t)},function(e){return et(t,e)})},t.prototype.set=function(e,t){var r={userHash:e.userHash},n=void 0;return e.clipboardItemsData&&(n=e.clipboardItemsData),this.clipboardStrategy.set(J(n),r).then(function(){return Promise.resolve(t)},function(e){return et(t,e)})},t}(function(){function e(){this._handlers={}}return e.prototype.handleMessage=function(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):et(t,new w(l.UnsupportedOperationCode,"Operation code '"+(e?e.operationCode:"incomingMessage is null")+"' is unsupported"))},e.prototype.addMessageHandler=function(e,t){e?e in this._handlers?a().ULS.shipAssertTag(595944464,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: handle for operation: "+e+" already exist"):this._handlers[e]=t:a().ULS.shipAssertTag(595944463,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")},e}()),Ze=function(e){function t(t,r){var n=e.call(this,t)||this;return n.localStorageKey=r,n.state=void 0,n.isFirstLongPollingRequest=!0,n.addMessageHandler("getMetadata_longPolling",{handleMessage:n.getMetadataLongPolling.bind(n)}),window.addEventListener("storage",n.onStorageChanged.bind(n)),n}return d(t,e),t.prototype.getMetadataLongPolling=function(e,t){var r=this;return this.state&&(a().ULS.shipAssertTag(595944465,i.LogCategory.msoulscat_ES_EWAJS,!1,"LocalStorageMetadataMessageHandler.getMetadataLongPolling: expected state to be undefined. if it defined it means getMetadataLongPolling called before raiseMetadataChangedEvent get called. which is unexpected."),this.state.deferredPromise.reject()),this.state={deferredPromise:Re(),outgoingMessage:t,incomingMessage:e},this.isFirstLongPollingRequest&&(this.isFirstLongPollingRequest=!1,setTimeout(function(){r.raiseMetadataChangedEvent()},0)),this.state.deferredPromise.promise},t.prototype.onStorageChanged=function(e){e.key===this.localStorageKey&&this.raiseMetadataChangedEvent()},t.prototype.raiseMetadataChangedEvent=function(){var e=this,t=this.state;t&&this.get(t.incomingMessage,t.outgoingMessage).then(function(r){if(!r||r.failed)a().ULS.traceTag(595944405,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageMetadataMessageHandler.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage");else{var n=t.deferredPromise;e.state=void 0,n.resolve(r)}})},t}(Ye);function et(e,t){return tt(e,t),Promise.resolve(e)}function tt(e,t){e.failed=!0,e.error=i.utils.getStringifiedError(t)}var rt=function(e){function t(t,r,n,o){var i=e.call(this,r,t,n,"WindowRPCServerInternal")||this;if(i.windowRPCServerState=o,!o)throw new w(l.CreateWindowRPCServer,"windowRPCServerState is undefined.");return i.receiver=function(e,t,r){return new Ke(e,t,r)}(t,i,i),i.sender=function(e,t){return new Qe(e,t)}(r,i),i}return d(t,e),t.prototype.handleMessage=function(e){var t=this;if(a().ULS.traceTag(596452360,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"RPC Server - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.clipboardItems.length="+H(e&&e.clipboardItemsData)),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();var r=e&&e.id?e.id:"unknownmessageid",n=!e||!e.operationCode||!de(e.operationCode),o={id:r,failed:n,error:void 0,operationCode:n?"unknownresult":e.operationCode+"result"};return this.routeOperation(e,o).then(function(e){return t.postMessage(e)}).catch(function(e){return a().ULS.traceTag(596452182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. "+i.utils.getStringifiedError(e)),o.clipboardItemsData=void 0,tt(o,e),t.postMessage(o)}).catch(function(e){return a().ULS.traceTag(596452183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. "+i.utils.getStringifiedError(e)),Promise.reject(e)})},t.prototype.routeOperation=function(e,t){if(this.windowRPCServerState.isInitializationPending())return et(t,new w(l.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return et(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);var r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):et(t,new w(l.SelectClipboardStrategy,"messageHandler does not exist"))},t.prototype.handleDeserializationError=function(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:e,operationCode:"unknownresult"}).catch(function(e){a().ULS.traceTag(596451867,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. "+i.utils.getStringifiedError(e))})},t.prototype.postMessage=function(t){try{return e.prototype.postMessage.call(this,t),Promise.resolve()}catch(e){return Promise.reject(new b("Unable to post message for operation '"+(t&&t.operationCode?t.operationCode:f)+"'",e))}},t}(ke);function nt(e){if(!e)return Promise.resolve(!1);var t=function(e){try{var t=window.parent,r=t.location.origin;return new rt(Be(ce),Ne(ue),{window:t,windowOrigin:r},e)}catch(e){return void a().ULS.shipAssertTag(595981475,i.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: "+i.utils.getStringifiedError(e))}}(ot);if(!t)return a().ULS.traceTag(595947554,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);var r=Re(ze);return(it={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:r,windowRPCServer:t}).initializationDeferredPromise.promise.then(function(){return function(){var e=st();if(a().ULS.shipAssertTag(595947555,i.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new b("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));var t=le(dt(),"initresult",!1);return e.postMessage(t)}()},function(e){return function(e){var t=st();if(a().ULS.shipAssertTag(595947584,i.LogCategory.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new b("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));var r=le(dt(),"initresult",!0,i.utils.getStringifiedError(e));return t.postMessage(r)}(e)}).catch(function(){}),e.then(function(e){return function(e){var t=Object.keys(e).map(function(t){return"Name: "+t+", handlerName: "+(e[t]&&e[t].nameForTelemetry)}).join(", ");if(a().ULS.traceTag(595947585,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"markInitializationSuccess: Created and initialized ClipboardStrategies '"+t+"'"),a().ULS.shipAssertTag(595947586,i.LogCategory.msoulscat_ES_EWAJS,!!it,"markInitializationSuccess: windowRPCServerInternalState must be defined"),!it)return;it.clipboardOperationMessageHandlerMap=e,it.clipboardInitError=void 0,it.clipboardInitTimestamp=Date.now(),it.initializationDeferredPromise&&it.initializationDeferredPromise.resolve()}(e),Promise.resolve(!0)},function(e){return function(e){if(a().ULS.traceTag(595947587,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,i.LogCategory.msoulscat_ES_EWAJS,!!it,"markInitializationFailure: windowRPCServerInternalState must be defined"),!it)return;it.clipboardOperationMessageHandlerMap=void 0,it.clipboardInitError=e,it.clipboardInitTimestamp=Date.now(),it.initializationDeferredPromise&&it.initializationDeferredPromise.reject(it.clipboardInitError)}(e),Promise.resolve(!1)})}var ot={getMessageHandler:function(e){if(!it)return;if(!e)return void a().ULS.shipAssertTag(595945235,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined");if(!it.clipboardOperationMessageHandlerMap)return void a().ULS.shipAssertTag(595945236,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");if(!(e in it.clipboardOperationMessageHandlerMap))return void a().ULS.shipAssertTag(595945237,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: "+e+" is not part of ClipboardStrategyMap");return it.clipboardOperationMessageHandlerMap[e]},isInitializationPending:at,isInitializedSuccessfully:function(){if(it)return!at()&&!!it.clipboardOperationMessageHandlerMap;return!1},getClipboardInitError:function(){if(it)return it.clipboardInitError;return}},it=void 0;function at(){return!it||!it.initializationDeferredPromise||!it.initializationDeferredPromise.fulfilled()}function st(){if(it)return it.windowRPCServer}function dt(){if(!it)return f;var e=it.initMessageIdUniqueRunningSuffix;return it.initMessageIdUniqueRunningSuffix+=1,""+ze+e}var ct="__ccpDB___",lt=function(e){function t(){var t=e.call(this,W.IndexedDB)||this;t.providerSupported=!1,t.cacheCloseHandler=function(){t.closeDB()},t.disposableImplementationExtension=pe("IndexedDBClipboardStorage");var r=i.idbPromised.getDbFactory();return r&&(t.providerSupported=!0,t.dbFactory=r),t}return d(t,e),t.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(596452362,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"indexedDBClipboardStorage.get: commandParameters='"+(e?JSON.stringify(e):f)+"'"),this.getCacheItemsAndUpdateMetadata(e)},t.prototype.set=function(e,t){var r=this;return this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(596452363,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"indexedDBClipboardStorage.set: item count="+O(e)+"'; commandParameters='"+(t?JSON.stringify(t):f)+"'"),this.getItem("2").then(function(n){return r.setMetadataAndCacheItems(n,e,t)})},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[A,M,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.closeDB(),this.disposableImplementationExtension.dispose())},t.prototype.clear=function(){return this.removeAllItems()},t.prototype.clearClipboardNecessary=function(e,t){return oe(e,t)},t.create=function(e,r){i.perfWatch.mark(r,"ccp_idb_create_start"),i.idbPromised.registerTraceSubscriber(function(e){i.perfWatch.mark(r,e)});var n=new t;return n.version=e,n.supported?n.ensureDb(!1,r).then(function(e){return i.perfWatch.mark(r,"ccp_idb_create_ensureDb_noVersion_done"),e.db.version}).then(function(t){return"number"==typeof e&&t<e?(i.perfWatch.mark(r,"ccp_idb_create_dbUpgrade"),n.removeAllItems().then(function(){return i.perfWatch.mark(r,"ccp_idb_create_clearAll_done"),n.ensureDb(!0,r)}).then(function(e){var t=e.db.version;return i.perfWatch.mark(r,"ccp_idb_create_ensureDb_upgrade_"+t),n})):"number"==typeof e&&t>e?(n.providerSupported=!1,Promise.reject(new w(l.IndexedDBProviderNotSupported,"indexedDB: The new version '"+e+"' is smaller than the current DB version '"+t+"'"))):Promise.resolve(n)}).then(function(e){return i.perfWatch.mark(r,"ccp_idb_create_done"),i.idbPromised.clearTraceSubscriber(),e}).catch(function(e){return i.perfWatch.mark(r,"ccp_idb_create_error"),i.idbPromised.clearTraceSubscriber(),Promise.reject(new w(l.IndexedDBCacheInitialization,f,e))}):(i.perfWatch.mark(r,"ccp_idb_not_supported"),Promise.reject(new w(l.IndexedDBProviderNotSupported)))},t.prototype.ensureDb=function(e,t){var r=this;if(void 0===e&&(e=!1),this.db)return Promise.resolve({db:this.db,dbName:ct});if(!this.supported)return Promise.reject(new w(l.IndexedDBProviderNotSupported));if(!this.dbFactory){var n="IndexedDBClipboardStorage.ensureDb: this.dbFactory should be defined";return a().ULS.shipAssertTag(596121483,i.LogCategory.msoulscat_ES_EWAJS,!1,n),Promise.reject(new b(n))}i.perfWatch.mark(t,"ccp_idb_ensureDb_start");var o,s=e?this.version:void 0;return i.idbPromised.initDb(this.dbFactory,ct,s,function(e){i.perfWatch.mark(t,"ccp_idb_ensureDb_CreateStore_start");var r=e.createObjectStore("__store__",{autoIncrement:!1,keyPath:"id"});return i.perfWatch.mark(t,"ccp_idb_ensureDb_CreateStore_finish"),[i.idbPromised.getStoreReadinessPromise(r)]}).then(function(e){return i.perfWatch.mark(t,"ccp_idb_ensureDb_initDb_complete"),o=e,r.db=e.db,i.perfWatch.mark(t,"ccp_idb_ensureDb_attachedToClose"),r.db.addEventListener("close",r.cacheCloseHandler),i.perfWatch.mark(t,"ccp_idb_ensureDb_finish"),Promise.resolve(o)}).catch(function(e){var n=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452065,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in ensureDb: "+n),r.closeDB(),i.perfWatch.mark(t,"ccp_idb_ensureDb_error"),Promise.reject(new w(l.IndexedDBCacheInitialization,"db: '__ccpDB___'; store: '__store__'",new Error(n)))})},t.prototype.init=function(e){return i.perfWatch.mark(e,"ccp_idb_init_start"),this.closeDB(),i.perfWatch.mark(e,"ccp_idb_init_closeCache"),this.ensureDb(!1,e).then(function(){return i.perfWatch.mark(e,"ccp_idb_init_end"),Promise.resolve()})},t.prototype.closeDB=function(){this.db&&(this.db.removeEventListener("close",this.cacheCloseHandler),this.db.close(),this.db=void 0)},Object.defineProperty(t.prototype,"supported",{get:function(){return this.providerSupported},enumerable:!0,configurable:!0}),t.prototype.setItem=function(e){return this.ensureDb().then(function(t){return i.idbPromised.put(t.db,"__store__",void 0,e).catch(function(e){var t=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452066,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in setItem: "+t),Promise.reject(new Error(t))})}).catch(function(e){return Promise.reject(new w(l.IndexedDBSetItem,"db: '__ccpDB___'; store: '__store__'",e))})},t.prototype.getItem=function(e){return this.ensureDb().then(function(t){return i.idbPromised.get(t.db,"__store__",e).then(function(e){return{result:e,found:void 0!==e}},function(e){var t=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452067,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in getItem: "+t),Promise.reject(new Error(t))})}).catch(function(t){var r="db: '__ccpDB___'; store: '__store__'; key: '"+e+"'";return Promise.reject(new w(l.IndexedDBGetItem,r,t))})},t.prototype.removeItem=function(e){return this.ensureDb().then(function(t){return i.idbPromised.remove(t.db,"__store__",e).catch(function(e){var t=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452096,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in removeItem: "+t),Promise.reject(new Error(t))})}).catch(function(t){var r="db: '__ccpDB___'; store: '__store__'; key: '"+e+"'";return Promise.reject(new w(l.IndexedDBRemoveItem,r,t))})},t.prototype.removeAllItems=function(){return this.ensureDb().then(function(e){return i.idbPromised.removeAll(e.db,"__store__").catch(function(e){var t=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452097,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in removeAllItems: "+t),Promise.reject(new Error(t))})}).catch(function(e){return Promise.reject(new w(l.IndexedDBRemoveAllItems,"db: '__ccpDB___'; store: '__store__'",e))})},t.prototype.deleteDb=function(){var e=this;return this.ensureDb().then(function(t){return i.idbPromised.deleteDb(e.dbFactory,t.db.name).then(function(){return e.closeDB(),Promise.resolve(ct)},function(e){var t=i.utils.getStringifiedError(e);return a().ULS.traceTag(596452098,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Error in deleteDb: "+t),Promise.reject(new Error(t))})}).catch(function(e){return Promise.reject(new w(l.IndexedDBDeleteDb,"db: '__ccpDB___'; store: '__store__'",e))})},t}(Ue);function ut(){return a().ULS.traceTag(596452420,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+c.IndexedDB+"'"),(new pt).initialize(function(){a().ULS.traceTag(596452421,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+W.IndexedDB+"'");var e=i.perfWatch.start("createIndexedDBClipboardStorage");return lt.create(n.getSharedClipboardSettings().sharedClipboardSchemaVersion,e).then(function(t){return i.perfWatch.success(e,function(e){return a().ULS.traceTag(596452062,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}),Promise.resolve(t)}).catch(function(t){var r=f;return i.perfWatch.failure(e,function(e){r=e;var n="; Exception: "+i.utils.getStringifiedError(t);a().ULS.traceTag(596452063,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,r+n)},"Error in createIndexedDBClipboardStorage"),Promise.reject(new w(l.IndexedDBCacheInitialization,r,t))})}())}var pt=function(e){function t(){return e.call(this,c.IndexedDB,!1)||this}return d(t,e),t}(We);var gt=function(){function e(e){if(this.localStorageKey=e,!localStorage)throw new w(l.LocalStorageClipboardStrategyInitilization,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=W.LocalStorage,this.disposableImplementationExtension=pe("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(595945240,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters='"+(e?JSON.stringify(e):f)+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(R());try{var r=JSON.parse(t);if(!r||0===H(r))return Promise.resolve(R());var n=J(r);return Promise.resolve(n)}catch(e){return Promise.resolve(R())}},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(595945241,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+O(e)+"'; commandParameters='"+(t?JSON.stringify(t):f)+"'"),0===O(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData())),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[A,M,"data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function ft(e){return a().ULS.traceTag(595945238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+c.LocalStorage+"' with localStorageKey: '"+e+"'"),(new mt).initialize(function(e){try{a().ULS.traceTag(595945239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+W.LocalStorage+"'");var t=new gt(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}var mt=function(e){function t(){return e.call(this,c.LocalStorage,!1)||this}return d(t,e),t}(We),ht="OfficeOnlineCCP_Metadata_",St="OfficeOnlineCCP_Data_";function bt(){return function(e){if(!e)throw new Error("The 'logger' argument is missing");o=i.ULS.getFromExternalLogger(e)}(Xe),n.initializeSharedClipboardSettingsFromWindow(),nt(ut().then(function(e){return ft(St+n.getSharedClipboardSettings().sharedClipboardSchemaVersion).then(function(t){var r=ht+n.getSharedClipboardSettings().sharedClipboardSchemaVersion;return ft(r).then(function(n){var o={};return o[se.indexedDBData]=new Ye(e),o[se.localStorageData]=new Ye(t),o[se.localStorageMetadata]=new Ze(n,r),o})})}))}r.d(t,"a",function(){return bt})},function(e,t,r){"use strict";r.r(t);var n=r(0);for(var o in n)"default"!==o&&function(e){r.d(t,e,function(){return n[e]})}(o);var i=r(3);r.d(t,"initialize",function(){return i.a})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(2);function i(e,t,r){return e?!(t&&!e.objectStoreNames.contains(t))||(r({name:"ValidationError",message:"The database doesn't contain store name: "+t}),!1):(r({name:"ValidationError",message:"The database should be initialized"}),!1)}var a=void 0;function s(e){void 0!==a&&a(e)}function d(e,t,r,n){return new Promise(function(o,a){if(i(e,t,a)){var s,d=e.transaction([t],r);d.oncomplete=function(){return o()},d.onerror=function(){return a(s||d.error)},d.onabort=function(){return a(s||d.error)};var c=d.objectStore(t),l=n(c);l.onerror=function(){s=l.error}}})}t.registerTraceSubscriber=function(e){a=e},t.clearTraceSubscriber=function(){a=void 0},t.setTestDbFactory=function(e){n=e},t.getDbFactory=function(){if(n)return n;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(r){var e=o.getStringifiedError(r);e&&e!==o.defaultToJSONResultWhenStringifyFails||!r||!r.message||(e=r.message);var t=o.getPerfWatchMarkName(e);s("indexedDB_access_error"+(t&&t.length>0?"_":"")+t)}},t.getStoreReadinessPromise=function(e){return new Promise(function(t,r){e.transaction.oncomplete=function(){return t()},e.transaction.onerror=function(){return r(e.transaction.error)}})},t.initDb=function(e,t,r,n){return new Promise(function(o,i){s("idb_open");var a,d,c,l,u=r||0===r?e.open(t,r):e.open(t),p=(a=!1,d=!1,c=function(e){s("idb_open_"+e)},l=function(){return d?(c("already_resolved"),!1):!a||(c("already_rejected"),!1)},{rejectOnce:function(e){c("should_reject"),l()&&(c("rejecting"),a=!0,i(e))},resolveOnce:function(e){c("should_resolve"),l()&&(c("resolving"),d=!0,o(e))}});u.onupgradeneeded=function(e){s("idb_open_onupgradeneeded_start");var r=e.target.result;if(e.oldVersion>0&&function(e){s("idb_open_onupgradeneeded_deleteAllObjectStores");for(var t=[],r=e.objectStoreNames.length-1;r>=0;r-=1){var n=e.objectStoreNames.item(r);(n||""===n)&&t.push(n)}t.forEach(function(t){s("idb_open_onupgradeneeded_delete_store_"+t),e.deleteObjectStore(t)})}(r),n){s("idb_open_onupgradeneeded_create_stores");var o=n(r);o&&o.length>0&&Promise.all(o).then(function(){s("idb_open_onupgradeneeded_stores_ready"),p.resolveOnce({db:r,dbName:t})},function(e){s("idb_open_onupgradeneeded_stores_ready_error"),p.rejectOnce(e)})}s("idb_open_onupgradeneeded_end")},u.onsuccess=function(e){s("idb_open_onsuccess"),p.resolveOnce({db:e.target.result,dbName:t})},u.onerror=function(){s("idb_open_onerror"),p.rejectOnce(u.error)},u.onblocked=function(e){s("idb_open_onblocked"),p.rejectOnce(e)}})},t.deleteDb=function(e,t){return new Promise(function(r,n){var o=e.deleteDatabase(t);o.onsuccess=function(){return r()},o.onblocked=function(){return r()},o.onerror=function(){return n(o.error)}})},t.doTransactionAction=d,t.put=function(e,t,r,n){return d(e,t,"readwrite",function(e){return r?e.put(n,r):e.put(n)})},t.get=function(e,t,r){return new Promise(function(n,o){if(i(e,void 0,o)){var a;e.objectStoreNames.contains(t)||n(void 0);var s=void 0,d=e.transaction([t],"readonly");d.oncomplete=function(){return n(s)},d.onerror=function(){return o(a||d.error)},d.onabort=function(){return o(a||d.error)};var c=d.objectStore(t).get(r);c.onsuccess=function(e){s=e.target.result},c.onerror=function(){a=c.error}}})},t.getAllItems=function(e,t){return new Promise(function(r,n){if(i(e,t,n)){var o,a=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(a)},s.onerror=function(){return n(o||s.error)},s.onabort=function(){return n(o||s.error)};var d=s.objectStore(t).openCursor();d.onsuccess=function(e){var t=e.target.result;t&&(a.push(t.value),t.continue())},d.onerror=function(){o=d.error}}})},t.getAllKeys=function(e,t){return new Promise(function(r,n){if(i(e,t,n)){var o,a=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(a)},s.onerror=function(){return n(o||s.error)},s.onabort=function(){return n(o||s.error)};var d=s.objectStore(t).openCursor();d.onsuccess=function(e){var t=e.target.result;t&&(a.push(t.key),t.continue())},d.onerror=function(){o=d.error}}})},t.remove=function(e,t,r){return d(e,t,"readwrite",function(e){return e.delete(r)})},t.removeAll=function(e,t){return d(e,t,"readwrite",function(e){return e.clear()})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},o="promises";t.promises=function(){return void 0===n[o]&&(n[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n[o]}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,i=t,a={},s=function(e,t,n){return function(e,t,r,n,i,a){o(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:a,marks:e},d=JSON.stringify(s);i(d)}(a,r,i,e,t,n)};return a.start=0,{mark:function(e){return function(e){return o(a,e,i)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),window.performance&&window.performance.now&&(n=function(){return window.performance.now()}),function(r){var o=n(),i=r;return{reset:function(e){null!=e&&(i=e),o=n()},stop:function(){var r=n()-o,a=JSON.stringify({Target:i,Duration:r.toFixed(t)});e(a)}}}}}]);
//# sourceMappingURL=sharedClipboard.min.js.map