typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.i=function(){};Common.App.CollabControls.i.registerInterface("Common.App.CollabControls.i");Common.App.CollabControls.a=function(){};Common.App.CollabControls.a.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14};Common.App.CollabControls.a.registerEnum("Common.App.CollabControls.a",!1);Common.App.CollabControls.h=function(n){this.v=Function.createDelegate(this,this.Z);Common.App.CollabControls.h.initializeBase(this);this.o=n};Common.App.CollabControls.h.a=function(n,t){return n+(t?"Rtl":"")};Common.App.CollabControls.h.prototype={o:null,bg:function(){return this.o},F:function(){return this.o.style.visibility==="visible"},z:function(n){return this.o.style.visibility=n?"visible":"hidden",n},Y:function(n){return this.o.dir=n?"rtl":"ltr",n},dispose:function(){this.o&&this.o.parentNode&&this.o.parentNode.removeChild(this.o);this.o=null;Common.M.prototype.dispose.call(this)},G:function(n){return this.o.ownerDocument.createElement(n)},Z:function(){return!0}};Common.App.CollabControls.c=function(n,t){Common.App.CollabControls.c.initializeBase(this);this.a=n;this.b=t};Common.App.CollabControls.c.prototype={a:0,b:null};Common.App.CollabControls.b=function(n,t,i){var u,r;for(this.H=Function.createDelegate(this,this.bd),this.s=[],this.p=[],Common.App.CollabControls.b.resolveInheritance(),this.e=this.bg,Common.App.CollabControls.b.initializeBase(this,[n]),this.B={},this.J=i,this.y=i.a(Boolean,8),this.x=i.a(Boolean,11),u=i.a(Number,12),this.w=i.a(Number,6),this.K=t,this.o.id=Common.App.CollabControls.b.b(),this.o.className=Common.App.CollabControls.h.a("prControl",this.y),u&&(this.o.style.zIndex=u),this.Y(this.y),this.bf(t),this.t=this.G("div"),this.t.className=this.x?"prContainerV":"prContainerHr",this.o.appendChild(this.t),this.q=new Array(this.u),r=0;r<this.u;r++)this.q[r]=new Common.App.CollabControls.d(this.G("div"),this.J),this.q[r].l(this.H),this.o.appendChild(this.q[r].o)};Common.App.CollabControls.b.b=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.b.a++)};Common.App.CollabControls.b.c=function(n){var t=n.a.rawEvent,i=t.relatedTarget;return i||t.toElement};Common.App.CollabControls.b.prototype={t:null,u:0,y:!1,A:!1,x:!1,C:!1,K:0,J:null,B:null,f:function(){return Common.bS.c(this.s)},q:null,I:null,w:0,ba:function(){return this.x?this.w+2:this.K},U:function(){return this.x?this.K:this.w+2},c:function(n){this.n("InteractivityChanged",n)},b:function(n){this.r("InteractivityChanged",n)},dispose:function(){var t;if(this.q)for(var i=this.q,r=i.length,n=0;n<r;++n)t=i[n],t.u(this.H),System.a.a(t);System.a.b(this.p);this.q=null;this.p=null;Common.App.CollabControls.h.prototype.dispose.call(this)},k:function(){this.D();this.O();this.z(!0);this.A=!1},j:function(){!this.p||this.p.length<1||(this.D(),this.z(!0),this.O(),this.L(this.p[this.p.length-1],0),this.A=!0)},W:function(){var t,r;if(this.p&&!(this.p.length<1)){this.z(!0);this.O();t=0;for(var i=this.p,u=i.length,n=0;n<u;++n)r=i[n],this.L(r,t++);this.A=!1;this.C=!0}},g:function(){this.z(!1);this.D();for(var n=0;n<this.p.length;n++)this.p[n].q();this.A=!1},R:function(){var n,r;if(!this.C)return!1;n=0;for(var i=this.q,u=i.length,t=0;t<u;++t)r=i[t],r.F()&&n++;return this.C=n>0&&(this.s.length<=this.u?n===this.s.length:n===this.u),this.C},a:function(n){var r,u,f,t,i;if(!(this.u<=0)){if(n.j||(n.j=(Common.App.CollabControls.b.a++).toString()),n.j in this.B&&(r=this.T(n.j),r>=0)){if(u=this.s[r],u.n===n.n&&u.l===n.l)return;this.i(n.j)}f=this.R();i=0;this.s.length<this.u?(t=new Common.App.CollabControls.e(this.G("div"),this.J,n),t.t(this.H),this.y&&!this.x&&this.s.length>0?this.t.insertBefore(t.o,this.t.firstChild):(this.t.appendChild(t.o),i=this.p.length),Array.add(this.p,t)):(this.y&&!this.x?t=this.p[0]:(i=this.p.length-1,t=this.p[i]),t.l(n));t.s();this.B[n.j]=t;Array.add(this.s,n);this.X(t,i);f&&this.W()}},i:function(n){var t=this.R();t&&this.D();this.V(n);this.s.length>=this.u&&this.p.length<this.u&&this.be();this.s.length<=0?this.g():t&&this.W()},V:function(n){var r=this.T(n),i,t;r<0||(i=this.s[r],Array.removeAt(this.s,r),t=this.B[i.j],delete this.B[i.j],t.C(i.j),this.X(t,0),t.a.length<=0&&(this.t.removeChild(t.o),Array.remove(this.p,t),t.dispose()))},be:function(){var t=this.bb(),n,i,r;!t||t.a.length<=1||(n=Array.clone(this.s),i=this,Array.forEach(n,function(n){i.V(n.j)}),r=this,Array.forEach(n,function(n){r.a(n)}))},T:function(n){for(var t=0;t<this.s.length;t++)if(this.s[t].j===n)return t;return-1},bb:function(){return this.y&&!this.x?this.p[0]:this.p[this.p.length-1]},h:function(n,t){for(var u,f,i,e,r=0;r<this.p.length;r++)if(u=this.p[r],f=this.Q(Common.f.a(u.o),t,this.y),u.F()&&Common.f.b(f,n))return!0;for(i=0;i<this.u;i++)if(this.q[i]&&this.q[i].F()&&(e=this.Q(Common.f.a(this.q[i].o),t,!this.y),Common.f.b(e,n)))return!0;return!1},Q:function(n,t,i){var r=n.height+2*t,u=n.width+t,f=n.y-t,e=i?n.x:n.x-t;return new Sys.UI.Bounds(e,f,u,r)},l:function(n,t){this.o.style.top=t+"px";this.o.style.left=n+"px"},O:function(){for(var n=0;n<this.p.length;n++)this.p[n].s()},D:function(){for(var n=0;n<this.u;n++)this.q[n].c();this.C=!1},L:function(n,t){var r,u,i;if(n)if(this.I=n,this.x)if(r=this.w,n.a.length>1)this.q[t].j(n.a,r,this.U()-this.w);else for(u=this.t.children.length,i=0;i<this.t.children.length;i++)n.o===this.t.children[i]&&this.q[t].j(n.a,r,this.U()-(u-i)*(this.w+2)+2);else this.q[t].j(n.a,this.ba(),0)},bd:function(n,t){var i=$$as(Common.App.CollabControls.e,n),r=i?this.S(i):-1;if(t.a!==2&&(t.a!==1||r===-1||this.q[r].F())){if(t.a===1)this.D(),this.A=!1;else if(t.a===3){if(this.d(t.b))return;this.A||this.D()}}else this.L(n,0);this.m("InteractivityChanged",t,null)},d:function(n){for(var f,t=Common.App.CollabControls.b.c(n),r=!1,u=this.q,e=u.length,i=0;i<e;++i)if(f=u[i],Common.i.n(f.o,t)){r=!0;break}return this.t!==t&&Common.i.n(this.t,t)||r},X:function(n,t){var i=this.bc(n);i&&n.a.length<=0?this.q[t].c():i?this.L(n,0):this.q[t].c()},S:function(n){for(var u,i=0,r=this.p,f=r.length,t=0;t<f;++t){if(u=r[t],n===u)return i;i++}return-1},bc:function(n){var t=this.S(n);return!!this.I&&n===this.I&&t!==-1&&this.q[t].F()},bf:function(n){this.u=n===this.w?1:Math.floor(n/(this.w+2));this.x?(this.o.style.height=n+"px",this.o.style.width=this.w+"px"):(this.o.style.width=n+"px",this.o.style.height=this.w+"px")}};Common.App.CollabControls.f=function(n){this.a=n;this.a.d(10,Common.h.a());this.a.d(9,Common.e.a());this.a.d(6,16);this.a.d(13,Common.R.a())};Common.App.CollabControls.f.prototype={a:null,b:function(n){return new Common.App.CollabControls.b(n,16,this.a)}};Common.App.CollabControls.d=function(n,t){this.h=Function.createDelegate(this,this.t);this.g=Function.createDelegate(this,this.s);Common.App.CollabControls.d.initializeBase(this,[n]);this.i=t.a(Boolean,8);this.f=t.a(Number,6);this.o=n;this.o.className=Common.App.CollabControls.d.a;this.b=this.G("ul");this.o.appendChild(this.b);this.d=t.a(Common.dC,10);this.d.a("click",this.o,this.g);this.a=t.a(Common.ek,9);this.a.a("msospPointerOut",this.o,this.h);this.a.a("msospPointerDown",this.o,this.v);this.e=t.a(Common.R,13);this.e.a(this.o,this.v)};Common.App.CollabControls.d.prototype={d:null,a:null,e:null,b:null,f:0,i:!1,l:function(n){this.n("InteractivityChanged",n)},u:function(n){this.r("InteractivityChanged",n)},k:null,dispose:function(){this.o&&(this.d.b("click",this.o,this.g),this.a.b("msospPointerDown",this.o,this.v),this.a.b("msospPointerOut",this.o,this.h),this.e.c(this.o,this.v));Common.App.CollabControls.h.prototype.dispose.call(this)},c:function(){this.z(!1)},j:function(n,t,i){(this.c(),!n||n.length<=0)||(this.i?this.o.style.right=t+"px":this.o.style.left=t+"px",this.o.style.top=i+"px",this.q(n),this.z(!0))},q:function(n){this.k=n;Common.i.g(this.b);for(var t=n.length-1;t>=0;t--)this.p(n[t])},p:function(n){var t=document.createElement("li");t.style.backgroundColor=n.n;t.style.height=this.f+"px";t.id="fly_"+n.j;t.style.lineHeight=this.f+"px";Common.i.q(t,n.l);t.setAttribute("dir","auto");this.b.appendChild(t)},s:function(){return this.c(),!1},t:function(n){return this.m("InteractivityChanged",new Common.App.CollabControls.c(3,n),null),!1}};Common.App.CollabControls.e=function(n,t,i){this.i=Function.createDelegate(this,this.y);this.j=Function.createDelegate(this,this.A);this.k=Function.createDelegate(this,this.B);this.a=[];Common.App.CollabControls.e.initializeBase(this,[n]);this.o.className="prGlyph";this.b=t;this.c=this.b.a(Common.ek,9);this.d=this.b.a(Common.dC,10);this.h=this.b.a(Common.R,13);this.x();this.l(i);this.g=!1};Common.App.CollabControls.e.prototype={e:null,b:null,g:!0,d:null,c:null,h:null,t:function(n){this.n("InteractivityChanged",n)},dispose:function(){this.D();Common.App.CollabControls.h.prototype.dispose.call(this)},l:function(n){Array.add(this.a,n);this.a.length===2?this.f(!0):this.a.length===1?this.f(!1):this.f(this.g)},C:function(n){var t=this.u(n);t&&(this.a.length>1&&this.f(!0),this.a.length===1?this.f(!1):this.a.length<1&&this.q())},s:function(){this.f(this.a.length>=2);this.z(!0)},q:function(){this.z(!1)},w:function(n){return n?this.p(0,5):this.p(1,4)},u:function(n){for(var i,t=0;t<this.a.length;t++)if(this.a[t].j===n)return i=this.a[t],Array.removeAt(this.a,t),i;return null},f:function(n){this.g!==n&&(this.e&&this.o.removeChild(this.e),this.e=this.w(n),this.o.appendChild(this.e),this.g=n);this.e.childNodes[0].style.backgroundColor=this.a[this.a.length-1].n},p:function(n,t){var i=this.b.a(Number,6),r=this.b.a(Object,14);return Common.A.c(i,i,this.b.a(String,n),this.b.a(String,t),"cui-img-cont-float cui-img-16by16","",!1,"",this.o.ownerDocument,r?r.cloneNode(!0):null)},B:function(n){return n.b!==3&&this.m("InteractivityChanged",new Common.App.CollabControls.c(2,n),null),!1},y:function(n){return this.m("InteractivityChanged",new Common.App.CollabControls.c(1,n),null),!0},A:function(n){return n.b!==3&&this.m("InteractivityChanged",new Common.App.CollabControls.c(3,n),null),!1},D:function(){this.o&&(this.c.b("msospPointerDown",this.o,this.v),this.c.b("msospPointerOver",this.o,this.k),this.c.b("msospPointerOut",this.o,this.j),this.d.b("dblclick",this.o,this.v),this.d.b("click",this.o,this.i),this.h.c(this.o,this.v))},x:function(){this.o&&(this.c.a("msospPointerDown",this.o,this.v),this.c.a("msospPointerOver",this.o,this.k),this.c.a("msospPointerOut",this.o,this.j),this.d.a("dblclick",this.o,this.v),this.d.a("click",this.o,this.i),this.h.a(this.o,this.v))}};Common.App.CollabControls.g=function(){this.c={}};Common.App.CollabControls.g.prototype={a:function(n,t){var r=Common.App.CollabControls.a.toString(t),i;return n===Number?(i=this.c[r],i?Number.parseInvariant(i.toString()):0):this.c[r]},b:function(n,t){this.c[Common.App.CollabControls.a.toString(n)]=t},d:function(n,t){Common.App.CollabControls.a.toString(n)in this.c||(this.c[Common.App.CollabControls.a.toString(n)]=t)}};Common.App.CollabControls.h.registerClass("Common.App.CollabControls.h",Common.M,Sys.IDisposable);Common.App.CollabControls.c.registerClass("Common.App.CollabControls.c",Sys.EventArgs);Common.App.CollabControls.b.registerClass("Common.App.CollabControls.b",Common.App.CollabControls.h,Common.App.CollabControls.i,Sys.IDisposable);Common.App.CollabControls.d.registerClass("Common.App.CollabControls.d",Common.App.CollabControls.h);Common.App.CollabControls.e.registerClass("Common.App.CollabControls.e",Common.App.CollabControls.h);Common.App.CollabControls.b.a=0;Common.App.CollabControls.d.a="prFlyout UIFont";Type.registerNamespace("Common.App.Presence");Common.App.Presence.a=function(n,t,i,r,u,f,e,o){this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.s);this.k=n;this.i=t;this.g=i;this.f=r;this.d=f;Common.App.Presence.a.a=u;this.h=e;this.j=o;$$sc.a.WAA(t,i).CW(this.m)};Common.App.Presence.a.prototype={a:null,e:!0,b:null,k:null,d:0,i:null,c:null,g:null,l:null,f:null,h:null,j:null,s:function(){this.i.a()&&this.g.a()&&(this.c=this.i.a(),this.l=this.g.a(),this.c.c(this.n),this.b=new Common.H(2,2,this.d,this.o,88,null),Common.App.Presence.a.a.a(this.b))},t:function(n,t){var u,f,o,r,e,i;if(this.e){Common.App.Presence.a.a.d(this.b,0);return}u=t.b;for(f in u)if(o={key:f,value:u[f]},r=this.f.a(o),r&&r.a()&&(e=r.a().toLowerCase(),i=this.a[e],i||(i=this.a[e.toUpperCase()]),i&&i.a===2)){Common.App.Presence.a.a.d(this.b,0);return}},v:function(n){var u=this.r(),h,c,y,l,a,v,t,f,i;if(u){var e=new($$sc.s.$$(String)),o=new($$sc.s.$$(String)),r=new Date,s=!1;if(this.e){this.a=u;this.e=!1;h=this.a;for(c in h)y={key:c,value:h[c]},l=y.value,l.b<r&&(r=l.b);Common.App.Presence.a.a.d(n,this.p(r));return}a=this.a;for(v in a)(t={key:v,value:a[v]},t.key in this.a&&this.k.a()!==t.key)&&(f=this.a[t.key],i=u[t.key],f&&i&&(f.a===2&&i.a===1?(e.b(t.key),Diag.a.a(38052609,392,50,t.key+" returned from away")):f.a===1&&i.a===2&&(this.l.c(t.key),Diag.a.a(38052610,392,50,t.key+" went away"),s||(s=!0)),i.a===1&&i.b<r&&(r=i.b)));this.a=u;Common.App.Presence.a.a.d(n,this.p(r));e.e.length>0&&(o=this.q(e),this.u(o));(s||o.e.length>0)&&this.h(591885930,2,null)}},u:function(n){var i,r,t;if(n.e.length){for(i=n.$$lge();i.$$mn();)r=i.$$cu(),t=new CommonUI.j(String.format($a.cB,r),!1),t.i(5),t.l("CoAuth_AuthorStatus_16x16x32"),this.j(t);this.h(591885930,2,null)}},r:function(){return this.c.u()},q:function(n){var e=this.c.e(),i=new($$sc.s.$$(String)),f=e,r,t,u;for(r in f)t={key:r,value:f[r]},n.c(t.key)&&(u=this.f.a(t),u&&(i.b(u.f()),n.d(t.key)));return i.e.length||Diag.a.a(38052611,392,10,"There were no coauthor names found"),i},p:function(n){var t=new Date;return Math.max(n.getTime()+this.d-t.getTime(),0)}};Common.App.Presence.a.a=null;Type.registerNamespace("Common");Common.eu=function(n,t,i,r){this.b=n;this.a=t;this.d=i;this.c=r};Common.eu.a=function(n,t){return t=t||"skypeproxy.ashx",new Common.eu(new($$sc.w.$$(Common.dD))(function(){return Common.a.d}),Common.a.k,n,t)};Common.eu.prototype={b:null,a:null,d:null,c:null,g:function(){return this.b.a()},e:function(n,t){var i=this.d.a("WebServiceCall","CreateSkypeChatThread"),r=this,u=this;this.f(new Common.App.SkypeChat.l(this.a),function(t){i.a();n(t)},function(n){i.a();t(n)})},f:function(n,t,i){var r={};r["Content-Type"]="application/json; charset=utf-8";this.g().a(this.c,2,n.b(),r,!1,2,t,i,null,null,!1,null,null,null,null,!1,null)}};Type.registerNamespace("Common.App.SkypeChat");Common.App.SkypeChat.c=function(n,t,i){this.Email=n;this.InChat=t;this.Capabilities=i};Common.App.SkypeChat.t=function(){};Common.App.SkypeChat.t.registerInterface("Common.App.SkypeChat.t");Common.App.SkypeChat.e=function(){};Common.App.SkypeChat.e.registerInterface("Common.App.SkypeChat.e");Common.App.SkypeChat.f=function(){};Common.App.SkypeChat.f.registerInterface("Common.App.SkypeChat.f");Common.App.SkypeChat.w=function(){};Common.App.SkypeChat.v=function(){};Common.App.SkypeChat.x=function(){};Common.App.SkypeChat.n=function(){this.h=new Common.M};Common.App.SkypeChat.n.prototype={h:null,o:!1,a:function(n){this.h.n("AVCEK",n)},b:function(n){this.h.n("MPUEK",n)},p:function(n){n!==this.o&&(this.h.m("AVCEK",new Common.App.SkypeChat.b(n,!1),null),this.o=n,Diag.a.a(6603939,333,50,"Chat availability changed to now be {0}",n))},x:function(){this.h.m("MPUEK",null,null)}};Common.App.SkypeChat.o=function(){this.i=new Common.M};Common.App.SkypeChat.o.prototype={w:function(n){this.i.m("NTID_EK",new Common.fe(n),null)},b:function(n){this.i.n("NTID_EK",n)},a:function(n){this.i.n("DCD_EK",n)},x:function(){this.i.m("DCD_EK",null,null)}};Common.App.SkypeChat.b=function(n,t){Common.App.SkypeChat.b.initializeBase(this);this.b=n;this.c=t};Common.App.SkypeChat.b.prototype={b:!1,a:function(){return this.b},c:!1};Common.App.SkypeChat.g=function(n,t,i){this.e=Function.createDelegate(this,this.h);this.d=n;this.b=t;this.a=i};Common.App.SkypeChat.g.prototype={a:null,d:null,b:null,c:!1,g:function(){if(this.c){Diag.a.a(9000738,333,15,"Init called multiple times");return}this.c=!0;var n=Common.a.b.a("DocChatIsEnabled");n&&this.b.a(this.e)},h:function(n){var t=this;n.a().CW(function(){var i=n.a().a();i.a?t.f(i):i.b&&(Common.a.bd&&n.b()!==3?Diag.a.a(18121750,333,50,"DocChatBootstrapper: Anonymous Doc Chat is not available because the user name is unknown."):t.f(i))})},f:function(n){Diag.a.a(9000739,333,15,"DocChatBootStrapper: Doc chat is enabled.");this.d.a().a(Common.a.q,n);this.a&&this.a()}};Common.App.SkypeChat.a=function(n,t){this.r=Function.createDelegate(this,this.s);this.j=new Common.M;this.o=n;this.q=t};Common.App.SkypeChat.a.prototype={p:null,o:null,k:null,i:null,q:null,n:null,m:!1,l:!1,b:function(n){this.j.n("ACE",n)},g:function(){if(this.k)return this.k.a;this.k=new($$sc.B.$$(Boolean));var n=this;return this.o.CW(function(){n.p=n.o.a();n.i=n.p.a(n.r);n.i.b();n.i.c(function(t,i){n.j.m("PSC",i,null)});n.i.d(function(t,i){n.j.m("UCC",i,null)})}),this.k.a},s:function(n,t){var i=t.a===2||t.a===4||t.a===5;this.k.a.b>3||!i||this.k.f(!0);this.l=this.m&&t.a!==2&&t.a!==5;this.m=this.m&&!this.l;this.j.m("ACE",new Common.App.SkypeChat.b(i,this.l),null)},d:function(n){this.j.n("UCC",n)},a:function(){return this.i.a()?1:0},f:function(n,t,i,r){if(!n){Diag.a.a(18200789,333,10,"Unexpected attempt to join doc chat without any chat thread info!");return}this.n=this.q.b("ServerNotification","JoinSkypeChatThreadClient");var u=this,e=function(){u.n.a();u.m=!0;u.l=!1;t()},f=this,o=function(){f.n.a();f.m=!1;f.l=!1;i()};this.n.c();this.i.k(n.a,e,o,r,n.b)},e:function(){this.i.g()},h:function(){this.i.h()},c:function(n){this.j.n("PSC",n)}};Common.App.SkypeChat.d=function(n){this.b=n};Common.App.SkypeChat.d.prototype={b:null,a:function(){return this.b.a()}};Common.App.SkypeChat.q=function(n,t){this.i=Function.createDelegate(this,this.l);this.e=n;this.f=t};Common.App.SkypeChat.q.prototype={e:null,f:null,b:null,d:null,a:function(){return this.b?this.b.a:(this.b=new($$sc.B.$$(String)),this.e.CW(this.i),this.b.a)},g:function(){return $$sc.a.a(String,"")},l:function(){var n=this.e.a(),t=this;n.a().CW(function(){n.b()===3?t.b.b(Common.a.n):n.a().a().a?t.k():t.j()})},k:function(){var n=this;this.f.CW(function(){n.d=n.f.a().a(null);n.d.b().CW(function(){n.d.f().CW(function(){n.b.b(n.d.f().a())})})})},j:function(){var n=this;this.g().CW(function(){n.b.b(n.g().a())})}};Common.App.SkypeChat.p=function(n){this.BaseDocQuerySignature=n};Common.App.SkypeChat.p.prototype={BaseDocQuerySignature:null,b:function(){return JSON.stringify([this.a(),this])}};Common.App.SkypeChat.l=function(n){Common.App.SkypeChat.l.initializeBase(this,[n])};Common.App.SkypeChat.l.prototype={a:function(){return 1}};Common.App.SkypeChat.m=function(){};Common.App.SkypeChat.m.a=function(n){if(!n)return Diag.a.a(5328905,333,10,"Response from SkypeProxy was null"),null;try{return JSON.parse(n)}catch(t){Diag.a.a(5328906,333,10,"could not parse the response of request: {0}",n.substr(0,Math.min(n.length,250)))}return null};Common.App.SkypeChat.i=function(n,t,i,r,u){this.v=Function.createDelegate(this,this.E);this.u=Function.createDelegate(this,this.D);this.w=Function.createDelegate(this,this.F);this.t=Function.createDelegate(this,this.C);this.s=Function.createDelegate(this,this.B);Common.App.SkypeChat.i.initializeBase(this);this.m=n;this.i=t;this.l=i;this.n=r;this.j=u};Common.App.SkypeChat.i.prototype={e:null,f:null,m:null,i:null,l:null,j:null,k:null,n:null,r:null,g:null,q:!1,d:function(){return Diag.a.a(9000769,333,50,"Init - RtcChatAvailabilityFinder"),$$sc.a.WAA(this.n.a(),this.m,this.l,this.j,this.i).CW(this.s)},B:function(){if(Diag.a.a(6603968,333,50,"All prerequisite ready for RtcChatAvailabilityFinder"),this.e=this.m.a(),this.k=this.l.a(),this.f=this.i.a(),this.g=this.n.a().a(),this.r=this.j.a(),this.e.h(this.t),this.e.c(this.w),this.e.s(this.u),this.e.i(this.v),!this.g&&!this.f.c()){Diag.a.a(6603969,333,10,"Email in presence context is null or undefined. This will cause Skype to not work");return}this.f.i(this.f.c()||this.g);this.G(!0);this.q=!0;this.c()},G:function(n){this.I(n);this.H(n)},I:function(n){this.f&&this.k&&(n?this.f.b().b|=4:this.f.b().b&=-5,this.k.a())},H:function(n){if(this.e){var t=this.y();t&&(t.Email=this.g,t.Capabilities=n?1:0,this.e.m(1,t))}},y:function(){var n=this.e.d(1);return n&&this.e.a()in n?n[this.e.a()]:new Common.App.SkypeChat.c("",!1,0)},C:function(){this.c()},F:function(){this.c()},D:function(){this.x()},E:function(n,t){t.a===1&&this.c()},c:function(){if(!this.q)return Diag.a.a(6603970,333,50,"Anyone to chat with was called before component was initialized"),this.p(!1),!1;if(this.e.b()!==2)return Diag.a.a(6649866,333,50,"Rtc Connection not yet established: state:{0}",this.e.b()),this.p(!1),!1;var t=this.e.e(),i=this.e.d(1),n=this.A(t)||this.z(i);return this.p(n),n},A:function(n){var i,r,u,t;if(!n)return!1;i=n;for(r in i)if(u={key:r,value:i[r]},t=this.r.a(u),t&&t.c()&&t.b()&&t.b().a(4)&&t.c()!==this.g)return!0;return!1},z:function(n){var i,r,u,t;if(!n)return!1;i=n;for(r in i)if(u={key:r,value:i[r]},t=u.value,t&&t.Email&&t.Capabilities&1&&t.Email!==this.g)return!0;return!1}};Common.App.SkypeChat.u=function(n,t,i,r,u){this.N=Function.createDelegate(this,this.bp);this.Q=Function.createDelegate(this,this.bv);this.I=Function.createDelegate(this,this.be);this.P=Function.createDelegate(this,this.bu);this.O=Function.createDelegate(this,this.bq);this.M=Function.createDelegate(this,this.bn);this.S=Function.createDelegate(this,this.by);this.R=Function.createDelegate(this,this.bx);this.K=Function.createDelegate(this,this.bh);this.U=Function.createDelegate(this,this.bA);this.L=Function.createDelegate(this,this.bi);this.V=Function.createDelegate(this,this.bC);this.J=Function.createDelegate(this,this.bf);this.T=Function.createDelegate(this,this.bz);this.c=n;this.k=i;this.i=!1;this.D=r;this.h=u;this.s=t};Common.App.SkypeChat.u.prototype={p:0,w:!1,m:!1,v:!1,i:!1,o:!1,z:!1,C:!1,y:!1,B:!1,x:!1,e:!1,j:!1,f:!1,t:!1,X:function(){return Common.a.b.a("DocChatJoinInfoFromServerIsEnabled")},W:function(){return Common.a.b.a("DocChatDiscoveryViaPersistentStateChannelIsEnabled")},E:null,k:null,n:null,r:null,D:null,h:null,A:!1,g:null,c:null,s:null,b:null,d:null,Y:function(){return this.o&&this.C},a:function(n,t){return(this.E=n,this.r=t,this.g)?this.g.a:(this.g=new($$sc.B.$$(Boolean)),!this.s)?(Diag.a.a(8730523,333,15,"docChatClient is null"),this.g.b(!1),this.g.a):(this.bg(),this.g.a)},bB:function(){Diag.a.b(5269512,333,!!this.c,null);this.c.d(Common.bc.a.b,2147483648,this.T,96);this.c.a(Common.bc.a.c,2147483648,this.J);this.X()?this.c.a(Common.bc.a.f,2147483648,this.V):this.c.a(Common.bc.a.f,2147483648,this.L);this.c.d(Common.bc.a.d,2147483648,this.U,96);this.c.a(3799468329,2147483648,this.K)},bg:function(){this.b=this.s.a();var n=this.b.g(),t=this;n.CW(function(){var i=n.a();t.bt(i);t.g.b(i)})},by:function(n,t){this.p=t.a;this.l()},bx:function(){this.l();this.w=this.w||this.b.a()===1;this.bk()},bk:function(){this.z&&this.b.a()===1&&!this.A&&(Diag.a.a(6129288,333,50,"Doc chat started and pane toggled"),this.A=!0)},bb:function(){!this.x&&this.o&&(Diag.a.a(37597725,333,15,"Doc chat is available"),this.x=!0)},be:function(n,t){this.o=t.a();this.bb();this.l()},bt:function(n){var t,i;if(!n){Diag.a.a(9000770,333,10,"Doc chat client not ready");return}this.bB();this.i=!0;this.b.c(this.R);this.b.d(this.S);this.b.b(this.M);this.k&&(t=this,this.k.CW(function(){t.bw()}));this.h&&(i=this,this.h.d().CW(function(){i.bm()}));this.bc(!0,!1)},bn:function(n,t){this.bc(t.b,t.c)},bc:function(n,t){this.C=n;this.f=this.e&&t;this.e=this.e&&!this.f;this.l()},bw:function(){this.n=this.k.a();this.n.b(this.O);this.W()&&this.n.a(this.P);this.n.c()},bm:function(){Diag.a.a(9000771,333,50,"AvailabilityFinder ready");this.h.a(this.I);this.h.b(this.Q);this.o=this.h.c();this.bb();this.l()},bz:function(n,t,i,r,u){var f=u,e=this.bE();return f[CommandUI.Controls.e.Visible]=e,this.bD(f),this.bj(e),32},bD:function(n){this.r.c()&&(n.On=this.b.a()===1,Common.a.a().a().a()?n[CommandUI.t.Icon]=Common.a.a().a().O()?this.p>0?"DocChatUnreadGray_16":"DocChat_20":this.p>0?"DocChatUnread_20":"DocChatGlyph_20":n[CommandUI.Controls.e.Image16by16Class]=Common.A.b(this.p>0?Common.bc.a.g:Common.bc.a.e))},bj:function(n){n&&!this.v&&(Diag.a.a(6350045,333,15,"Setting visibility of the chat button to true"),this.v=!0)},bE:function(){return this.Y()||!!this.d},bq:function(n,t){this.c.b(2246375352,2,t.a,null)},bu:function(){this.X()&&this.c.b(2246375352,2,null,null)},bi:function(n,t,i,r,u){if(i!==2)return 32;if(this.G(),!this.i)return Diag.a.a(16808076,333,15,"Join operation before client is ready"),this.q(),8;var f=u;return f?this.j||this.e?(Diag.a.a(18900674,333,50,String.format("Ignoring chat thread {0}. Already connecting or connected to it.",f.a)),32):((!this.d||this.f)&&(Diag.a.a(18900675,333,50,String.format("Co-authors sent chat thread {0} and we're not connected to it...attempt to connect.",f.a)),this.F(f,!1)),32):(Diag.a.a(18493662,333,10,"Invalid ChatThreadInfo."),this.q(),8)},bC:function(n,t,i){return i!==2?32:(this.G(),!this.i)?(Diag.a.a(21550145,333,15,"Join operation before client is ready"),this.q(),8):this.m||this.j?(Diag.a.a(22045828,333,50,"Ignoring coauthors' InChat flag. Already retrieving the chat info or connecting to doc chat."),1):this.e?(Diag.a.a(21550146,333,50,"Ignoring coauthors' InChat flag. Already connected to doc chat."),32):((!this.d||this.f)&&(Diag.a.a(21550147,333,50,"Co-authors sent InChat flag and we're not connected to the Doc Chat...attempt to connect."),this.Z(!1)),32)},bv:function(){this.j||this.e||this.d&&this.f&&(Diag.a.a(18900676,333,50,String.format("User is active but disconnected from doc chat. Attempting to reconnect to chat thread {0}...",this.d.a)),this.c.b(2246375352,2,this.d,null))},ba:function(n){this.j=!0;this.e=!1;this.f=!1;var t=this;this.b.f(this.d,this.N,function(){t.bo(n)},this.E)},bp:function(){this.j=!1;this.e=!0;Diag.a.a(5616863,333,50,"Join operation was successful")},bo:function(n){if(this.t){this.t=!1;Diag.a.a(38088785,333,15,"Join operation failed, retrying.");this.ba(n);return}this.j=!1;n&&this.H();Diag.a.a(5616860,333,10,"Join operation failed even after retrying.")},bh:function(){return this.e&&!this.f?32:8},bl:function(){var n=this;this.k.CW(function(){var t=n.k.a();t.e(n.d);n.W()&&n.n.d()})},F:function(n,t){if(!n){Diag.a.a(18419974,333,10,"Unexpected attempt to get on the doc chat without any chat thread info!");return}this.d=n;t&&this.b.h();this.ba(t);this.bl()},bf:function(n,t,i){if(i===2){if(this.G(),!this.i)return this.q(),8;if(this.m)return 1;this.z=!0;this.t=!0;this.Y()&&!this.d?this.Z(!0):this.bF()?this.b.e():this.F(this.d,!0)}return this.i?32:8},Z:function(n){Diag.a.a(5616864,333,50,"Trying to create a new thread");this.m=!0;var t=this,i=this;this.D.e(function(i){t.bs(i,n)},function(t){i.br(t,n)})},bs:function(n,t){var r,u,i;Diag.a.a(5616865,333,50,"Thread created successfully");r=!1;n.b?(u=n.b.b,u?(i=Common.App.SkypeChat.m.a(u),i&&i.Success?(Diag.a.a(5328903,333,50,"Created ChatThreadId is :{0}",i.ThreadId),this.F(new Common.eb(i.ThreadId,i.DiscoveryUri),t),r=!0):Diag.a.a(5616866,333,10,"Could not parse the response, parsed response is null or create thread operation failed.")):Diag.a.a(5328902,333,10,"ResponseData is null")):Diag.a.a(5328901,333,10,"e.Data is null");t&&!r&&this.H();this.m=!1},H:function(){this.q();this.bG()},q:function(){this.y||(this.y=!0,Diag.a.a(36705359,333,15,"Bad user interaction with doc chat."))},G:function(){this.B||(this.B=!0,Diag.a.a(36705360,333,15,"Usage of doc chat"))},bG:function(){},br:function(n,t){this.m=!1;t&&this.H();Diag.a.a(5328904,333,15,"Try to create thread for this user failed")},bA:function(){return this.l(),32},bF:function(){return this.r.c()&&this.b.a()===1}};Common.App.SkypeChat.k=function(n,t,i,r){this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.C);this.q=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.y);Common.App.SkypeChat.k.initializeBase(this);Diag.a.a(5895065,333,50,"Initializing chat notifier");this.f=n;this.g=i;this.j=t;this.l=r};Common.App.SkypeChat.k.prototype={f:null,h:null,j:null,g:null,k:null,o:!1,l:null,n:null,m:!1,c:function(){return $$sc.a.WAA.call(null,this.l,this.f,this.g).CW(this.p)},y:function(){Diag.a.a(6603971,333,50,"All prerequisite ready for SkypeChatNotifier");this.n=this.l.a();this.k=this.g.a();this.h=this.f.a();this.v(this.h.e());this.u(this.h.d(1));Diag.a.a(5898719,333,50,"Subscribing to presence updates");this.h.c(this.r);this.h.i(this.q)},A:function(n,t){this.k&&(this.o||(this.o=!0,Diag.a.a(6555618,333,50,"SkypeChat complemented recorded presence update")),this.v(t.b))},v:function(n){var u=n,r,f,t,i;for(r in u)if((f={key:r,value:u[r]},t=this.n.a(f),t)&&(i=t.e(),i&&t.a()!==this.k.a())){Diag.a.a(5895069,333,50,String.format("Chat thread id found : {0}",i));this.w(new Common.eb(i,t.d()));return}},z:function(n,t){t.a===1&&(this.m||(this.m=!0,Diag.a.a(21803734,333,50,"SkypeChat recorded persistent state update")),this.u(t.b))},u:function(n){var u=n,t,i,r;for(t in u)if((i={key:t,value:u[t]},r=i.value,r)&&r.InChat&&i.key!==this.h.a()){Diag.a.a(21803735,333,50,"User found in chat");this.x();return}},e:function(n){return this.j.CWO(this.t,n)},d:function(){return this.f.CW(this.s)},C:function(n,t){var i=this;$$sc.a.WAA(this.g,this.j).CW(function(){i.g.a().h(t.a);i.g.a().g(t.b);Diag.a.a(5898752,333,50,"Re-sending the latest presence with the chatThreadId:{0}, chatThreaddiscoveryUri:{1}",i.g.a().e(),i.g.a().d());i.j.a().a()})},B:function(){var n=this;$$sc.a.WAA(this.f).CW(function(){var t,i=n.f.a().d(1);t=i&&n.f.a().a()in i?i[n.f.a().a()]:new Common.App.SkypeChat.c("",!1,0);t.InChat=!0;Diag.a.a(21803737,333,50,"Re-sending the latest persistent state");n.f.a().m(1,t)})}};Common.App.SkypeChat.j=function(){};Common.App.SkypeChat.j.a=function(){Common.App.a.a().a(new Common.App.SkypeChat.j,0,!1)};Common.App.SkypeChat.j.prototype={a:function(){return"Common.App.SkypeChat"},c:function(n){var i=this,t;n.b(Common.App.SkypeChat.a).a().b(function(){return new Common.App.SkypeChat.a(Common.Utils.b.a(Common.App.BasicChat.b,n.c(Common.App.BasicChat.b)),Common.a.a().c())});t=this;n.b(Common.App.SkypeChat.d).c(Common.App.SkypeChat.e).a().b(function(){return new Common.App.SkypeChat.d(new($$sc.w.$$(Common.App.SkypeChat.a))(function(){return n.a(Common.App.SkypeChat.a)}))})},b:function(){}};Common.App.SkypeChat.c.registerClass("Common.App.SkypeChat.c");Common.App.SkypeChat.w.registerClass("Common.App.SkypeChat.w");Common.App.SkypeChat.n.registerClass("Common.App.SkypeChat.n",null,Common.App.SkypeChat.s);Common.App.SkypeChat.o.registerClass("Common.App.SkypeChat.o",null,Common.fC);Common.App.SkypeChat.b.registerClass("Common.App.SkypeChat.b",Sys.EventArgs,Common.App.SkypeChat.r);Common.App.SkypeChat.a.registerClass("Common.App.SkypeChat.a",null,Common.App.SkypeChat.t);Common.App.SkypeChat.d.registerClass("Common.App.SkypeChat.d",null,Common.App.SkypeChat.e);Common.App.SkypeChat.q.registerClass("Common.App.SkypeChat.q",null,Common.App.SkypeChat.f);Common.App.SkypeChat.p.registerClass("Common.App.SkypeChat.p");Common.App.SkypeChat.l.registerClass("Common.App.SkypeChat.l",Common.App.SkypeChat.p);Common.App.SkypeChat.i.registerClass("Common.App.SkypeChat.i",Common.App.SkypeChat.n);Common.App.SkypeChat.u.registerClass("Common.App.SkypeChat.u",null,Common.App.SkypeChat.h);Common.App.SkypeChat.k.registerClass("Common.App.SkypeChat.k",Common.App.SkypeChat.o);Common.App.SkypeChat.j.a();Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.f=function(){};RealtimePresenceUI.f.registerInterface("RealtimePresenceUI.f");RealtimePresenceUI.b=function(n,t){this.a=n;this.g=t;this.q=new Common.ck(this.a.c,"Anonymous user","#cccccc",new Common.co(7),null,null,null,null,!1,!1,!1,0);this.f=!0;this.e=!0;this.c=RealtimePresenceUI.e.a(this.a.c,this.a.b,n.e)};RealtimePresenceUI.b.a=function(n,t){var i=n,r=t;return i.k.a(1)&&r.k.a(1)||!i.k.a(1)&&!r.k.a(1)?Common.d.N(n.l,t.l):i.k.a(1)?-1:1};RealtimePresenceUI.b.prototype={q:null,f:!1,a:null,c:null,g:null,e:!1,I:function(){return Common.a.b?Common.a.b.a("ColorPresenceHashIsEnabled"):!1},K:function(n,t,i,r,u,f){var e,o,s,h,c=this.L();this.c.a()?this.c.a()===1?(e=!0,o=this.a.a.b.a,s=this.a.a.b.b,h=this.c.b()[0].n):(e=!0,o=this.a.a.i.a,s=this.a.a.i.b,h=""):(e=!1,o="",s="",h="");n.val=c[0];t.val=c.slice(1);i.val=e;r.val=o;u.val=s;f.val=h},L:function(){if(this.c.a()>=2)return[String.format($a.ed,this.c.a())];if(this.c.a()===1){var n=this.c.b()[0],t=this.a.b(n.j);return t&&t.a===2?[$a.eg,n.l]:[n.q?$a.ef:$a.ee,n.l]}return[$a.eh]},T:function(n){return this.U(n)},H:function(n,t,i){if(!t)return i&&Diag.a.a(4482393,325,50,"User does not have any presence data"),!1;if(!this.r(n,t))return i&&Diag.a.a(4482394,325,50,"User has presence data but app can't use it"),!1;var r=this.a.b(n);return r&&r.a===2?!1:!0},O:function(n){return n.q?$a.ek:$a.ei},U:function(n){if(!n.k.a(1))return this.O(n);var t=n.q,i=this.a.b(n.j),r=this.a.d(n.j);if(!i)return t?$a.j:$a.i;switch(i.a){case 1:return r?this.s(n.j,t,r)||(t?$a.j:$a.i):t?$a.j:$a.i;case 2:return $a.ej;default:return t?$a.j:$a.i}},Q:function(n){var t=this.a.b(n.j);return t&&t.a===2?"#cccccc":n.n},N:function(n){return this.g.e(n.m,"O365",Common.a.k,0)},P:function(n){var t=this.a.b(n.j);return t&&t.a===1?!0:!1},R:function(n){var s=String.format("buttonPeoplesWellUser-{0}",n.j),r=n.j,h=this.T(n),u=n.l,c=this.Q(n),t,i=(t=new Common.bM,t.Id=s,t.Command=this.a.a.e.toString(),t.LabelText="{0}",t.Image32by32=this.a.a.j.a,t.Image32by32Class=this.a.a.j.b,t.MenuItemId=r,t.CommandValueId=r,t.Alt=u,t.DisplayMode=this.o(),t.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",t.Description=h,t.ImageBackColor=c,t.LabelTextUserGeneratedPlaceholderReplacements=CommandUI.b.w([u]),t),f,e,o;return Common.a.b.a("PeoplesWellExtraButtonInfoIsEnabled")&&this.g&&(f=this.N(n),e=this.P(n),i.ImageUrl=f,i.ActiveStatus=e,o=n.r,i.JoinTimeInMS=o),i},M:function(){var n;return n=new Common.bM,n.Id="BasicChat",n.Command="2288458806",n.LabelText=$a.fd,n.Image32by32=this.a.a.h.a,n.Image32by32Class=this.a.a.h.b,n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",n},o:function(){return this.I()?"Initials":"Menu32"},S:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t)u=r[t],f=this.R(u),Array.add(i,f);return i},V:function(){return this.c.a()>0},X:function(n){if(!this.f)return!0;this.e||(n[CommandUI.Controls.d.Visible]=!0);var i,t,r,e,u,f,o,s,h,c,l,a;return this.K(o={val:i},s={val:t},h={val:r},c={val:e},l={val:u},a={val:f}),i=o.val,t=s.val,r=h.val,e=c.val,u=l.val,f=a.val,n[CommandUI.Controls.d.LabelText]=i,t&&t.length&&(n[CommandUI.Controls.d.LabelTextUserGeneratedPlaceholderReplacements]=t),n.ImageIsVisible=r,n[CommandUI.Controls.d.Image16by16Class]=u,n.ImageBackColor=f,this.f=!1,!0},W:function(n){var e,i,o;if(this.c.a()<=0)return!1;var s=this.bb(this.c.b()),h=this.S(s),r,u=(r=new Common.dJ,r.Id="menuCoauthors",r.MaxWidth="220px",r.MenuSectionList=[],r),t,f=(t=new Common.ci,t.Id="msCoauthors",t.ControlsId="msCoauthorsControls",t.DisplayMode=this.o(),t.ControlList=h,t);return Common.a.b.a("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.g&&(f.Title=$a.ec,f.TitleId="menuCoauthorsTitle",f.Theme="Light"),Array.add(u.MenuSectionList,f),Common.a.b.a("DocChatIsEnabled")&&Common.a.b.a("PeoplesWellExtraButtonInfoIsEnabled")&&(e=[],Array.add(e,this.M()),o=(i=new Common.ci,i.Id="msGroupChat",i.ControlsId="msGroupChatControl",i.DisplayMode=this.o(),i.ControlList=e,i),Array.add(u.MenuSectionList,o)),Common.a.a()&&Common.a.a().a().a()?n.MenuItems=u:n.PopulationXML=Common.u.j(u),!0},bc:function(n){var t,i;return(Diag.a.a(4482395,325,50,"PeoplesWell: Received user button click"),t=n.MenuItemId,!t)?!1:(i=this.a.d(t),!this.H(t,i,!0))?!1:(this.u(t,i),!0)},Y:function(){var n=this.J();this.c.c(n);this.e&&this.c.a()>=1&&(Diag.a.a(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.e=!1);this.f=!0},J:function(){var n=null,r;n||(n=this.t()||[]);for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.ba(r);return n},ba:function(n){n.j||(n.j=Common.P.a().a);n.l||(n.l="Anonymous user");n.k||(n.k=new Common.co(0));n.n||(n.n="#cccccc");n.r||(n.r=0)},bb:function(n){var t=[];return Array.addRange(t,n),t.sort(RealtimePresenceUI.b.a),t},Z:function(){this.w();this.p()},p:function(){this.Y();this.v()},dispose:function(){}};RealtimePresenceUI.a=function(n,t,i,r,u){var f,e;this.a=n;this.c=t;this.e=u;f=this;this.d=i||function(){return null};e=this;this.b=r||function(){return null}};RealtimePresenceUI.a.a=function(n,t,i,r){if(!i)return new RealtimePresenceUI.a(n,t,null,null,r);var u=i,f=i;return new RealtimePresenceUI.a(n,t,u.f||(u.f=Function.createDelegate(u,u.p)),f.g||(f.g=Function.createDelegate(f,f.q)),r)};RealtimePresenceUI.a.prototype={a:null,c:null,d:null,b:null,e:!1};RealtimePresenceUI.g=function(n){this.d=new($$sc.t.$$(Array));this.e=n};RealtimePresenceUI.g.prototype={e:null,f:null,c:function(n){var i,u;this.k();for(var f=n,o=f.length,t=0;t<o;++t)if(i=f[t],i.j===this.e){this.f=i;break}for(var e=n,s=e.length,r=0;r<s;++r)(u=e[r],u.j!==this.e)&&this.h(u)},b:function(){for(var n=new Array(0),t=this.d.k().$$ge(),i,r;t.$$mn();)i=t.$$cu(),r=this.j(i),Array.add(n,r);return n},a:function(){return this.d.h},i:function(n,t){n=n.toUpperCase();var i,r,u;(u=this.d.e(n,r={val:i}),i=r.val,u)||(i=new Array(0),this.d.b(n,i));Array.add(i,t)},k:function(){this.d=new($$sc.t.$$(Array))}};RealtimePresenceUI.e=function(){};RealtimePresenceUI.e.a=function(n,t,i){return i?new RealtimePresenceUI.c(n,t):new RealtimePresenceUI.d(n)};RealtimePresenceUI.c=function(n,t){RealtimePresenceUI.c.initializeBase(this,[n]);this.g=t};RealtimePresenceUI.c.prototype={g:null,h:function(n){if(n.t||!n.m){this.i(n.j,n);return}this.f&&$$sc.g.a().a(this.f.m,n.m)||this.i(n.m,n)},j:function(n){for(var r,t,u=new Date(0),f=n.length>0?n[0]:null,e=n,o=e.length,i=0;i<o;++i)(r=e[i],t=this.g(r.j),t)&&u.getTime()<t.b.getTime()&&(u=t.b,f=r);return f}};RealtimePresenceUI.d=function(n){RealtimePresenceUI.d.initializeBase(this,[n])};RealtimePresenceUI.d.prototype={h:function(n){this.i(n.j,n)},j:function(n){return n[0]}};RealtimePresenceUI.b.registerClass("RealtimePresenceUI.b",null,Sys.IDisposable);RealtimePresenceUI.g.registerClass("RealtimePresenceUI.g");RealtimePresenceUI.c.registerClass("RealtimePresenceUI.c",RealtimePresenceUI.g);RealtimePresenceUI.d.registerClass("RealtimePresenceUI.d",RealtimePresenceUI.g);Type.registerNamespace("_Ewa");_Ewa.KE=function(){};_Ewa.KE.registerInterface("_Ewa.KE");_Ewa.KF=function(){};_Ewa.KF.registerInterface("_Ewa.KF");_Ewa.Aj=function(n,t,i){this.a(null);this.d=n;this.g=t;this.h=i;this.e=new _Ewa.lR(_Ewa.c.a(this.g),this.d.User.UserID,this.d.User.UserName,this.d.UserColor,null,i)};_Ewa.Aj.prototype={g:null,e:null,d:null,h:null,f:null,a:function(n){return this.f=n,this.f&&this.h.F(this.f.bI()),n},i:null,dispose:function(){this.l();System.a.a(this.e);this.a(null);this.d=null;this.g=null;this.i=null},k:function(n){this.e.K(n.e)},l:function(){this.f&&this.d&&this.d.User&&(this.f.bh(!1,this.d.User.UserID,null),this.e.m(!0))},b:function(){this.f&&this.d&&this.d.User&&(this.f.bh(!0,this.d.User.UserID,this.d.UserColor),this.e.t())},j:function(n){this.e.r(n);this.e.e(n,!0)},c:function(n,t){this.e.L(null,t?19:18,n)}};_Ewa.lQ=function(){_Ewa.lQ.initializeBase(this,[!1])};_Ewa.lQ.a=function(n,t){var i=n.b.d();System.a.b(n.d());System.a.b([n.b]);n.b=null;n.b=new _Ewa.qS(t);n.p([]);n.y(t);n.q(i)};_Ewa.lQ.prototype={b:null,m:null,d:function(){return this.m},p:function(n){return this.m=n,n},n:null,h:function(){return this.n},y:function(n){return this.n=n,n},a:function(){return this.b.d()},q:function(n){return this.b.e(n),n},x:function(){},f:function(){return null},o:function(){return null},i:function(){},j:function(){},z:function(){}};_Ewa.hj=function(n,t){var i,r,u;for(this.t=Function.createDelegate(this,this.y),this.o=Function.createDelegate(this,this.w),this.s=Function.createDelegate(this,this.x),this.q=[!1,!1,!1,!1],this.m=[null,null,null,null],_Ewa.hj.initializeBase(this,[!1]),this.n=n,this.v=n.d(),i=0;i<4;i++)r=t.b(document.createElement("div")),u=n.k(_Ewa.hj.b()[i]).i(),u.insertBefore(r.e(),u.firstChild),r.c(this.s),this.m[i]=r};_Ewa.hj.b=function(){return _Ewa.hj.a||(_Ewa.hj.a=[1,3,2,4])};_Ewa.hj.prototype={n:null,v:!1,p:null,r:!1,c:function(n){this.cP("interactivityChanged",n)},b:function(n){this.cR("interactivityChanged",n)},e:function(){return null},f:function(){return this.m[0].f()},dispose:function(){if(this.m){this.g();for(var n=0;n<4;n++)this.m[n].b(this.s),this.m[n].dispose()}this.n=null;this.m=null;_Ewa.cn.prototype.dispose.call(this)},k:function(){for(var n=0;n<4;n++)this.m[n].k()},j:function(){this.u();for(var n=0;n<4;n++)this.m[n].j()},g:function(){this.z();for(var n=0;n<4;n++)this.m[n].g()},a:function(n){for(var t=0;t<4;t++)this.m[t].a(n)},i:function(n){for(var t=0;t<4;t++)this.m[t].i(n)},h:function(n,t){for(var i=0;i<4;i++)if(this.m[i].h(n,t))return!0;return!1},d:function(n){for(var t=0;t<4;t++)if(this.m[t].d(n))return!0;return!1},l:function(n,t){for(var i=0;i<4;i++){var f=_Ewa.hj.b()[i],u=this.n.k(f),r=_Ewa.qR.a(u,new Sys.UI.Point(n,t),!1);r.x<0&&(this.p=new Sys.UI.Point(n,t),r.x+=u.i().scrollLeft);_Ewa.a.t(this.m[i].e(),r.x,r.y,!1,this.v)}},x:function(n,t){var r,u,i;if(t.a===1)this.cN("interactivityChanged",t,null);else{for(r=!1,u=-1,i=0;i<4;i++)this.m[i]===n?u=i:r=!!(r|this.q[i]);t.a===2?(this.q[u]=!0,r||(this.j(),this.cN("interactivityChanged",t,null))):t.a===3?(this.q[u]=!1,r||this.cN("interactivityChanged",t,null)):this.cN("interactivityChanged",t,null)}},w:function(){this.u()},y:function(){this.u()},u:function(){this.p&&(this.l(this.p.x,this.p.y),this.r||(this.r=!0,this.n.c().f(this.o),this.n.c().b(this.o),this.n.g().d(this.t)))},z:function(){this.r&&(this.n.c().g(this.o),this.n.c().a(this.o),this.n.g().c(this.t))}};_Ewa.lR=function(n,t,i,r,u,f){this.G=Function.createDelegate(this,this.O);this.H=Function.createDelegate(this,this.P);this.I=Function.createDelegate(this,this.Q);this.F=Function.createDelegate(this,this.N);this.u={};_Ewa.lR.initializeBase(this,[!1]);this.z=n;this.D=new Common.ck(t,i,r,new Common.co(0),null,null,null,null,!1,!1,!1,0);this.E=t;this.C=u;this.y=f};_Ewa.lR.a=function(n,t){return n.toString()+t.toString()};_Ewa.lR.prototype={A:null,C:null,J:0,z:null,y:null,w:null,B:null,i:function(n){this.cP("hidePresenceTooltip",n)},n:function(n){this.cR("hidePresenceTooltip",n)},k:function(n){this.cP("showPresenceTooltip",n)},q:function(n){this.cR("showPresenceTooltip",n)},j:function(n){this.cP("showFullPresenceTooltip",n)},p:function(n){this.cR("showFullPresenceTooltip",n)},g:function(n){this.cP("presenceChanged",n)},o:function(n){this.cR("presenceChanged",n)},E:null,b:function(){return this.E},D:null,a:function(){return this.D},v:0,d:function(){return this.v},h:function(){return this.A||this.B?_Ewa.qR.a(this.z.k(this.v),this.x(this.v).h(),!0):null},c:function(){return this.x(this.v).c()},r:function(n){var i=this.u,t,r;for(t in i)r={key:t,value:i[t]},r.value.r(n);return n},dispose:function(){var t,i,r,n;this.cN("hidePresenceTooltip",null,null);this.cN("presenceChanged",null,null);this.y&&this.y.D(this.E);t=this.u;for(i in t)r={key:i,value:t[i]},n=r.value,n.n(this.F),n.q(this.I),n.p(this.H),n.o(this.G),n.dispose();this.u=null;this.z=null;this.C=null;this.A=null;this.y=null;_Ewa.cn.prototype.dispose.call(this)},L:function(n,t,i){n?(this.A=_Ewa.i.b(n),this.v=this.z.h().b(this.A.G())):i?(this.B=i,this.v=i.d().v()):this.v=1;this.J=t;this.x(this.v);this.s(n,i)},s:function(n,t){var r=this.u,i,u;for(i in r)u={key:i,value:r[i]},u.value.s(n,t)},m:function(n){var t,i,r;this.x(this.v).m(n);t=this.u;for(i in t)r={key:i,value:t[i]},r.value.m(!1)},K:function(n){var r=this.u,t,u,i;for(t in r)u={key:t,value:r[t]},i=u.value,i.l(n.x(i.d()))},l:function(n){this.x(n.d()).l(n)},e:function(n,t){var i,r,u;this.y.n(this);this.x(this.v).e(n,t);i=this.u;for(r in i)u={key:r,value:i[r]},u.value.e(n,!1)},f:function(n){var i=this.u,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},t:function(){var t=this.u,n,i;for(n in t)i={key:n,value:t[n]},i.value.t();this.y.n(this)},x:function(n){return this.M(n,this.J)},M:function(n,t){var u=this.C?this.C.g(t,n,0).a:this.B?this.B.Y():null,r=_Ewa.lR.a(t,n),i=_Ewa.s.a(this.u,r,null);return i||(i=new _Ewa.Ao(u,this.z,this.D,n),this.u[r]=i,i.i(this.F),i.k(this.I),i.j(this.H),i.g(this.G)),i},N:function(n){this.w&&this.w!==n||(this.w=null,this.m(!1));this.cN("hidePresenceTooltip",null,null)},Q:function(n){this.w&&this.w!==n||(this.w=null,this.e(!0,!1));this.cN("showPresenceTooltip",null,null)},P:function(n){this.w||this.cN("showFullPresenceTooltip",null,null);this.w=n},O:function(){this.m(!1);this.cN("presenceChanged",null,null)}};_Ewa.dF=function(n,t,i){this.r=Function.createDelegate(this,this.bK);_Ewa.dF.initializeBase(this,[n.User.UserID,t,_Ewa.c.a(t),!0]);_Ewa.dF.a||(_Ewa.dF.a={});this.b=n;this.a=new _Ewa.lR(this.s,this.b.User.UserID,this.b.User.UserName,this.b.UserColor,this,i);this.o(this.r)};_Ewa.dF.c=function(){return _Ewa.dF.b||(_Ewa.dF.b=[18,19])};_Ewa.dF.prototype={b:null,n:18,d:!1,c:!1,a:null,k:function(){return _Ewa.dF.c()},E:function(){return _Ewa.dF.c()},dispose:function(){var t,i,r,n;this.m(this.r);System.a.a(this.a);_Ewa.lq.prototype.dispose.call(this);t=_Ewa.dF.a;for(i in t)r={key:i,value:t[i]},n=r.value,n&&!n.children.length&&(_Ewa.a.g(n),_Ewa.dF.a[r.key]=null)},T:function(n){this.a.K(n.a)},bq:function(n){this.c||(this.a.r(n),this.a.e(n,!0));this.d=n&&this.c},bb:function(n,t){this.a.L(n,t?19:18,null);this.d=!1},bL:function(n){this.n=n;this.S([n],null,null)},bI:function(n){this.bJ();this.x([n])},O:function(n,t,i){var u,e,r,f;i.className="ewr-cell-presence-highlight-all";i.style.borderColor=this.b.UserColor;u=document.createElement("div");n!==18&&(u.style.backgroundColor=this.b.UserColor);i.appendChild(u);e=["ewr-cell-presence-highlight-fill","ewr-cell-presence-highlight-edit"];u.className=e[n-18];r=_Ewa.s.a(_Ewa.dF.a,t.toString(),null);r||(f=this.s.k(t).i(),r=document.createElement("div"),f.insertBefore(r,f.firstChild),_Ewa.dF.a[t.toString()]=r);r.appendChild(i)},bh:function(n,t,i){var u,e;if(this.c=!0,u=[],n.b===19)e=new Common.bt(n.a),e.b(0,1),Array.add(u,e);else if(n.b===18){var o=new Common.by(n.a),s=new Common.cF(n.a),f=n.a.style,r=this.bo(t,n.b,n);r.a.a!==i.a.a&&o.o(parseInt(f[this.s.bf()]),r.a.a,this.s.d());r.a.b!==i.a.b&&o.c(parseInt(f.top),r.a.b);r.c()!==i.c()&&s.n(parseInt(f.width),r.c());r.d()!==i.d()&&s.y(parseInt(f.height),r.d());Array.add(u,o);Array.add(u,s)}return u},R:function(){},N:function(n,t){var r=[],u,i;return n===19&&(u=this.g(n,t,0),i=new Common.bU(u.a),i.b(1,0),Array.add(r,i)),r},z:function(n,t,i){return _Ewa.lq.prototype.z.call(this,n,t,i)?n===19&&!(Common.c.d()||i===t.h)||n===18&&i&&t.h&&!this.A:!1},G:function(){return!0},Q:function(){return null},J:function(n,t,i,r){var u=this.bo(r,n,t);_Ewa.ch.a(i,this.s.d(),u.a.a+"px");i.width=u.c()+"px";i.top=u.a.b+"px";i.height=u.d()+"px";this.bp(n,t)},bk:function(n){return n!==18},bo:function(n,t,i){var r=n.a.b+this.w(i,!1),u=n.a.a+this.w(i,!0)+_Ewa.L.i(i.a.parentNode.parentNode,this.s.d()),f=n.c(),e=n.d()+1;return u<1&&u>=-1&&t===18&&(f-=1-u,u=1),r<1&&r>=-1&&t===18&&(e-=1-r,r=1),f=Math.max(0,f-1),e=Math.max(0,e-2),new _Ewa.I(u,r,f,e)},bp:function(n,t){var i=t.a,r=i.parentNode;r.removeChild(i);r.appendChild(i);n!==this.n&&this.a.m(!0);this.a.t();this.n=n;this.c=!1;this.d&&this.bq(!0);this.d=!1},bJ:function(){this.c||(this.a.m(!0),this.d=!1)},bK:function(n,t){this.bp(t.a,t.d)}};_Ewa.hk=function(n){this.l=Function.createDelegate(this,this.B);this.m=Function.createDelegate(this,this.C);this.g=Function.createDelegate(this,this.z);this.j=Function.createDelegate(this,this.y);this.f=Function.createDelegate(this,this.x);this.k=Function.createDelegate(this,this.A);this.a=_Ewa.c.a(n);this.d=n;this.e={};this.b={};this.c={};this.d.e()&&this.d.e().b(this.k);this.p()};_Ewa.hk.a=function(n,t){n.i(t);n.f().length||n.g()};_Ewa.hk.b=function(n,t){return n.x.toString()+"-"+n.y.toString()+"-"+t.toString()};_Ewa.hk.prototype={e:null,c:null,b:null,h:!1,a:null,d:null,i:null,dispose:function(){this.t();this.o();this.d&&this.d.e()&&this.d.e().d(this.k);this.a=null},t:function(){this.h&&(this.a.c().g(this.f),this.a.c().a(this.f),this.a.g().c(this.j),this.h=!1)},D:function(n){var t=this.c[n],i=this.b[n];t&&this.r(t);i&&_Ewa.hk.a(i,t.a().j);this.b[n]=null;this.c[n]=null},n:function(n){var u=n.c(),r=n.b(),f=this.c[r],t,i;f||this.w(n);t=this.q(n.h(),n.d());i=this.b[r];t&&t!==i&&(n.f(t),this.b[r]=t,this.c[r]=n);i!==t&&i&&_Ewa.hk.a(i,n.a().j);u&&!this.h&&this.a&&(this.a.c().f(this.f),this.a.c().b(this.f),this.a.g().d(this.j),this.h=!0)},r:function(n){n&&(n.n(this.g),n.q(this.m),n.p(this.l),n.o(this.g),n.f(null))},w:function(n){n.i(this.g);n.k(this.m);n.j(this.l);n.g(this.g)},z:function(n){var t=n,i=this.b[t.b()];i&&_Ewa.hk.a(i,t.a().j)},C:function(n){this.s(!1,n)},B:function(n){this.s(!0,n)},s:function(n,t){t.c()||this.n(t);var i=this.b[t.b()];i&&(i.a(t.a()),n?i.j():i.k())},q:function(n,t){if(!n)return null;var r=this.v(n,t),u=_Ewa.hk.b(r,t).toString(),i=_Ewa.s.a(this.e,u,null);return i||(i=new _Ewa.hj(this.a,this.i),i.l(r.x,r.y),this.e[u]=i),i},v:function(n,t){var f=this.a.g().a(),i=this.a.k(t).r(),r=_Ewa.dl.a(t,f.a),e=Math.max(i.a,n.x-18),u;return e=Math.min(Math.max(r.a+i.a,e),r.a+i.a+f.c()-16),u=Math.max(i.b,n.y-15),u=Math.min(Math.max(r.b+i.b,u),r.b+i.b+f.d()-16),new Sys.UI.Point(e,u)},o:function(){var r=this.c,n,u,t,i,f;for(n in r)u={key:n,value:r[n]},this.r(u.value);t=this.e;for(i in t)f={key:i,value:t[i]},f.value.dispose();this.b={};this.c={};this.e={}},x:function(){this.u()},y:function(){this.u()},A:function(){this.p();this.o()},p:function(){var n=new Common.App.CollabControls.g;n.b(0,"ewaboot_presenceheadswhite");n.b(1,"ewaboot_presenceheads");n.b(12,49);n.b(6,16);this.a&&(n.b(4,_Ewa.p.a(3)),n.b(5,_Ewa.p.a(3)),n.b(8,this.a.d()));this.i=new Common.App.CollabControls.f(n)},E:function(n,t){var i=new Common.App.CollabControls.g;i.b(0,n?"ewaboot_presenceheadswhite":t);i.b(1,n===1?t:"ewaboot_presenceheads");i.b(12,n===12?Number.parseInvariant(t.toString()):49);i.b(6,n===6?t:16);this.a&&(i.b(4,n===4?t:_Ewa.p.a(3)),i.b(5,n===5?t:_Ewa.p.a(3)),i.b(8,n===8?t:this.a.d()));this.i=new Common.App.CollabControls.f(i)},F:function(n){this.E(12,n)},u:function(){var u=this.c,r,f,n,i,t;for(r in u)f={key:r,value:u[r]},n=f.value,n&&n.c()&&(i=this.b[n.b()],t=this.q(n.h(),n.d()),t!==i?(i&&_Ewa.hk.a(i,n.a().j),t&&(t.a(n.a()),this.b[n.b()]=t,n.f(t),n.e(!0,!0))):n.e(!0,!0))}};_Ewa.jG=function(n,t,i){this.A=Function.createDelegate(this,this.bg);this.z=Function.createDelegate(this,this.bf);this.y=Function.createDelegate(this,this.be);this.B=Function.createDelegate(this,this.bh);this.K=Function.createDelegate(this,this.bb);this.D=Function.createDelegate(this,this.bj);this.E=Function.createDelegate(this,this.bm);this.x=Function.createDelegate(this,this.bd);this.w=Function.createDelegate(this,this.bc);this.C=Function.createDelegate(this,this.bi);this.h={};_Ewa.jG.initializeBase(this,[!1]);this.p={};this.q={};this.m={};this.k={};this.g=n;this.l=t;this.i=i;this.X();this.r=new _Ewa.hk(n);this.g.e()&&this.g.e().b(this.C);this.l.c(this.w);this.l.e(this.x);n.d()&&this.g.d().i(this.E);this.j=[];this.l.a();n.a().b(_Ewa.jB,25,this);this.n=!1;this.g.J(this.D);this.o=_Ewa.v.a().b(this.K,this.I/2,!0,!1)};_Ewa.jG.a=function(n,t,i,r){var u;if(!r||!r.a()||!r.a().Object)return!1;for(var e=r.a().Object,o=e.length,f=0;f<o;++f)if(u=e[f],n&&u&&u.ObjectId&&!u.ObjectId.localeCompare(n))return Array.add(u.ObjectPresenceType===1?i:t,r.b.a.User),!0;return!1};_Ewa.jG.prototype={o:null,g:null,j:null,r:null,G:null,l:null,n:!1,t:null,I:3e4,m:null,p:null,q:null,s:!1,d:function(n){this.cP("pcek",n)},f:function(n){this.cR("pcek",n)},i:null,b:function(){return this.h},k:null,c:function(n){var t=this.h[n];t&&this.U(n,!1)},bk:function(n){this.i.b(n);this.G=n.a()},e:function(n,t,i,r){var u,f,o,e;i.val=[];r.val=[];u=this.h;for(f in u)o={key:f,value:u[f]},e=o.value,t?this.Q(_Ewa.i.a(n,this.g),i.val,r.val,e):this.P(n,i.val,r.val,e)},a:function(n,t,i,r,u){var f=this.h[u];f&&(t?this.Q(n,i,r,f):this.P(n,i,r,f))},dispose:function(){var n,t,i;if(this.bl(),this.g&&(this.g.e()&&this.g.e().d(this.C),this.g.d()&&this.g.d().k(this.E),this.g.K(this.D)),this.l&&(this.l.f(this.w),this.l.g(this.x)),this.o&&(this.o.dispose(),this.o=null),this.h){n=this.h;for(t in n)i={key:t,value:n[t]},i.value.dispose()}System.a.b([this.i,this.r]);this.N();this.i=null;this.g=null;this.h=null;Array.clear(this.j);_Ewa.cn.prototype.dispose.call(this)},bl:function(){this.i&&(this.i.m(this.B),this.i.l(this.y),this.i.n(this.z),this.i.o(this.A))},be:function(){var i=this.k,t,r,n;for(t in i)r={key:t,value:i[t]},n=r.key,this.L(n)?(this.u(n,!0),delete this.m[n],delete this.k[n]):Diag.a.a(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",n)},bh:function(n,t){var u=null,f,s,h,c,i,p,r,w,e,b,l,o,a,v,y,k,d;if(this.g.o()&&(u=this.g.o().b("ModelUpdate","PresenceRendering"),u.c()),f={},t.b){this.n||(this.J(!0),this.n=!0);s=t.b;for(h in s)(c={key:h,value:s[h]},i=c.key,this.q[i]=_Ewa.x.a().a(),p=c.value,i!==this.G)&&(r=this.h[i],r||(this.L(i)?this.u(i,!0):(i in this.k?Diag.a.a(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",i):(this.m[i]=_Ewa.x.a().a(),f[i]=1),this.k[i]=!0,w=this.Z(i),this.h[i]=this.O(w)),r=this.h[i]),r&&(r.q(p),this.V(i),this.F(r)))}if(t.a)for(e=0,b=t.a.length;e<b;e++)l=t.a[e],this.p[l]=_Ewa.x.a().a(),this.U(l,!0);(t.a&&t.a.length>0||$$sc.f.a(f).length>0||$$sc.f.a(this.k).length>0)&&(o=[],Array.addRange(o,$$sc.f.a(f)),Array.addRange(o,$$sc.f.a(this.k)),a=this.g.a().a(_Ewa.qY,287,!1),a&&a.a(o,t.a));u&&u.a();this.s=!1;v=this.h;for(y in v)if(k={key:y,value:v[y]},d=$$as(_Ewa.lQ,k.value).a().CollabMode,!d){this.s=!0;break}this.cN("pcek",t,null)},bm:function(n,t){t&&this.g.b().o()&&(t.a.HasAnyNonOcsCoauthor=this.s)},O:function(n){return new _Ewa.jH(n,this.g,this.r)},L:function(n){var t=this.g.b().be(n),i;return t&&(n in this.h?this.h[n].z(t):(i=this.O(t),this.h[n]=i,this.F(i))),!!t},Q:function(n,t,i,r){var u,e;if(n){if(u=_Ewa.fe.a(n,this.g,1),u&&_Ewa.jG.a(u.k,t,i,r))return;if(u=_Ewa.fe.a(n,this.g,2),u&&_Ewa.jG.a(u.k,t,i,r))return}if(r.a().SelectedRange)for(var o=r.a().SelectedRange,s=o.length,f=0;f<s;++f)if(e=o[f],e&&n&&_Ewa.fe.b(n,e)){Array.add(r.a().PresenceType===1?i:t,r.b.a.User);return}},P:function(n,t,i,r){n&&_Ewa.jG.a(this.Y(n),t,i,r)},Y:function(n){if(n)switch(n.a){case 0:var t=this.g.k().bj(n.b);return t?t.k:null;case 2:return n.B;default:return null}return null},X:function(){this.i.e(this.B);this.i.f(this.z);this.i.d(this.y);this.i.g(this.A)},T:function(n,t,i,r){var u={};u.a=this.g.f().UserSessionId;u.b=n;u.c=i?"PendingUserRemoved":"Non-PendingUserRemoved";u.d=r?"Disconnected":"Inactivity";u.e=t;_Ewa.u.a().a(22,u,!0)},U:function(n,t){if(n in this.h){this.V(n);var i=this.h[n];i.dispose();delete this.h[n];Diag.a.a(38322520,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",n);this.T(n,_Ewa.x.a().a(),!1,t)}n in this.k&&(this.u(n,!1),delete this.m[n],delete this.k[n],Diag.a.a(38322521,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",n),this.T(n,_Ewa.x.a().a(),!0,t))},V:function(n){for(var t=this.j.length-1;t>=0;t--)this.j[t].User.UserID===n&&(Array.removeAt(this.j,t),this.h[n].i(!1),this.h[n].j(!1,null),this.v())},bg:function(){this.R()},bb:function(){this.t&&_Ewa.bP.a(_Ewa.x.a(),this.t)<this.I||(this.t=_Ewa.x.a().a(),this.H(),this.ba(),this.n||this.J(!1))},bi:function(){var n,t,i;this.R();n=this.h;for(t in n)i={key:t,value:n[t]},this.F(i.value)},bj:function(){this.H();this.n||this.J(!1);this.n=!1},N:function(){this.H();this.m=null;this.k=null},H:function(){var t=this.k,n,i;for(n in t)i={key:n,value:t[n]},this.u(i.key,!1)},ba:function(){var f=this.p,n,t,i,r,u;for(n in f)t={key:n,value:f[n]},this.S(t.key,!0,t.value);i=this.q;for(r in i)u={key:r,value:i[r]},this.S(u.key,!1,u.value);this.p={};this.q={}},u:function(n,t){var i,r;this.g.q()&&this.g.b().b()&&(i={},i.a=this.g.f().UserSessionId,i.b=n,i.c=t,i.e=!1,i.d=-1,i.f=_Ewa.x.a().a(),this.g.b()&&(i.e=this.g.b().u()),r=this.m[n],r&&(i.d=_Ewa.bP.a(_Ewa.x.a(),r)),_Ewa.u.a().a(20,i,!0))},J:function(n){if(this.g.q()){var t={};t.e=-1;t.f=-1;t.c=!1;t.d=!1;t.b=n;t.a=this.g.f().UserSessionId;this.g.b()&&(t.c=this.g.b().bG(),t.d=this.g.b().u(),this.g.b().w()&&(t.e=this.g.b().w().length),this.g.b().K()&&(t.f=_Ewa.bP.a(_Ewa.x.a(),this.g.b().bI())));_Ewa.u.a().a(21,t,!0)}},S:function(n,t,i){if(this.g.q()){var r={};r.a=this.g.f().UserSessionId;r.b=n;r.c=t;r.d=i;_Ewa.u.a().a(19,r,!0)}},R:function(){var r=[],u=this.h,i,f,n,t;for(i in u)f={key:i,value:u[i]},n=f.value,this.i.c(n.a())&&(this.M(r,n),Array.remove(this.j,n.b.a),this.i.i().PresenceType===1&&(t={},t.a=n.a().PresenceType===1?"Editing":"Non-Editing",t.b=this.g.f().UserSessionId,t.c=_Ewa.x.a().a(),_Ewa.u.a().a(18,t,!1)));this.W(!1);Array.clear(this.j);this.j=r;this.v()},M:function(n,t){var r=t.b.a,u,i;if(t.a().PresenceType)Array.add(n,r);else{for(u=n.length,i=0;i<u;i++)if(this.h[n[i].User.UserID].a().PresenceType)break;Array.insert(n,i,r)}},bf:function(){var t=this.h,n,i;for(n in t)i={key:n,value:t[n]},i.value.dispose();this.h={};this.N();this.m={};this.k={};Array.clear(this.j);this.v()},bc:function(n,t){this.bk(t.a)},bd:function(){this.l.b()&&this.l.b().b()&&this.l.b().b()!==1||this.i.b(null)},F:function(n){var u,t,i,r;this.i.c(n.a())&&(this.M(this.j,n),this.v());u=n.b.a.User.UserID;t=this.h;for(i in t)r={key:i,value:t[i]},r.key!==u&&n.x(r.value)},v:function(){this.j.length?this.W(!0):this.r.t()},W:function(n){for(var t,r,i=0,u=this.j.length;i<u;i++)t=this.h[this.j[i].User.UserID],t&&(n?this.i.k(t.a())?t.i(!0):(r=this.i.j(t.a()),r&&t.j(!0,r)):(t.i(!1),t.j(!1,null)))},Z:function(n){var t={};return t.User={},t.User.UserID=n,t.User.UserName=_Ewa.b.a().c(70),t.UserColor="#AAAAAA",t}};_Ewa.eG=function(n){this.F=Function.createDelegate(this,this.Y);this.I=Function.createDelegate(this,this.bc);this.J=Function.createDelegate(this,this.bd);this.K=Function.createDelegate(this,this.be);this.C=Function.createDelegate(this,this.U);this.H=Function.createDelegate(this,this.bb);this.E=Function.createDelegate(this,this.X);this.w=Function.createDelegate(this,this.W);this.D=Function.createDelegate(this,this.V);this.G=Function.createDelegate(this,this.ba);this.z=Function.createDelegate(this,this.Z);this.L=Function.createDelegate(this,this.bf);this.M=Function.createDelegate(this,this.bg);_Ewa.eG.initializeBase(this,[!1]);this.p=n;this.s=_Ewa.c.a(this.p).a();this.p.A(this.M);this.p.J(this.L);this.q={};this.u=new Common.ck;this.t={};this.t.b=0;this.t.c=0;this.A=new _Ewa.eG.e(this.p)};_Ewa.eG.a=function(){return _Ewa.eG.b||(_Ewa.eG.b={ApplyFilter:1,ApplyPivot:0,ApplyPivotSort:0,ApplyPivotSortByValue:1,ApplyWellKnownPivotFilter:0,RemovePivotFilter:0,SetCustomFilter:1,SetTop10Filter:1,TogglePivotDrill:0,RefreshAll:2})};_Ewa.eG.d=function(n,t){return!!n&&!!n.ObjectId&&!!t&&!!t.ObjectId&&(!n.ObjectType||n.ObjectType===2)&&n.ObjectType===t.ObjectType&&!n.ObjectId.localeCompare(t.ObjectId)};_Ewa.eG.c=function(n,t){return!n.NamedObjectName&&_Ewa.fe.b(n,t)};_Ewa.eG.prototype={p:null,s:null,r:null,u:null,v:null,t:null,A:null,e:function(n){this.cP("presenceChanged",n)},m:function(n){this.cR("presenceChanged",n)},d:function(n){this.p.b().E(n)},l:function(n){this.p.b().G(n)},g:function(n){this.cP("selectionChanged",n)},o:function(n){this.cR("selectionChanged",n)},f:function(n){this.cP("presenceDisabled",n)},n:function(n){this.cR("presenceDisabled",n)},q:null,i:function(){return this.q},h:function(){return this.u},Q:function(){return!this.p.b()||this.p.b().B()},dispose:function(){this.p&&(this.P(),this.p.C(this.M),this.p.K(this.L));this.r&&this.r.k(this.z);System.a.a(this.A);this.r=null;this.p=null;_Ewa.cn.prototype.dispose.call(this)},b:function(n){this.r?this.r.k(this.z):this.R();this.r=n;this.r?(this.r.c(this.z),this.y()):this.P()},R:function(){var i,t,r,n;this.s.f(this.G);_Ewa.c.a(this.p).J(this.D);i=_Ewa.c.a(this.p).f();i.j(this.w);i.d(this.E);this.p.b().e(this.H);this.p.b().bi(this.C);t=this.p.d().a();t.q(this.K);t.f(this.J);t.e(this.I);r=_Ewa.j.b(_Ewa.dD,this.p.a(),16,70);n=this;_Ewa.d.cw(r,function(t){n.v=t.a();n.v.G(n.F);n.v.F(n.w)},$$sc.e.a,3)},P:function(){this.s.h(this.G);_Ewa.c.a(this.p).K(this.D);var n=_Ewa.c.a(this.p).f();n.i(this.w);n.c(this.E);this.p.b().f(this.H);this.p.b().bu(this.C);this.v&&(this.v.K(this.F),this.v.J(this.w),this.p.d().a().s(this.K),this.p.d().a().j(this.J),this.p.d().a().i(this.I));this.cN("presenceDisabled",null,null)},c:function(n){return this.k(n)||!!this.j(n)},k:function(n){var f,e,t,i,o,s,r,u;if(this.q.Version===2&&this.q.Object&&n.Version===2&&n.Object&&this.q.Object.length>0&&n.Object.length>0)for(f=this.q.Object.length,e=n.SelectedRange.length,t=0;t<f;t++)for(i=0;i<e;i++)if(this.T(this.q.Object[t],n.Object[i]))return!0;if(this.q.SelectedRange&&n.SelectedRange)for(o=this.q.SelectedRange.length,s=n.SelectedRange.length,r=0;r<o;r++)for(u=0;u<s;u++)if(_Ewa.eG.c(this.q.SelectedRange[r],n.SelectedRange[u]))return!0;return!1},j:function(n){var r,u,t,i;if(this.q.Version===2&&this.q.Object&&n.Version===2&&n.Object&&this.q.Object.length>0&&n.Object.length>0)for(r=this.q.Object.length,u=n.Object.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.eG.d(this.q.Object[t],n.Object[i]))return this.q.Object[t].ObjectId;return null},T:function(n,t){return!!n&&!!t&&n.ObjectType===t.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!!n.ObjectId&&!!t.ObjectId&&!n.ObjectId.localeCompare(t.ObjectId)},a:function(){this.y()},y:function(){this.s.c()?this.N(0):this.O(_Ewa.c.a(this.p).f().f()?1:0)},N:function(n){var r={},i,t,u;if(this.p.x(r),this.s.c()){if(i=this.s.c().a(),r.FirstColumn=-1,r.FirstRow=-1,r.LastColumn=-1,r.LastRow=-1,r.NamedObjectName=i?i.g():null,this.q.SelectedRange=[r],this.q.PresenceType=0,t=null,i)switch(i.a){case 0:u=this.p.k().bj(i.b);u&&(t={},t.ObjectType=this.x(0),t.ObjectPresenceType=n,t.ObjectId=u.k);break;case 2:i.b&&(t={},t.ObjectType=this.x(9),t.ObjectPresenceType=n,t.ObjectId=i.B)}this.q.Object=[t]}this.cN("selectionChanged",null,null);this.B()},O:function(n){var t,i,r,u;_Ewa.c.a(this.p).G()||(t={},i=this.s.a(),this.p.x(t),i&&(t.FirstColumn=i.b-1,t.FirstRow=i.a-1,t.LastColumn=i.c-1,t.LastRow=i.d-1,t.NamedObjectName=null),this.q.SelectedRange=[t],r=null,u=_Ewa.fe.a(t,this.p,1),u&&(r={},r.ObjectType=this.x(u.c),r.ObjectPresenceType=0,r.ObjectId=u.k),this.q.Object=[r],this.q.PresenceType=n,this.cN("selectionChanged",null,null),this.B())},B:function(){this.Q()||++this.t.b;this.r&&(this.q.Version=2,this.q.ClientType=1,this.q.ChatThreadId=this.u.p,this.q.ChatThreadDiscoveryUri=this.u.o,this.q.InChat=this.u.s,this.q.Cid=this.u.m,this.q.SupportsChat=!!this.u.k&&this.u.k.a(4),this.q.CollabMode=this.p.b().L()?2:0,this.q.OcsCapable=this.p.b().bo(),this.r.v(this.q),this.Q()||++this.t.c)},V:function(){this.p&&this.N(0)},X:function(){this.q.PresenceType=1;this.cN("selectionChanged",null,null);this.B()},W:function(){this.y();this.S()},Y:function(){this.s.c()?this.N(1):this.O(0)},Z:function(n,t){this.cN("presenceChanged",t,null)},ba:function(){this.O(_Ewa.c.a(this.p).p()?1:0)},bb:function(n,t){_Ewa.it.a(t)&&(this.q={})},be:function(n,t){var i,e,o,h,u,f,r;if(t&&t.c in _Ewa.eG.a()){i=null;e=!1;switch(_Ewa.eG.a()[t.c]){case 0:i=t.b.cell;break;case 1:i=t.b.parameters.Location;break;case 2:i=_Ewa.i.a(this.s.a(),this.p);e=!0;break;default:return}if(i.LastColumn=i.FirstColumn,i.LastRow=i.FirstRow,i.NamedObjectName=null,this.q.SelectedRange=[i],this.q.PresenceType=0,e){o=[];for(var c=this.p.k().bC(1),l=c.length,s=0;s<l;++s)h=c[s],u={},u.ObjectType=this.x(h.c),u.ObjectPresenceType=1,u.ObjectId=h.k,Array.add(o,u);this.q.Object=o}else f=_Ewa.fe.a(i,this.p,1),r=null,f&&(r={},r.ObjectType=this.x(f.c),r.ObjectPresenceType=0,r.ObjectId=f.k),this.q.Object=[r];this.cN("selectionChanged",null,null);this.B()}},bc:function(n,t){t.a.b in _Ewa.eG.a()&&(this.q.Object=[null],this.y())},bd:function(n,t){t.a.b in _Ewa.eG.a()&&(this.q.Object=[null],this.y())},bg:function(n,t){t.a||(this.q={},this.p.q()?this.R():this.P())},bf:function(){this.S()},S:function(){this.p.q()&&(this.t.a=this.p.f().UserSessionId,_Ewa.u.a().a(26,this.t,!0));this.t.b=0;this.t.c=0},x:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}},U:function(){this.a();this.A.d()}};_Ewa.eG.e=function(n){_Ewa.eG.e.initializeBase(this,[!1]);this.a=n;var t=this;this.a.a().c(_Ewa.bD,28,function(n){t.b=n;n.d(t)})};_Ewa.eG.e.prototype={a:null,b:null,h:function(n){this.cP("OSC",n)},g:function(n){this.cR("OSC",n)},d:function(){this.cN("OSC",null,null)},c:function(n,t){return n!=="QueryOcsConnectionStatus"?!1:(t.Value=this.a.b().L()?_Ewa.b.a().a(599):_Ewa.b.a().a(600),!0)},f:function(){return!0},dispose:function(){this.b&&(this.b.b(this),this.b=null);this.a=null;_Ewa.cn.prototype.dispose.call(this)}};_Ewa.An=function(n){_Ewa.An.initializeBase(this);this.k=n;this.j()};_Ewa.An.prototype={k:null,h:null,b:function(){this.i(this.h||(this.h=new _Ewa.eG(this.k)))}};_Ewa.Al=function(){};_Ewa.Al.prototype={a:function(n){var r=n.key,i=n.value,u=i.SupportsChat?4:0,t;return t=new Common.ck,t.j=r,t.p=i.ChatThreadId,t.o=i.ChatThreadDiscoveryUri,t.s=i.InChat,t.m=i.Cid,t.k=new Common.co(u),t}};_Ewa.lS=function(){_Ewa.lS.initializeBase(this);this.j()};_Ewa.lS.a=function(n){n.a().b(_Ewa.Jr.$$(Common.cX),155,new _Ewa.lS)};_Ewa.lS.prototype={h:null,b:function(){this.i(this.h||(this.h=new _Ewa.Al))}};_Ewa.Ao=function(n,t,i,r){this.N=Function.createDelegate(this,this.bh);this.H=Function.createDelegate(this,this.bf);this.O=Function.createDelegate(this,this.bj);this.M=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bb);this.Q=Function.createDelegate(this,this.bk);this.W=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bi);this.K=Function.createDelegate(this,this.bl);this.v=[];_Ewa.Ao.initializeBase(this,[!1]);this.u=n;this.w=t;this.T=n.id;this.R=r;this.ba(!0);this.S=i;this.F=!1;this.C=null;this.y={};this.y.FirstColumn=0;this.y.FirstRow=0;this.y.LastColumn=0;this.y.LastRow=0};_Ewa.Ao.prototype={w:null,u:null,z:null,A:!1,F:!1,D:!1,I:!1,y:null,C:null,G:null,E:null,i:function(n){this.cP("hidePresenceTooltip",n)},n:function(n){this.cR("hidePresenceTooltip",n)},k:function(n){this.cP("showPresenceTooltip",n)},q:function(n){this.cR("showPresenceTooltip",n)},j:function(n){this.cP("showFullPresenceTooltip",n)},p:function(n){this.cR("showFullPresenceTooltip",n)},g:function(n){this.cP("presenceChanged",n)},o:function(n){this.cR("presenceChanged",n)},T:null,b:function(){return this.T},S:null,a:function(){return this.S},R:0,d:function(){return this.R},h:function(){var n,e,u,f;if(!this.u||(n=this.w.g().a(),e=new _Ewa.I(this.u.offsetLeft,this.u.offsetTop,this.u.offsetWidth,this.u.offsetHeight),!n.j(e)))return null;if(u=this.w.d(),f=this.u.offsetWidth,!this.C&&f<=4){if(this.y){var t=this.w.m(),i=this.y.FirstRow,r=u?this.y.FirstColumn:this.y.LastColumn;if(t&&!(i>=t.a&&i<=t.d&&r>=t.b&&r<=t.c))return i=i<=t.a?n.a.b:n.a.b+(i>=t.d?n.d():n.d()/2),r=r<=t.b?n.a.a:n.a.a+(r>=t.c?n.c():n.c()/2),this.G=new Sys.UI.Point(r,i)}return this.G}if(this.C){var h=this.u.offsetTop-2,o=parseInt(this.u.style.left),s=0;return u&&(s=parseInt(this.u.parentNode.style.width)-f-o-(this.w.N().b()&&this.w.N().c()?_Ewa.L.a():0)),this.G=new Sys.UI.Point((u?s:o)+f+4,h)}return this.G=new Sys.UI.Point(parseInt(u?this.u.style.right:this.u.style.left)+f,this.u.offsetTop)},B:!1,c:function(){return this.B},r:function(n){return this.B=n,n},x:null,dispose:function(){this.cN("hidePresenceTooltip",null,null);this.cN("presenceChanged",null,null);this.Z();this.V(!0);this.x&&this.x.b(this.K);System.a.a(this.E);this.w=null;this.u=null;this.x=null;_Ewa.cn.prototype.dispose.call(this)},s:function(n,t){var i=!!n&&!_Ewa.i.b(n).e(_Ewa.i.b(this.y)),r=!!t&&(!this.C||this.C.L()!==t.L());(i||r)&&(this.cN("presenceChanged",null,null),this.Z(),this.A=!1,this.B=!1,this.y=n,this.C=t,this.G=null)},m:function(n){this.B=!1;this.I=!1;n&&this.cN("hidePresenceTooltip",null,null)},l:function(n){Array.add(this.v,n);this.ba(!1);n.g(this.J)},Y:function(n){!this.A&&this.L(n.get_clientPoint())&&(this.A=!0,this.cN("showFullPresenceTooltip",null,null),this.D=!0)},X:function(n,t){(t||this.A&&!this.L(n.get_clientPoint()))&&(this.A=!1,this.U(n)||(this.D=!0,this.cN(this.B?"showPresenceTooltip":"hidePresenceTooltip",null,null)))},bd:function(n){this.L(n.get_clientPoint())&&this.cN("showPresenceTooltip",null,null)},be:function(n){this.X(n,!1);this.Y(n)},e:function(n,t){n?(this.I=!0,t&&(this.E=_Ewa.ej.a(this.W,500,this.E))):this.m(t)},f:function(n){this.x&&this.x.b(this.K);this.x=n;this.x&&this.x.c(this.K)},t:function(){if(this.u){this.z=_Ewa.a.o(this.u);var n=Math.floor(this.z.x);this.z.x=n===this.z.x?n:n+1;this.z.y=Math.floor(this.z.y)}},bn:function(){System.a.a(this.E);this.E=null;this.I&&this.cN("showPresenceTooltip",null,null)},Z:function(){for(var n=0,t=this.v.length;n<t;n++)this.v[n].o(this.J);Array.clear(this.v);this.V(!1)},L:function(n){return this.z||this.t(),!!this.z&&Common.f.b(this.z,n)},U:function(n){return!!this.x&&(this.x.d(n)||this.x.h(n.get_clientPoint(),-2))},ba:function(n){this.u&&(n&&(Common.e.a().a("msospPointerOver",this.u,this.Q),Common.e.a().a("msospPointerOut",this.u,this.P),Common.h.a().a("click",this.u,this.M)),!this.F&&this.v.length>=1&&(this.F=!0,Common.e.a().a("msospPointerMove",this.u,this.O),this.w.c().f(this.H),this.w.c().b(this.H),this.w.g().d(this.N)))},V:function(n){this.u&&(n&&(Common.e.a().b("msospPointerOver",this.u,this.Q),Common.e.a().b("msospPointerOut",this.u,this.P),Common.h.a().b("click",this.u,this.M)),this.F&&!this.v.length&&(this.F=!1,Common.e.a().b("msospPointerMove",this.u,this.O),this.w&&(this.w.c().g(this.H),this.w.c().a(this.H),this.w.g().c(this.N))))},bm:function(n){n.o(this.J);Array.remove(this.v,n);this.V(!1)},bi:function(n){var t=n;this.bm(t)},bk:function(n){this.A=!0;this.cN("showFullPresenceTooltip",null,null);this.D=!0;for(var t=0,i=this.v.length;t<i;t++)this.v[t].Y(n);return!1},bj:function(n){this.A=!0;for(var t=0,i=this.v.length;t<i;t++)this.v[t].be(n);return!1},bg:function(n){this.cN("showPresenceTooltip",null,null);for(var t=0,i=this.v.length;t<i;t++)this.v[t].bd(n);return!1},bb:function(n){var i,t,r;for(this.A=!1,i=!0,this.D&&!this.U(n)&&(i=this.L(n.get_clientPoint()),this.cN(this.B?"showPresenceTooltip":"hidePresenceTooltip",null,null)),t=0,r=this.v.length;t<r;t++)this.v[t].X(n,i);return!1},bl:function(n,t){var i,r;t.a===3?(i=t.b,this.D=!0,r=Common.f.b(Common.f.a(this.u),i.get_clientPoint()),(this.I&&r||!r&&!this.U(i))&&this.bb(i)):t.a===2&&(this.D=!1)},bf:function(){this.bc()},bh:function(){this.bc()},bc:function(){this.t();for(var n=0,t=this.v.length;n<t;n++)this.v[n].t()}};_Ewa.qS=function(n){_Ewa.qS.initializeBase(this,[!1]);this.a=n;this.c=null;this.b=null};_Ewa.qS.prototype={c:null,a:null,d:function(){return this.c||{}},e:function(n){return this.b=this.c,this.c=n,this.cN("userPresenceChanged",null,null),n},b:null,dispose:function(){this.cN("userPresenceChanged",null,null);this.cN("userLeft",null,null);this.a=null;this.c=null;this.b=null;_Ewa.cn.prototype.dispose.call(this)}};_Ewa.jH=function(n,t,i){this.r=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.K);this.e=new _Ewa.s(!0);_Ewa.jH.initializeBase(this);this.b=new _Ewa.qS(n);this.y(n);this.g=i;this.p([]);this.c=t;this.c.e().b(this.s);_Ewa.c.a(this.c).Z(this.r)};_Ewa.jH.a=function(n,t,i,r){var u=n===1?19:18;r&&i&&r.a===i.SheetName?(t.val.bl(_Ewa.i.b(i),[u]),t.val.bL(u)):t.val.bI(u)};_Ewa.jH.prototype={c:null,g:null,k:0,l:0,t:0,a:function(){return this.b.d()},q:function(n){return this.b.e(n),this.w(),n},dispose:function(){this.c&&(this.c.e()&&this.c.e().d(this.s),_Ewa.c.a(this.c).Y(this.r));this.A();System.a.b(this.d());System.a.b([this.b]);this.c=null;this.b=null;this.p(null);this.e=null;_Ewa.GM.prototype.dispose.call(this)},A:function(){if(this.e){for(var n=0;n<this.e.a.length;n++)this.e.a[n].dispose();this.e.f()}},x:function(n){this.a().Version===1?this.E(n):this.F(n)},E:function(n){var r,u,t,i;if(n.a().SelectedRange&&this.a().SelectedRange)for(r=this.a().SelectedRange.length,u=n.a().SelectedRange.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.fe.b(this.a().SelectedRange[t],n.a().SelectedRange[i])){this.d()[t].T(n.f(i));return}},F:function(n){var e=0,o=0,p,s,t,i,h,c,r,l,a,w,b,u,f,v,y;if(this.a()&&this.a().Object&&n.a()&&n.a().Object)for(p=this.a().Object.length,s=n.a().Object.length,t=0;t<p;t++)if(this.a().Object[t]&&this.v(this.a().Object[t])){for(e++,i=0;i<s;i++)if(n.a().Object[i]&&this.v(n.a().Object[i])&&(o++,this.D(this.a().Object[t],n.a().Object[i])&&(h=this.f(e),c=n.f(o),h&&c))){h.T(c);return}}else if(this.a().Object[t]&&(!this.a().Object[t].ObjectType||this.a().Object[t].ObjectType===2))for(r=0;r<s;r++)if(n.a().Object[r]&&(!n.a().Object[t].ObjectType||n.a().Object[t].ObjectType===2)&&this.a().Object[t].ObjectId===n.a().Object[r].ObjectId&&(l=this.o(this.a().Object[t].ObjectId),a=n.o(this.a().Object[t].ObjectId),l&&a)){l.k(a);return}if(n.a().SelectedRange&&this.a().SelectedRange)for(w=this.a().SelectedRange.length,b=n.a().SelectedRange.length,u=0;u<w;u++)for(f=0;f<b;f++)if(_Ewa.fe.b(this.a().SelectedRange[u],n.a().SelectedRange[f])&&(v=this.f(e+u),y=n.f(o+f),v&&y)){v.T(y);return}},D:function(n,t){return!!n&&!!t&&t.ObjectType===n.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!n.ObjectId.localeCompare(t.ObjectId)},f:function(n){return n>=0&&this.d().length>n?this.d()[n]:null},i:function(n){for(var t=0,i=this.d().length;t<i;t++)this.d()[t].bq(n)},o:function(n){return n&&this.e.d(n)?this.e.b[n]||null:null},j:function(n,t){var r,i,u;if(n)r=this.e.b[t]||null,r&&r.j(!0);else for(i=0;i<this.e.a.length;i++)u=this.e.a[i],u&&u.j(!1)},z:function(n){_Ewa.lQ.a(this,n)},u:function(n,t){if(n<t)return this.d()[n];if(!this.h()||!this.c||!this.g)return null;var i=new _Ewa.dF(this.h(),this.c,this.g);return Array.add(this.d(),i),i},L:function(){for(var t,f,e,i,r=this.d().length,u=this.a().SelectedRange?this.a().SelectedRange.length:0,o=this.c.e().a(),n=0;n<u;n++)(t=this.u(n,r),t&&this.a().SelectedRange[n])&&(this.a().SelectedRange[n].NamedObjectName?t.x([19,18]):(t.bb(this.a().SelectedRange[n],this.a().PresenceType),_Ewa.jH.a(this.a().PresenceType,f={val:t},this.a().SelectedRange[n],o),t=f.val));for(e=!!this.b&&!!this.b.b&&this.b.b.PresenceType!==this.b.d().PresenceType,i=e?0:u;i<r;i++)this.d()[i].x([this.b.b.PresenceType===1?19:18])},v:function(n){if(n&&n.ObjectId&&(this.B(n.ObjectType)===1||this.B(n.ObjectType)===2)){var t=this.c.k().bb(n.ObjectId);if(t)return _Ewa.i.n(t)}return null},M:function(){for(var u,f,n,e,o,l,i,t,a,v,s,y,h=this.d().length,r=this.c.e().a(),p=this.a().SelectedRange?this.a().SelectedRange.length:0,w=this.a().Object?this.a().Object.length:0,c=0;c<h;c++)this.d()[c].x([19,18]);for(this.G(),u=0,this.k=0,this.l=0,f=0;f<w;f++)n=this.a().Object[f],e=this.v(n),e&&(o=this.u(u,h),n.ObjectType===1?this.k++:n.ObjectType===3&&this.l++,u++,o.bb(e,n.ObjectPresenceType),_Ewa.jH.a(n.ObjectPresenceType,l={val:o},e,r),o=l.val);for(i=0;i<p;i++)if(this.a()&&this.a().SelectedRange&&(t=this.a().SelectedRange[i],!t.NamedObjectName)){if(a=!!r&&t.SheetName===r.a,v=!!_Ewa.fe.a(t,this.c,1),a&&v)continue;s=this.u(u+i,h);s.bb(t,this.a().PresenceType);_Ewa.jH.a(this.a().PresenceType,y={val:s},t,r);s=y.val}(this.t=this.C())>0&&Diag.a.a(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')},G:function(){this.C();this.A()},C:function(){var t=0,n,i;if(this.a()&&this.a().Object)for(n=0;n<this.a().Object.length;n++)i=this.a().Object[n],this.N(i)&&t++;return t},H:function(n,t){var r,i;return this.e.d(t)?(r=this.e.b[t]||null,r.a(n),r):!this.h()||!this.c||!this.g?null:(i=new _Ewa.Aj(this.h(),this.c,this.g),i.a(n),this.e.c(t,i),i)},N:function(n){var r=!1,t,i;if(n&&n.ObjectId&&(!n.ObjectType||n.ObjectType===2))try{t=this.I(n);t&&(i=this.H(t,n.ObjectId),i.c(t,n.ObjectPresenceType),i.b(),r=!0)}catch(u){Diag.a.a(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',u.stack);throw u;}return r},I:function(n){var t,r,i;return n?(t=null,n.ObjectType===2?t=_Ewa.M.a(this.c).n(n.ObjectId):n.ObjectType||(r=this.c.k(),i=r.bb(n.ObjectId),i&&i.l&&(t=_Ewa.M.a(this.c).v(i.l))),t):null},w:function(){try{this.a().Version===1?(this.L(),Diag.a.a(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.M(),Diag.a.a(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.t,this.k,this.l))}catch(n){Diag.a.a(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',n.stack);throw n;}},J:function(){this.w()},K:function(){this.w()},B:function(n){switch(n){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}}};_Ewa.Ak=function(){};_Ewa.Ak.a=function(){Diag.a.a(38339419,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};_Ewa.Ak.b=function(){_Ewa.e.a(function(n){var t=n.a();t.b(_Ewa.Jr.$$(_Ewa.il),154,new _Ewa.An(n));_Ewa.e.a(_Ewa.lS.a);_Ewa.d.c(_Ewa.j.a(_Ewa.il,t,154,t.d()),function(i){var u=new($$sc.B.$$(Common.dG)),f=t.a(_Ewa.fJ,26,!1),r;f.d(u.h);r=new _Ewa.jG(n,f,i.a());_Ewa.dX.a(n.a()).a(r);n.c(171)&&(t.b(_Ewa.Jr.$$(Common.cX),155,new _Ewa.lS),_Ewa.d.c(_Ewa.j.a(Common.cX,t,155,t.d()),function(t){var f=new($$sc.B.$$(Common.fw)),i,e;f.b(r);e=new Common.App.Presence.a((i=new Common.ck,i.j=n.l().ClientId,i),u.a,f.a,t.a(),Common.D.a(),6e4,Common.a.c().p,_Ewa.Ak.a)},t.d()))},t.d())})};_Ewa.fe=function(){};_Ewa.fe.b=function(n,t){return!!n&&!!t&&n.SheetName===t.SheetName&&(!!n.NamedObjectName&&n.NamedObjectName===t.NamedObjectName||!n.NamedObjectName&&!t.NamedObjectName&&_Ewa.i.b(n).h(_Ewa.i.b(t)))};_Ewa.fe.a=function(n,t,i){var u,r;if(!t||!t.k())return null;for(u=0;u<t.k().e();u++)if(r=t.k().g(u),r&&r.c===i&&r.b&&r.b.n(_Ewa.i.b(n))&&_Ewa.h.a(r.i,n.SheetName,!0))return r;return null};_Ewa.qR=function(){};_Ewa.qR.a=function(n,t,i){if(!t)return null;var r=n.r();return new Sys.UI.Point(t.x+r.a*(i?1:-1),t.y+r.b*(i?1:-1))};_Ewa.Aj.registerClass("_Ewa.Aj",null,_Ewa.KE,Sys.IDisposable);_Ewa.lQ.registerClass("_Ewa.lQ",_Ewa.GM);_Ewa.hj.registerClass("_Ewa.hj",_Ewa.cn,Common.App.CollabControls.i,Sys.IDisposable);_Ewa.lR.registerClass("_Ewa.lR",_Ewa.cn,_Ewa.KF,Sys.IDisposable);_Ewa.dF.registerClass("_Ewa.dF",_Ewa.lq);_Ewa.hk.registerClass("_Ewa.hk",null,Sys.IDisposable);_Ewa.jG.registerClass("_Ewa.jG",_Ewa.cn,_Ewa.jB,Common.fw);_Ewa.eG.registerClass("_Ewa.eG",_Ewa.cn,_Ewa.il,Sys.IDisposable,Common.fx);_Ewa.eG.e.registerClass("_Ewa.eG.e",_Ewa.cn,Sys.IDisposable,_Ewa.pT,Common.IRootUser);_Ewa.An.registerClass("_Ewa.An",_Ewa.lZ.$$(_Ewa.il));_Ewa.lS.registerClass("_Ewa.lS",_Ewa.lZ.$$(Common.cX));_Ewa.Ao.registerClass("_Ewa.Ao",_Ewa.cn,_Ewa.KF,Sys.IDisposable);_Ewa.qS.registerClass("_Ewa.qS",_Ewa.cn);_Ewa.jH.registerClass("_Ewa.jH",_Ewa.lQ);_Ewa.hj.a=null;_Ewa.dF.b=null;_Ewa.dF.a=null;_Ewa.eG.b=null;_Ewa.Ak.b();Type.registerNamespace("_Ewa");_Ewa.lT=function(n,t,i){this.g=Function.createDelegate(this,this.i);_Ewa.lT.initializeBase(this,[!1]);this.e=t;this.h=n;this.d=i;this.b=[];i.d(this.g);this.e.a().b(_Ewa.jI,227,this)};_Ewa.lT.a=function(n,t){var i,r,u,f;return!n.length&&!t.length?"":t.length?t.length===1?(i=_Ewa.b.a().c(66),String.format(i,t[0].UserName)):(r=_Ewa.b.a().c(67),String.format(r,t.length)):n.length===1?(u=_Ewa.b.a().c(68),String.format(u,n[0].UserName)):(f=_Ewa.b.a().c(69),String.format(f,n.length))};_Ewa.lT.prototype={e:null,h:null,d:null,b:null,f:null,c:null,a:function(n,t){var i,r,u,f;return this.b=[],this.d.e(n,t,u={val:i},f={val:r}),i=u.val,r=f.val,Array.addRange(this.b,i),Array.addRange(this.b,r),_Ewa.lT.a(i,r)},dispose:function(){this.d.f(this.g);this.c&&(System.a.a(this.c),this.c=null);_Ewa.GM.prototype.dispose.call(this)},i:function(n,t){var o,l,a,f,y,p;if(t.b){var i=[],r=[],u=_Ewa.c.a(this.e).a(),e=!(u.d()===2||u.d()===128),h=e?_Ewa.i.a(u.a(),this.e):u.c().a(),c=t.b;for(o in c)l={key:o,value:c[o]},a=l.key,this.d.a(h,e,i,r,a);for(var v=this.b,w=v.length,s=0;s<w;++s)f=v[s],Array.contains(i,f)||Array.contains(r,f)||this.d.a(h,e,i,r,f.UserID);this.b=[];Array.addRange(this.b,i);Array.addRange(this.b,r);this.f&&(System.a.a(this.c),this.c=null,this.f=null);y=_Ewa.lT.a(i,r);this.c=new _Ewa.eb;p=this;this.f=_Ewa.d.cw($$sc.a.b(1),function(){p.h.d(y,"polite")},this.c.a(),3)}}};_Ewa.lT.registerClass("_Ewa.lT",_Ewa.GM,_Ewa.jI);Type.registerNamespace("_Ewa");_Ewa.Ap=function(){};_Ewa.Ap.b=function(){_Ewa.e.a(_Ewa.Ap.a)};_Ewa.Ap.a=function(n){var t=n.a(),i=_Ewa.j.b(_Ewa.cF,n.a(),207,208);t.c(_Ewa.jB,25,function(r){_Ewa.d.cw(i,function(i){var u=t.a(_Ewa.jI,227,!1)||new _Ewa.lT(i.a(),n,r)},t.d(),3)})};_Ewa.Ap.b();Type.registerNamespace("_Ewa");_Ewa.BZ=function(n,t,i){_Ewa.BZ.initializeBase(this,[t,i]);this.h=n};_Ewa.BZ.prototype={h:null,c:null,g:function(){if(this.c)return this.c.a;this.c=new($$sc.B.$$(String));var n=this;return Common.a.b.d(function(){var t=n.h.l().FullDocumentInfo.Cid;Diag.a.b(9000733,333,!!t,"Cid should not be null for SkypeChat");n.c.b(t)}),this.c.a}};_Ewa.rR=function(n,t,i,r,u,f){_Ewa.rR.initializeBase(this,[t,i,r,u,f]);this.u=n;this.bd=i};_Ewa.rR.prototype={u:null,bd:null,l:function(){var n,t;_Ewa.r.a().a()?(n=_Ewa.gS.a(this.u),n&&n.a()&&n.a().i()):(t=_Ewa.bx.b(this.u),t&&t.h(Common.bc.a.a,!0))}};_Ewa.Ca=function(){};_Ewa.Ca.a=function(n){var t=_Ewa.j.a(_Ewa.il,n.a(),154,$$sc.e.a),i=new($$sc.B.$$(Common.fy)),r=new($$sc.B.$$(Common.dG)),u,f,e,o;return n.a().a(_Ewa.fJ,26,!1).d(r.h),t.CW(function(){i.b(t.a().h())}),u=t.CWR(Common.fx,function(n){return n.a()}),f=_Ewa.j.a(Common.cX,n.a(),155,$$sc.e.a),Common.Utils.a.a().b(Common.App.SkypeChat.f).a().b(function(){return new _Ewa.BZ(n,Common.Utils.b.a(Common.App.BasicChat.c,Common.Utils.a.a().c(Common.App.BasicChat.c)),Common.Utils.b.a(Common.App.BasicChat.b,Common.Utils.a.a().c(Common.App.BasicChat.b)))}),e=new Common.App.SkypeChat.i(r.a,i.a,u,Common.Utils.a.a().a(Common.App.SkypeChat.f),f),o=$$sc.a.a(Common.fC,new Common.App.SkypeChat.k(r.a,u,i.a,f)),new _Ewa.rR(n,Common.a.c(),Common.Utils.a.a().a(Common.App.SkypeChat.e),o,Common.eu.a(n.o(),null),e)};_Ewa.Cb=function(n,t){this.c=n;this.a=t};_Ewa.Cb.prototype={c:null,a:null,b:!1,s:function(){return!1},q:function(n,t,i){var f=!0,u=32,r=t.a,e;return this.b?r===Common.bc.a.b?u=this.a.b(Common.bc.a.b,2,i,null):r===Common.bc.a.c?u=this.a.b(Common.bc.a.c,2,i,null):r===Common.bc.a.d&&(u=this.a.b(Common.bc.a.d,2,i,null)):r===722290388?(e=this,new Common.App.SkypeChat.g(new($$sc.w.$$(Common.App.SkypeChat.h))(function(){return e.c.a()}),Common.Utils.a.a().c(Common.App.BasicChat.c),null).g(),this.b=!0):f=!1,f&&u!==2?$$sc.a.a(Boolean,!0):_Ewa.F.a(r)},p:function(n,t){var r=!1,i=t.a;return i===722290388&&(r=!0),this.b&&(i===1478537812||i===Common.bc.a.b||i===Common.bc.a.c||i===Common.bc.a.d)&&(r=!0),r},r:function(){return!1}};_Ewa.rS=function(n){this.m=Function.createDelegate(this,this.q);_Ewa.rS.initializeBase(this,[n])};_Ewa.rS.a=function(n){_Ewa.P.a(142,new _Ewa.rS(n))};_Ewa.rS.prototype={k:function(){_Ewa.bx.b(this.h)?this.o():_Ewa.bx.a(this.h).b(this.m)},q:function(){_Ewa.bx.a(this.h).a(this.m);this.o()},o:function(){var n=this,t=new($$sc.w.$$(_Ewa.rR))(function(){return _Ewa.Ca.a(n.h)});this.l([new _Ewa.Cb(t,Common.a.c())],null)}};_Ewa.BZ.registerClass("_Ewa.BZ",Common.App.SkypeChat.q,Common.App.SkypeChat.f);_Ewa.rR.registerClass("_Ewa.rR",Common.App.SkypeChat.u);_Ewa.rS.registerClass("_Ewa.rS",_Ewa.P);Type.registerNamespace("_Ewa");_Ewa.LV=function(){};_Ewa.LV.a=function(){_Ewa.e.a(_Ewa.rS.a)};_Ewa.LV.a();Type.registerNamespace("_Ewa");_Ewa.qW=function(n){this.p=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_Ewa.qW.initializeBase(this,[!1]);this.m=n;this.m.J(this.n);this.m.b().bC(this.n);var t=this;n.a().c(Common.fB,37,function(n){n.a(t.n)})};_Ewa.qW.a=function(n){n.a().b(_Ewa.fJ,26,new _Ewa.qW(n))};_Ewa.qW.prototype={m:null,o:null,r:null,c:function(n){this.cP("connectionCompleted",n)},f:function(n){this.cR("connectionCompleted",n)},i:function(n){this.cP("rtcInitialized",n)},k:function(n){this.cR("rtcInitialized",n)},e:function(n){this.cP("connectionLostEventKey",n)},g:function(n){this.cR("connectionLostEventKey",n)},l:null,b:function(){return this.l},q:!1,j:function(){return this.q},dispose:function(){this.l&&this.l.j(this.p);this.m&&this.m.K(this.n);this.m=null;this.l=null;_Ewa.cn.prototype.dispose.call(this)},d:function(n){var t=this;_Ewa.d.c(this.s().a,function(t){n(t.a())},this.cO())},h:function(n,t,i){this.q=i;this.u(n,t)},a:function(){this.l&&(this.cN("rtcInitialized",null,null),this.l.b()===2&&this.o&&this.cN("connectionCompleted",new _Ewa.nU(this.l),this.o))},u:function(n,t){Diag.a.a(9245249,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");var r=this,i=this;_Ewa.d.cw(_Ewa.d.ts(_Ewa.p.c(35,4,!1),function(){return _Ewa.p.c(10,0,!1)},this.cO(),3,$$sc.c.a),function(){i.l=AppRealtimeChannel.n.c(n,t,i.m.f().UserSessionId,Common.a.dt,Common.a.d,2,i.m.o(),null,null);i.s().b(i.l);i.cN("rtcInitialized",null,null);Diag.a.a(9245250,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var r=$$as(AppRealtimeChannel.b,i.l);r&&(Diag.a.a(9245251,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),r.h(i.p),r.n())},this.cO(),3)},t:function(n,t){t.a===2?(this.l?this.cN("connectionCompleted",new _Ewa.nU(this.l),t):Diag.a.a(38396034,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null"),this.o=t):t.b!==2&&t.a||(this.o=null,this.cN("connectionLostEventKey",null,null))},v:function(){if(this.l){var n=$$as(AppRealtimeChannel.b,this.l);n&&(Diag.a.a(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),n.o(),n.j(this.p))}this.l=null},s:function(){return this.r||(this.r=new($$sc.B.$$(Common.dG)))}};_Ewa.qW.registerClass("_Ewa.qW",_Ewa.cn,_Ewa.fJ,_Ewa.Jj);Type.registerNamespace("_Ewa");_Ewa.KN=function(){};_Ewa.KN.a=function(){_Ewa.e.a(_Ewa.qW.a)};_Ewa.KN.a();Type.registerNamespace("_Ewa");_Ewa.Ae=function(n,t,i){this.t=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.x);this.s=Function.createDelegate(this,this.y);_Ewa.Ae.initializeBase(this,[n,null]);var r="<div id='notificationBody'>\r\n<div class='clip16x16' id='notificationUserImage'><img class='{0}' src='{1}' id='singleUserImage'/><img class='{2}' src='{3}' id='multiUserImage'/><\/div>\r\n<span class='ewa-new-user-notification-text' id='notificationText'><\/span>\r\n<div class='clip16x16' id='notificationImage'><img class='{4}' src='{5}' alt='{6}' title='{6}' /><\/div>\r\n<\/div>\r\n";this.f=t;r=String.format(r,"ewaboot_presenceheads",_Ewa.p.a(3),"ewaother_PlaceContacts_16x16x32",_Ewa.p.a(3),"ewaother_ClosePaneGlyph_16x16x32",_Ewa.p.a(3),this.f.a(510));this.bN().innerHTML=r;this.d=_Ewa.a.a(n,"notificationBody");this.a=_Ewa.a.a(n,"notificationText");this.e=_Ewa.a.a(n,"notificationImage");this.b=_Ewa.a.a(n,"notificationUserImage");this.l=_Ewa.a.a(n,"singleUserImage");this.j=_Ewa.a.a(n,"multiUserImage");_Ewa.a.k(this.a,"alert",null,null,null);this.bT().a("click",this.s);this.i=this.bQ.a(this.e);this.i.a("click",this.r);this.o=i};_Ewa.Ae.prototype={d:null,a:null,e:null,b:null,l:null,j:null,i:null,m:null,p:null,q:null,c:null,g:!1,k:null,o:null,f:null,dispose:function(){System.a.b([this.i,this.k]);this.d=this.a=this.e=null;this.b=null;_Ewa.EM.prototype.dispose.call(this)},h:function(n){n?this.set_visible(!0):(this.set_visible(!1),this.w())},A:function(n){this.bN().className=n?"ewa-popup-rtl ewa-new-user-notification":"ewa-popup-ltr ewa-new-user-notification";this.bN().dir=n?"rtl":"ltr";n?(this.d.insertBefore(this.a,this.b),this.d.insertBefore(this.e,this.a),this.b.style.marginLeft="10px"):(this.d.insertBefore(this.b,this.a),this.d.insertBefore(this.a,this.e),this.b.style.marginRight="10px")},n:function(n,t){var i;if(n){var e=!this.m,r=new($$sc.t.$$(Boolean)),u=new($$sc.t.$$(Boolean)),f=new($$sc.t.$$(Boolean));for(i=0;i<n.length;i++)e?this.u(n[i].User.UserID):this.m.c(n[i].User.UserID)||(this.u(n[i].User.UserID),this.C(n[i],t)&&this.B(n[i])),r.b(n[i].User.UserID,!0),n[i].UserEmail&&u.b(n[i].UserEmail,!0),n[i].User.UserName&&f.b(n[i].User.UserName,!0);this.m=r;this.p=u;this.q=f}},C:function(n,t){return t?(Diag.a.a(37261332,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmailAvailable: [{0}], UserNameAvailable: [{1}]",!!n.UserEmail,!!n.User.UserName),n.User.UserName&&this.q.c(n.User.UserName))?(Diag.a.a(37261333,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserNameKnown]"),!1):n.UserEmail&&this.p.c(n.UserEmail)?(n.UserEmail.length||Diag.a.a(37261334,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmail is empty"),Diag.a.a(37261335,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserEmailKnown]"),!1):(Diag.a.a(37261336,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [UserEmailAndNameNotKnown]"),!0):(Diag.a.a(37261331,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [DedupDisabled]"),!0)},u:function(n){var t={};t.a=this.o;t.b=n;t.c="JoiningUser";t.d=_Ewa.x.a().a();_Ewa.u.a().a(23,t,!0)},B:function(n){if(this.c){var t=!_Ewa.h.f(this.c.User.UserID,n.User.UserID,!1);t||this.g||(this.g=!0,this.v())}else this.c=n,this.v()},v:function(){var n="";this.g?(n=this.f.a(509),this.b.style.backgroundColor="",_Ewa.a.b(this.l,!1,!0),_Ewa.a.b(this.j,!0,!0)):this.c&&(n=String.format(this.f.c(5),this.c.User.UserName),this.b.style.backgroundColor=this.c.UserColor,_Ewa.a.b(this.l,!0,!0),_Ewa.a.b(this.j,!1,!0));this.a.innerText=n;System.a.a(this.k);this.k=_Ewa.v.a().a(this.t,5e3,!0,!1);this.h(!0)},w:function(){this.c=null;this.g=!1},z:function(){this.h(!1)},y:function(n){this.h(!1);_Ewa.w.a(n,!0)},x:function(n){this.h(!1);_Ewa.w.a(n,!0)}};_Ewa.hh=function(n,t,i,r,u){var o,f,s,e;if(this.j=Function.createDelegate(this,this.G),this.i=Function.createDelegate(this,this.F),_Ewa.hh.initializeBase(this,[n,null]),this.b=t,this.l=i,this.k=r,this.m=u,this.b.b().E(this.i),this.b.J(this.j),o=document.createElement("div"),_Ewa.c.a(this.b).H().appendChild(o),this.d=new _Ewa.Ae(o,u,this.b.f().UserSessionId),this.d.h(!1),this.d.A(this.b.u()),f=this.b.b().w(),this.l.j())for(s=f.length,e=0;e<s;e++)if(f[e].User.UserID===t.l().ClientId){this.d.n([f[e]],this.n());break}this.d.n(f,this.n())};_Ewa.hh.a=function(n){var i=null,t;return n&&(t=n.SelectedRange,i=t&&t.length>0?t[0]:null),i};_Ewa.hh.prototype={d:null,x:function(){return!this.V()&&!this.e},n:function(){return this.b.c(327)},k:null,l:null,m:null,b:null,dispose:function(){var n=this.b;n&&(n.b().G(this.i),n.K(this.j),n.h().t(45),_Ewa.lO.a(n));RealtimePresenceUI.b.prototype.dispose.call(this)},z:function(n){return this.X(n)},A:function(n){return this.bc(n)},y:function(n){return this.W(n)},t:function(){var i=this.b.b().w(),r,u,n,t;if(!i)return new Array(0);for(r=i.length,u=new Array(r),n=0;n<r;n++)t=i[n],u[n]=new Common.ck(t.User.UserID,t.User.UserName,t.UserColor,new Common.co(1),null,t.UserEmail,null,null,!1,!1,!1,0);return u},w:function(){},u:function(n,t){var i=_Ewa.hh.a(t),r,u;i&&(r=i.SheetName,r&&(u=_Ewa.i.b(i),this.b.e().l(this.b.e().c(r)),_Ewa.c.a(this.b).R(u,u.g(),3)))},r:function(n,t){var i=_Ewa.hh.a(t);return!!i&&!i.NamedObjectName},s:function(n,t,i){var o=i,f=_Ewa.hh.a(o),u,l,g,e,a,v,y,tt;if(!f)return"";var r="",p=f.SheetName,h=$$as(_Ewa.A,this.b.i()),w=!h||p!==h.a;w&&(r=String.format("{0}",p));var b="!",k=w?b.toString():"",s=!1;try{if(!(o.Version===1)&&o.Object){for(var d=o.Object,it=d.length,c=0;c<it;++c)if(u=d[c],l=this.E(u),this.C(u)||this.B(u)||l){if(g=this.b.k(),e=g.bb(u.ObjectId),e){r=h&&h.a!==e.i?String.format("{0}{1}",e.i,b):"";r+=l?e.b.toString():e.a;s=!0;break}}else if(this.D(u)&&(a=_Ewa.M.a(this.b).n(u.ObjectId),a)){r=a.a().i;s=!0;break}Diag.a.a(25031572,0,50,"PresenceObject")}!s&&f.NamedObjectName&&o.Version===1&&(v=_Ewa.M.a(this.b).b(f.NamedObjectName,null),v&&(r+=k+v.a().i,s=!0));s||f.NamedObjectName||(y=_Ewa.i.b(f),y.y()&&(r+=k+y))}catch(nt){Diag.a.a(25031575,0,10,'{{"ConvertUserPresenceToStatusString Exception":"{0}"}',nt.stack);throw nt;}return tt=this.m.a(909),String.format("{0} {1}",tt,r)},v:function(){if(_Ewa.r.a().a()){var n=_Ewa.gS.a(this.b);n&&n.a()&&n.a().j()}else this.k.h(this.a.a.f,!0)},F:function(){var n,r;Diag.a.a(23643289,0,50,"EwaPeoplesWellControl::OnUserListUpdated");this.p();this.d.n(this.b.b().w(),this.n());n="";for(var i=this.b.b().w(),u=i.length,t=0;t<u;++t)r=i[t],n+=r.User.UserID+";";_Ewa.h.c(n)||Diag.a.a(25049093,0,50,"EwaPeoplesWellControl.OnUserListUpdated: UserList updated [{0}].",n)},G:function(){this.b.a().e(Sys.IDisposable,44)},C:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.h(1)},B:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.h(0)},E:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.h(2)},D:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.h(9)},h:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.Ad=function(n,t){this.b=n;this.a=t};_Ewa.Ad.prototype={b:null,a:null,s:function(n,t){return t===this.a.a.a.a&&this.a.x()},q:function(n,t,i){var u=this.a.a,f=null,r=t.a,e;return Diag.a.a(23643291,0,50,"EwaPeoplesWellControlHandler::ExecuteCommand: {0}",r),r===u.a.a?(e=this,f=_Ewa.d.c($$sc.a.b(0),function(){e.a.Z()},this.b.j())):r===u.a.d?this.a.z(i):r===u.a.c?this.r(n,"PopulatePeoplesWellControl",i):r===u.a.e?this.a.A(i):r===u.a.g?this.a.p():f=_Ewa.F.a(r),f||$$sc.a.a(Boolean,!0)},p:function(n,t,i){var r=this.a.a,f=!1,u=t.a;return u===r.a.a||u===r.a.g?f=!0:(u===r.a.d||u===r.a.c||u===r.a.e)&&(f=!!i),f},r:function(n,t,i){return t==="PopulatePeoplesWellControl"?(this.a.y(i),!0):!1},dispose:function(){this.b&&this.b.h()&&this.b.h().e(this);this.b=null}};_Ewa.lO=function(n){this.m=Function.createDelegate(this,this.r);_Ewa.lO.initializeBase(this,[n])};_Ewa.lO.a=function(n){_Ewa.P.a(45,new _Ewa.lO(n))};_Ewa.lO.prototype={dispose:function(){var n=this.h;n&&n.C(this.m);_Ewa.P.prototype.dispose.call(this)},k:function(){Diag.a.a(23643293,0,50,"PeoplesWellCommandHandlerFactory::CreateCommandHandlersAsync. SessionAction: {0}, EditMode {1}",this.h.b().b(),this.h.q());this.h.b().b()&&this.h.q()?this.o():this.h.A(this.m)},r:function(n,t){t.b||this.o()},o:function(){Diag.a.a(23643294,0,50,"PeoplesWellCommandHandlerFactory::InitPeoplesWellControl");var n=this.h.a(),t=this;n.c(_Ewa.fJ,26,function(i){n.c(_Ewa.bD,52,function(r){_Ewa.d.cw(_Ewa.j.a(Object,n,151,t.cO()),function(){t.q(i,r)},t.cO(),3)})})},q:function(n,t){Diag.a.a(38410440,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl");var r=null,i=this;r=function(){Diag.a.a(38410441,0,50,"PeoplesWellCommandHandlerFactory on RealTimeChannelInitialized.");n.k(r);var f=t.l(_Ewa.p.a(3),"ewaboot_presenceheads",_Ewa.p.a(3),"ewaboot_presenceheads32",_Ewa.p.a(3),"ewaboot_presenceheadswhite"),u=new _Ewa.hh(RealtimePresenceUI.a.a(f,i.h.l().ClientId,$$as(AppRealtimeChannel.b,n.b()),i.h.c(327)),i.h,n,t,_Ewa.b.a());i.h.a().b(Sys.IDisposable,44,u);i.l([new _Ewa.Ad(i.h,u)],null)};n.i(r);n.a()}};_Ewa.Ae.registerClass("_Ewa.Ae",_Ewa.EM);_Ewa.hh.registerClass("_Ewa.hh",RealtimePresenceUI.b);_Ewa.lO.registerClass("_Ewa.lO",_Ewa.P);Type.registerNamespace("_Ewa");_Ewa.Kw=function(){};_Ewa.Kw.a=function(){_Ewa.e.a(_Ewa.lO.a)};_Ewa.Kw.a();Type.registerNamespace("_Ewa");_Ewa.KO=function(){};_Ewa.KO.a=function(){_Ewa.e.a(function(n){_Ewa.d.c(_Ewa.j.a(_Ewa.cB,n.a(),12,n.j()),function(t){var i=new _Ewa.Az(n),r=t.a().f(i,i);n.a().b(_Ewa.qY,287,new _Ewa.AA(n,n.a().a(_Ewa.fJ,26,!1),r))},n.j())})};_Ewa.jL=function(){};_Ewa.jL.b=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.Id=t,o.OnBehalfOfOcs=i,_Ewa.g.a(n,"CheckPersistedContentUpdate",o,r,u,f,4,null)};_Ewa.jL.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.OcsSessionId=t,o.SeqNum=i,_Ewa.g.a(n,"CheckCollabServiceContentUpdate",o,r,u,f,4,null)};_Ewa.jL.c=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.clientIdsToAdd=t,o.clientIdsToRemove=i,_Ewa.g.a(n,"UpdatePresenceUsers",o,r,u,f,0,null)};_Ewa.AA=function(n,t,i){this.e=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.n);this.j=Function.createDelegate(this,this.q);_Ewa.AA.initializeBase(this,[!1]);this.b=n;this.d=t;this.b.d().e(this.j);this.d.c(this.h);this.d.e(this.i);this.k=i;this.d.a()};_Ewa.AA.prototype={c:null,b:null,d:null,g:!1,k:null,l:function(){return!!this.c&&this.c.b()===2},a:function(n,t){if(this.b.b().b()){Diag.a.a(39150978,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",n?n.join(","):"null",t?t.join(","):"null");var i=this;_Ewa.v.a().a(function(){_Ewa.jL.c(i.b.d().a(),n,t,null,null,null,null)},this.b.b().bc(),!0,!1)}},dispose:function(){this.c&&this.c.l(this.f);this.b&&this.b.d().g(this.j);this.d&&(this.d.f(this.h),this.d.g(this.i));this.c=null;this.b=null;_Ewa.GM.prototype.dispose.call(this)},s:function(n){this.c&&this.c.l(this.f);this.c=$$as(AppRealtimeChannel.b,n);this.c.t(this.f)},p:function(n,t){var r,i,c,u,o,f,s,e,h;if(this.g=!0,t.a===1){r=$$as(Array,t.b);(!r||this.r(r))&&this.a(r,null);return}if(i=$$as(Object,t.b),i)if(t.a)if(t.a===4){if(f=!1,"OnBehalfOfOcs"in i&&(f=i.OnBehalfOfOcs),this.b.b().L()&&f)return;s=i.Id;this.b.b().b()&&!!s&&_Ewa.jL.b(this.b.d().a(),s,f,this.e,null,null,null)}else t.a===8&&(e=i.SessionId,h=i.SeqNum,this.b.b().b()&&!!e&&(this.b.c(501)?this.k.a(new _Ewa.qX(e,h,this.e)):_Ewa.jL.a(this.b.d().a(),e,h,this.e,null,null,null)));else{if(c=i.latestStateId,u=null,"sessionSiteIdentifier"in i&&(u=i.sessionSiteIdentifier),o=this.b.b().W(),o!==u){Diag.a.a(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",u,o);return}this.b.b().T(c,"ContentRefreshManager.OnUpdateNotificationReceived");this.b.b().R(3e4)}},m:function(n){var t=n.Errors;_Ewa.f.d(t)&&(t=_Ewa.f.f(t,[307,493,525],"ContentRefreshManager"),this.b.b().n(t))},q:function(){this.l()&&this.g&&this.b.b().R(3e4)},o:function(){this.g=!1;this.b.b().R(500)},n:function(n,t){this.s(t.a)},r:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;++t)if(r=i[t],u=this.b.b().be(r),!u)return!0;return!1}};_Ewa.Az=function(n){this.c=n};_Ewa.Az.prototype={c:null,a:function(n){return _Ewa.jL.a(this.c.d().a(),n.b,n.a,n.c,null,null,null)},b:function(n,t){if(!t)return n;if(!n)return Diag.a.b(39913247,0,!!n,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t;if(t.b!==n.b)return Diag.a.a(39913248,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. newActionParameter.SeqNum: {0}, aggregatedActionParameter.seqNum: {1}",n.a,t.a),n.a<t.a?n:t;var i=n.a>t.a?n.a:t.a;return new _Ewa.qX(n.b,i,n.c)}};_Ewa.qX=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.qX.prototype={b:null,a:0,c:null};_Ewa.AA.registerClass("_Ewa.AA",_Ewa.GM,_Ewa.qY);_Ewa.KO.a();